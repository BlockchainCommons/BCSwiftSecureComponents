# Secure Components - Envelope Test Vectors

**Authors:** Wolf McNally, Christopher Allen, Blockchain Commons</br>
**Revised:** Aug 13, 2022</br>
**Status:** DRAFT

## Contents

* [Overview](1-OVERVIEW.md)
* [Envelope Overview](2-ENVELOPE.md)
* [Envelope Notation](3-ENVELOPE-NOTATION.md)
* [Envelope Expressions](4-ENVELOPE-EXPRESSIONS.md)
* [Definitions](5-DEFINITIONS.md)
* [Examples](6-EXAMPLES.md)
* Envelope Test Vectors: This document
* [Envelope SSKR Test Vectors](8-ENVELOPE-SSKR-TEST-VECTORS.md)
* [Noncorrelation](9-NONCORRELATION.md)

---

## Introduction

This document provides test vectors for `envelope`. It is generated by `EnvelopeTestVectors.testGenerateEnvelopeTestVectors()` in the `BCSwiftSecureComponents` test suite.

## Status

This document is a draft with a reference implementation in [BCSwiftSecureComponents](https://github.com/blockchaincommons/BCSwiftSecureComponents).

---

These test vectors use these fixed seed values, from which other key pairs are derived:

* Alice's Seed: `82f32c855d3d542256180810797e0073`
* Bob's Seed: `187a5973c64d359c836eba466a44db7b`
* Carol's Seed: `8574afab18e229651c1be8f76ffee523`

These objects are normally random, but they are fixed for these test vectors:

* Symmetric key used for encryption: `526afd95b2229c5381baec4a1788507a3c4a566ca5cce64543b46ad12aff0035`
* Nonce for encryption: `4d785658f36c22fb5aed3ac0`
* Random generator for signing returns repeating sequence: `dca8cfe8e67d03fab4177279d5498e7a`

## INDEX

1. [Hello, World!](#TEST-VECTOR-1-Hello-World)
2. [Signed Plaintext](#TEST-VECTOR-2-Signed-Plaintext)
3. [Multisigned Plaintext](#TEST-VECTOR-3-Multisigned-Plaintext)
4. [Symmetric Encryption](#TEST-VECTOR-4-Symmetric-Encryption)
5. [Sign Then Encrypt](#TEST-VECTOR-5-Sign-Then-Encrypt)
6. [Encrypt Then Sign](#TEST-VECTOR-6-Encrypt-Then-Sign)
7. [Multi-Recipient](#TEST-VECTOR-7-MultiRecipient)
8. [Visible Signature Multi-Recipient](#TEST-VECTOR-8-Visible-Signature-MultiRecipient)
9. [Verifiable Credential](#TEST-VECTOR-9-Verifiable-Credential)
10. [Redacted Verifiable Credential](#TEST-VECTOR-10-Redacted-Verifiable-Credential)

---

## TEST VECTOR 1: Hello, World!

The simplest case: encoding a plaintext string as the envelope's `subject`. The `subject` can be any CBOR-encodable structure.

### Payload in Envelope Notation

```
"Hello."
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/tpfniyfdihjzjzjldmtklproam
```

### Tagged CBOR Binary

```
d831d83c6648656c6c6f2e
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   60("Hello.")   ; plaintext
)
```

### Tagged CBOR Annotated Binary

```
d8 31                 # tag(49)   ; envelope
   d8 3c              # tag(60)   ; plaintext
      66              # text(6)
         48656c6c6f2e # "Hello."
```

---

## TEST VECTOR 2: Signed Plaintext

A string has been signed by Alice.

### Payload in Envelope Notation

```
"Hello." [
    verifiedBy: Signature
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lftpfniyfdihjzjzjldmtpehtpfhlftpehtpfntpfraxtpehtpfntpfshdfzktpkcpbzcsiyeyzedtencshghdguswamwlutceetttlfsshlfsdiwzptosinetpshksnzmmdgmroosylswfybegdmhpdmoesykkthsssbwgdgdurtlmhvlhftlidbkfteenykgpa
```

### Tagged CBOR Binary

```
d83182d83c6648656c6c6f2ed831d83f82d831d83cd83b03d831d83cd83d584077aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   [
      60("Hello.")   ; plaintext,
      49(   ; envelope
         63(   ; plaintext
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(3)   ; predicate
                  )
               ),
               49(   ; envelope
                  60(   ; plaintext
                     61(   ; signature
                        h'77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a'
                     )
                  )
               )
            ]
         )
      )
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   82                                    # array(2)
      d8 3c                              # tag(60)   ; plaintext
         66                              # text(6)
            48656c6c6f2e                 # "Hello."
      d8 31                              # tag(49)   ; envelope
         d8 3f                           # tag(63)   ; plaintext
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        03               # unsigned(3)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3d               # tag(61)   ; signature
                        5840             # bytes(64)
                           77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

---

## TEST VECTOR 3: Multisigned Plaintext

Alice and Carol jointly send a signed plaintext message to Bob.

### Payload in Envelope Notation

```
"Hello." [
    verifiedBy: Signature
    verifiedBy: Signature
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lstpfniyfdihjzjzjldmtpehtpfhlftpehtpfntpfraxtpehtpfntpfshdfzktpkcpbzcsiyeyzedtencshghdguswamwlutceetttlfsshlfsdiwzptosinetpshksnzmmdgmroosylswfybegdmhpdmoesykkthsssbwgdgdurtlmhvlhftlidbkfttpehtpfhlftpehtpfntpfraxtpehtpfntpfshdfzceoxaemteepkgwbzeylgplplsehlurstinjtcmrthfhginuesamoktpllrwlgooyrfcpeofrhfztyljydycpmwfmoshdkgdsotamieleaamkylghsfgtvoasdijoropaimmnaalp
```

### Tagged CBOR Binary

```
d83183d83c6648656c6c6f2ed831d83f82d831d83cd83b03d831d83cd83d584077aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3ad831d83f82d831d83cd83b03d831d83cd83d58401ca4009634aa4f15328daeaec15ddfc7696e16c0565769dec29277ae84e955a1bc22333b56fcf7743022943ea7587b26a306648a0498f754cc4de2092770b8b1
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   [
      60("Hello.")   ; plaintext,
      49(   ; envelope
         63(   ; plaintext
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(3)   ; predicate
                  )
               ),
               49(   ; envelope
                  60(   ; plaintext
                     61(   ; signature
                        h'77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a'
                     )
                  )
               )
            ]
         )
      ),
      49(   ; envelope
         63(   ; plaintext
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(3)   ; predicate
                  )
               ),
               49(   ; envelope
                  60(   ; plaintext
                     61(   ; signature
                        h'1ca4009634aa4f15328daeaec15ddfc7696e16c0565769dec29277ae84e955a1bc22333b56fcf7743022943ea7587b26a306648a0498f754cc4de2092770b8b1'
                     )
                  )
               )
            ]
         )
      )
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   83                                    # array(3)
      d8 3c                              # tag(60)   ; plaintext
         66                              # text(6)
            48656c6c6f2e                 # "Hello."
      d8 31                              # tag(49)   ; envelope
         d8 3f                           # tag(63)   ; plaintext
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        03               # unsigned(3)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3d               # tag(61)   ; signature
                        5840             # bytes(64)
                           77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
      d8 31                              # tag(49)   ; envelope
         d8 3f                           # tag(63)   ; plaintext
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        03               # unsigned(3)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3d               # tag(61)   ; signature
                        5840             # bytes(64)
                           1ca4009634aa4f15328daeaec15ddfc7696e16c0565769dec29277ae84e955a1bc22333b56fcf7743022943ea7587b26a306648a0498f754cc4de2092770b8b1
```

---

## TEST VECTOR 4: Symmetric Encryption

Alice and Bob have agreed to use a symmetric key.

### Payload in Envelope Notation

```
EncryptedMessage
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/tpdylrflrlbnplynmdhdpkgsgtkshfhdwfjzcpzohtweftrtgdmsuecktbdivotduentfrspgmastegdtshddktpethdcxloimbnlplsdloycftluoftcfguayrsbwghlbctcmplwteyynsawsnlbgsnhkmovwieclaaen
```

### Tagged CBOR Binary

```
d831d8308447b70caef69558aa4c4d785658f36c22fb5aed3ac05097de1ed627e2d2de9d3bc85209d350d75824d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   48(   ; crypto-msg
      [
         h'b70caef69558aa',
         h'4d785658f36c22fb5aed3ac0',
         h'97de1ed627e2d2de9d3bc85209d350d7',
         h'd8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5'
      ]
   )
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   d8 30                                 # tag(48)   ; crypto-msg
      84                                 # array(4)
         47                              # bytes(7)
            b70caef69558aa
         4c                              # bytes(12)
            4d785658f36c22fb5aed3ac0
         50                              # bytes(16)
            97de1ed627e2d2de9d3bc85209d350d7
         5824                            # bytes(36)
            d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
```

---

## TEST VECTOR 5: Sign Then Encrypt

A message is first signed, then encrypted. Its signature can only be checked once the envelope is decrypted.

### Payload in Envelope Notation

```
EncryptedMessage
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/tpdylrhdhnaskpgafwskgysfsrghkofptifrdmhglfbawpfeplfncpmkvoynlyoscxheutlsfpsfkglpeoassnjpahgtdpwfzomwstguclinrerownlgzmpebdasmtcxiafebyjzlkynenwmwlfhoxwebtprghrptdchyttddlnnbyltkgzctpcmbwynbktbenfntbjzhygsgtkshfhdwfjzcpzohtweftrtgdlraemerogarshgdsfhislghygdmwmegwhddktpethdcxutdszotpsspfneurvdpfiehlsksrlbfsmyrdpaluotltgdtndyvaimmyvlprbewpotwpkeah
```

### Tagged CBOR Binary

```
d831d83084586009754942c551ccc3547641d03b2e57820eec45ae3c2298e2f681a7205fdd8341cc7b853309cd72054d2df3fb94c7532169b5b8f18dffaf0b0996206345116c8cf636ebe93fa4ed0db254b6d217f9d22f9e11877bfdd81613f60ad6363cd66c5e4c4d785658f36c22fb5aed3ac050840091b849bf57263f688d5e5094914f5824d8385820dd26fbd8c4b09fdfe7b0645dc5c37f3d8fbab18ba38750da30e66a8fe3b210ec
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   48(   ; crypto-msg
      [
         h'09754942c551ccc3547641d03b2e57820eec45ae3c2298e2f681a7205fdd8341cc7b853309cd72054d2df3fb94c7532169b5b8f18dffaf0b0996206345116c8cf636ebe93fa4ed0db254b6d217f9d22f9e11877bfdd81613f60ad6363cd66c5e',
         h'4d785658f36c22fb5aed3ac0',
         h'840091b849bf57263f688d5e5094914f',
         h'd8385820dd26fbd8c4b09fdfe7b0645dc5c37f3d8fbab18ba38750da30e66a8fe3b210ec'
      ]
   )
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   d8 30                                 # tag(48)   ; crypto-msg
      84                                 # array(4)
         5860                            # bytes(96)
            09754942c551ccc3547641d03b2e57820eec45ae3c2298e2f681a7205fdd8341cc7b853309cd72054d2df3fb94c7532169b5b8f18dffaf0b0996206345116c8cf636ebe93fa4ed0db254b6d217f9d22f9e11877bfdd81613f60ad6363cd66c5e
         4c                              # bytes(12)
            4d785658f36c22fb5aed3ac0
         50                              # bytes(16)
            840091b849bf57263f688d5e5094914f
         5824                            # bytes(36)
            d8385820dd26fbd8c4b09fdfe7b0645dc5c37f3d8fbab18ba38750da30e66a8fe3b210ec
```

---

## TEST VECTOR 6: Encrypt Then Sign

A message is first encrypted, then signed. Its signature may be checked before the envelope is decrypted.

### Payload in Envelope Notation

```
EncryptedMessage [
    verifiedBy: Signature
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lftpdylrflrlbnplynmdhdpkgsgtkshfhdwfjzcpzohtweftrtgdmsuecktbdivotduentfrspgmastegdtshddktpethdcxloimbnlplsdloycftluoftcfguayrsbwghlbctcmplwteyynsawsnlbgsnhkmovwtpehtpfhlftpehtpfntpfraxtpehtpfntpfshdfzktpkcpbzcsiyeyzedtencshghdguswamwlutceetttlfsshlfsdiwzptosinetpshksnzmmdgmroosylswfybegdmhpdmoesykkthsssbwgdgdurtlmhvlhftlidbkftutmhsacx
```

### Tagged CBOR Binary

```
d83182d8308447b70caef69558aa4c4d785658f36c22fb5aed3ac05097de1ed627e2d2de9d3bc85209d350d75824d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5d831d83f82d831d83cd83b03d831d83cd83d584077aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   [
      48(   ; crypto-msg
         [
            h'b70caef69558aa',
            h'4d785658f36c22fb5aed3ac0',
            h'97de1ed627e2d2de9d3bc85209d350d7',
            h'd8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5'
         ]
      ),
      49(   ; envelope
         63(   ; plaintext
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(3)   ; predicate
                  )
               ),
               49(   ; envelope
                  60(   ; plaintext
                     61(   ; signature
                        h'77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a'
                     )
                  )
               )
            ]
         )
      )
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   82                                    # array(2)
      d8 30                              # tag(48)   ; crypto-msg
         84                              # array(4)
            47                           # bytes(7)
               b70caef69558aa
            4c                           # bytes(12)
               4d785658f36c22fb5aed3ac0
            50                           # bytes(16)
               97de1ed627e2d2de9d3bc85209d350d7
            5824                         # bytes(36)
               d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
      d8 31                              # tag(49)   ; envelope
         d8 3f                           # tag(63)   ; plaintext
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        03               # unsigned(3)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3d               # tag(61)   ; signature
                        5840             # bytes(64)
                           77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

---

## TEST VECTOR 7: Multi-Recipient

Alice encrypts a message using the public keys of Bob and Carol so that it can only be decrypted by the private key of either Bob or Carol. Each of the `SealedMessage` encrypts just the symmetric key used to encrypt the payload.

### Payload in Envelope Notation

```
EncryptedMessage [
    hasRecipient: SealedMessage
    hasRecipient: SealedMessage
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lstpdylrflrlbnplynmdhdpkgsgtkshfhdwfjzcpzohtweftrtgdmsuecktbdivotduentfrspgmastegdtshddktpethdcxloimbnlplsdloycftluoftcfguayrsbwghlbctcmplwteyynsawsnlbgsnhkmovwtpehtpfhlftpehtpfntpfrahtpehtpfntpemlftpdylshddkjpfebsdnqdatsprsaxbytojllnkohytnnyiewdftdwntnnesqzcnrplskngshlbneminpeeegsgtkshfhdwfjzcpzohtweftrtgdjogauovyzogwaxhheouebdrnkbvlvefytpfmhdcxgsgdldnevokicpsgledwwefesnstolnnvtisfzrfrtcamkahlecpmnaxrpmsghjztpehtpfhlftpehtpfntpfrahtpehtpfntpemlftpdylshddkfgcewybnaaurnsrlvlwekkdtiochbbdtspceoxwfcttletfwihamcsahdmhdwsldswgukeoegsgtkshfhdwfjzcpzohtweftrtgdlpktwkiyttuyonmosfgwyadruohkjnvotpfmhdcxgsgdldnevokicpsgledwwefesnstolnnvtisfzrfrtcamkahlecpmnaxrpmsghjzrtledsns
```

### Tagged CBOR Binary

```
d83183d8308447b70caef69558aa4c4d785658f36c22fb5aed3ac05097de1ed627e2d2de9d3bc85209d350d75824d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5d831d83f82d831d83cd83b05d831d83cd83782d83083582472450f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af344c4d785658f36c22fb5aed3ac0507049dce1fb4f035c33de0bbe7ee3e444d83e58204c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546cd831d83f82d831d83cd83b05d831d83cd83782d830835824461cee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca24c4d785658f36c22fb5aed3ac0508577f466d1dba592cc4ff82adc596de2d83e58204c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   [
      48(   ; crypto-msg
         [
            h'b70caef69558aa',
            h'4d785658f36c22fb5aed3ac0',
            h'97de1ed627e2d2de9d3bc85209d350d7',
            h'd8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5'
         ]
      ),
      49(   ; envelope
         63(   ; plaintext
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(5)   ; predicate
                  )
               ),
               49(   ; envelope
                  60(   ; plaintext
                     55(   ; crypto-sealed
                        [
                           48(   ; crypto-msg
                              [
                                 h'72450f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af34',
                                 h'4d785658f36c22fb5aed3ac0',
                                 h'7049dce1fb4f035c33de0bbe7ee3e444'
                              ]
                           ),
                           62(   ; agreement-public-key
                              h'4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c'
                           )
                        ]
                     )
                  )
               )
            ]
         )
      ),
      49(   ; envelope
         63(   ; plaintext
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(5)   ; predicate
                  )
               ),
               49(   ; envelope
                  60(   ; plaintext
                     55(   ; crypto-sealed
                        [
                           48(   ; crypto-msg
                              [
                                 h'461cee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca2',
                                 h'4d785658f36c22fb5aed3ac0',
                                 h'8577f466d1dba592cc4ff82adc596de2'
                              ]
                           ),
                           62(   ; agreement-public-key
                              h'4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c'
                           )
                        ]
                     )
                  )
               )
            ]
         )
      )
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   83                                    # array(3)
      d8 30                              # tag(48)   ; crypto-msg
         84                              # array(4)
            47                           # bytes(7)
               b70caef69558aa
            4c                           # bytes(12)
               4d785658f36c22fb5aed3ac0
            50                           # bytes(16)
               97de1ed627e2d2de9d3bc85209d350d7
            5824                         # bytes(36)
               d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
      d8 31                              # tag(49)   ; envelope
         d8 3f                           # tag(63)   ; plaintext
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        05               # unsigned(5)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 37               # tag(55)   ; crypto-sealed
                        82               # array(2)
                           d8 30         # tag(48)   ; crypto-msg
                              83         # array(3)
                                 5824    # bytes(36)
                                    72450f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af34
                                 4c      # bytes(12)
                                    4d785658f36c22fb5aed3ac0
                                 50      # bytes(16)
                                    7049dce1fb4f035c33de0bbe7ee3e444
                           d8 3e         # tag(62)   ; agreement-public-key
                              5820       # bytes(32)
                                 4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
      d8 31                              # tag(49)   ; envelope
         d8 3f                           # tag(63)   ; plaintext
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        05               # unsigned(5)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 37               # tag(55)   ; crypto-sealed
                        82               # array(2)
                           d8 30         # tag(48)   ; crypto-msg
                              83         # array(3)
                                 5824    # bytes(36)
                                    461cee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca2
                                 4c      # bytes(12)
                                    4d785658f36c22fb5aed3ac0
                                 50      # bytes(16)
                                    8577f466d1dba592cc4ff82adc596de2
                           d8 3e         # tag(62)   ; agreement-public-key
                              5820       # bytes(32)
                                 4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
```

---

## TEST VECTOR 8: Visible Signature Multi-Recipient

Alice encrypts a message using the public keys of Bob and Carol so that it can only be decrypted by the private key of either Bob or Carol. Each of the `SealedMessage` encrypts just the symmetric key used to encrypt the payload. Alice then signs the envelope so her signature may be verified by anyone with her public key.

### Payload in Envelope Notation

```
EncryptedMessage [
    hasRecipient: SealedMessage
    hasRecipient: SealedMessage
    verifiedBy: Signature
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lrtpdylrflrlbnplynmdhdpkgsgtkshfhdwfjzcpzohtweftrtgdmsuecktbdivotduentfrspgmastegdtshddktpethdcxloimbnlplsdloycftluoftcfguayrsbwghlbctcmplwteyynsawsnlbgsnhkmovwtpehtpfhlftpehtpfntpfraxtpehtpfntpfshdfzktpkcpbzcsiyeyzedtencshghdguswamwlutceetttlfsshlfsdiwzptosinetpshksnzmmdgmroosylswfybegdmhpdmoesykkthsssbwgdgdurtlmhvlhftlidbkfttpehtpfhlftpehtpfntpfrahtpehtpfntpemlftpdylshddkjpfebsdnqdatsprsaxbytojllnkohytnnyiewdftdwntnnesqzcnrplskngshlbneminpeeegsgtkshfhdwfjzcpzohtweftrtgdjogauovyzogwaxhheouebdrnkbvlvefytpfmhdcxgsgdldnevokicpsgledwwefesnstolnnvtisfzrfrtcamkahlecpmnaxrpmsghjztpehtpfhlftpehtpfntpfrahtpehtpfntpemlftpdylshddkfgcewybnaaurnsrlvlwekkdtiochbbdtspceoxwfcttletfwihamcsahdmhdwsldswgukeoegsgtkshfhdwfjzcpzohtweftrtgdlpktwkiyttuyonmosfgwyadruohkjnvotpfmhdcxgsgdldnevokicpsgledwwefesnstolnnvtisfzrfrtcamkahlecpmnaxrpmsghjzdptpluae
```

### Tagged CBOR Binary

```
d83184d8308447b70caef69558aa4c4d785658f36c22fb5aed3ac05097de1ed627e2d2de9d3bc85209d350d75824d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5d831d83f82d831d83cd83b03d831d83cd83d584077aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3ad831d83f82d831d83cd83b05d831d83cd83782d83083582472450f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af344c4d785658f36c22fb5aed3ac0507049dce1fb4f035c33de0bbe7ee3e444d83e58204c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546cd831d83f82d831d83cd83b05d831d83cd83782d830835824461cee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca24c4d785658f36c22fb5aed3ac0508577f466d1dba592cc4ff82adc596de2d83e58204c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   [
      48(   ; crypto-msg
         [
            h'b70caef69558aa',
            h'4d785658f36c22fb5aed3ac0',
            h'97de1ed627e2d2de9d3bc85209d350d7',
            h'd8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5'
         ]
      ),
      49(   ; envelope
         63(   ; plaintext
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(3)   ; predicate
                  )
               ),
               49(   ; envelope
                  60(   ; plaintext
                     61(   ; signature
                        h'77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a'
                     )
                  )
               )
            ]
         )
      ),
      49(   ; envelope
         63(   ; plaintext
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(5)   ; predicate
                  )
               ),
               49(   ; envelope
                  60(   ; plaintext
                     55(   ; crypto-sealed
                        [
                           48(   ; crypto-msg
                              [
                                 h'72450f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af34',
                                 h'4d785658f36c22fb5aed3ac0',
                                 h'7049dce1fb4f035c33de0bbe7ee3e444'
                              ]
                           ),
                           62(   ; agreement-public-key
                              h'4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c'
                           )
                        ]
                     )
                  )
               )
            ]
         )
      ),
      49(   ; envelope
         63(   ; plaintext
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(5)   ; predicate
                  )
               ),
               49(   ; envelope
                  60(   ; plaintext
                     55(   ; crypto-sealed
                        [
                           48(   ; crypto-msg
                              [
                                 h'461cee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca2',
                                 h'4d785658f36c22fb5aed3ac0',
                                 h'8577f466d1dba592cc4ff82adc596de2'
                              ]
                           ),
                           62(   ; agreement-public-key
                              h'4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c'
                           )
                        ]
                     )
                  )
               )
            ]
         )
      )
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   84                                    # array(4)
      d8 30                              # tag(48)   ; crypto-msg
         84                              # array(4)
            47                           # bytes(7)
               b70caef69558aa
            4c                           # bytes(12)
               4d785658f36c22fb5aed3ac0
            50                           # bytes(16)
               97de1ed627e2d2de9d3bc85209d350d7
            5824                         # bytes(36)
               d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
      d8 31                              # tag(49)   ; envelope
         d8 3f                           # tag(63)   ; plaintext
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        03               # unsigned(3)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3d               # tag(61)   ; signature
                        5840             # bytes(64)
                           77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
      d8 31                              # tag(49)   ; envelope
         d8 3f                           # tag(63)   ; plaintext
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        05               # unsigned(5)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 37               # tag(55)   ; crypto-sealed
                        82               # array(2)
                           d8 30         # tag(48)   ; crypto-msg
                              83         # array(3)
                                 5824    # bytes(36)
                                    72450f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af34
                                 4c      # bytes(12)
                                    4d785658f36c22fb5aed3ac0
                                 50      # bytes(16)
                                    7049dce1fb4f035c33de0bbe7ee3e444
                           d8 3e         # tag(62)   ; agreement-public-key
                              5820       # bytes(32)
                                 4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
      d8 31                              # tag(49)   ; envelope
         d8 3f                           # tag(63)   ; plaintext
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        05               # unsigned(5)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 37               # tag(55)   ; crypto-sealed
                        82               # array(2)
                           d8 30         # tag(48)   ; crypto-msg
                              83         # array(3)
                                 5824    # bytes(36)
                                    461cee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca2
                                 4c      # bytes(12)
                                    4d785658f36c22fb5aed3ac0
                                 50      # bytes(16)
                                    8577f466d1dba592cc4ff82adc596de2
                           d8 3e         # tag(62)   ; agreement-public-key
                              5820       # bytes(32)
                                 4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
```

---

## TEST VECTOR 9: Verifiable Credential

John Smith is issued a Permanent Resident Card signed by the State of Example

### Payload in Envelope Notation

```
{
    CID(174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8) [
        "dateIssued": 2022-04-27
        holder: CID(78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc) [
            "birthCountry": "bs" [
                note: "The Bahamas"
            ]
            "birthDate": 1974-02-18
            "familyName": "SMITH"
            "givenName": "JOHN"
            "image": Digest(36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999) [
                dereferenceVia: "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                note: "This is an image of John Smith."
            ]
            "lprCategory": "C09"
            "lprNumber": "999-999-999"
            "residentSince": 2018-01-07
            "sex": "MALE"
            isA: "Permanent Resident"
            isA: "Person"
        ]
        isA: "credential"
        issuer: CID(04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8) [
            dereferenceVia: URI(https://exampleledger.com/cid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8)
            note: "Issued by the State of Example"
        ]
        note: "The State of Example recognizes JOHN SMITH as a Permanent Resident."
    ]
} [
    verifiedBy: Signature [
        note: "Made by the State of Example."
    ]
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lftpehlntpfntpfthdcxchfdfwwdsrzofytsyndsvetsndkbbelbtdmuskhfdtyntbcprocktyatktaxaosptpehtpfhlftpehtpfnimiehsjyihgajkjkkpihietpehtpfnsecyidisltlatpehtpfhlftpehtpfntpfraotpehtpfnimiajpihieihjtjyinhsjztpehtpfhlftpehtpfntpfraatpehtpfnksfxghisihcxgujyhsjyihcxjliycxfekshsjnjojzihcxjpihiajliojtinknihjkcxgegwfdglcxgugtgaghfdcxhsjkcxhscxgdihjpjnhsjtihjtjycxgmihjkinieihjtjydmtpehtpfhlftpehtpfntpfrbatpehlktpfntpfthdcxksrfdyaeflkootmhhpsfrhronbeytkjpdwwdwtrkzocygawdwfcshepyhdaysguotpehtpfhlftpehtpfniajkihkstpehtpfniegtfpgsfetpehtpfhlftpehtpfnjnjpihjkinieihjtjyguinjtiaihtpehtpfnsecyhtgyiaaetpehtpfhlftpehtpfntpfraotpehtpfniygdihjpjkjljttpehtpfhlftpehtpfninidinjpjyisfyhsjyihtpehtpfnsecyatskiolatpehtpfhlftpehtpfnihinjnhsioihtpehlstpfntpethdcxenrndyjpjewsrphhoyfrbwimvontlalyynflmosajodkbzwmhnpmcehfweeosonltpehtpfhlftpehtpfntpfrastpehtpfnkshsisjyjyjojkftdldlihkshsjnjojzihjzihieioihjpdmiajljndlieinioihjkjydleoenidiheodyemeyenidihiyideneciahseheoideheoenhsiheyesieetdyetehiyeneeemeseyiaeyemdyeyeeehecihidendyhsieehiaecenihieeoeoiaesesestpehtpfhlftpehtpfntpfraatpehtpfnksctghisinjkcxinjkcxhsjtcxinjnhsioihcxjliycxgejlisjtcxgujninjyisdmtpehtpfhlftpehtpfnimiyhsjninjzkkglhsjnihtpehtpfnihgugtgaghfdtpehtpfhlftpehtpfntpfraotpehtpfnjpgdihjpjnhsjtihjtjycxgmihjkinieihjtjytpehtpfhlftpehtpfnjzidinjpjyisfxjlkpjtjyjpkktpehlftpfnididjktpehtpfhlftpehtpfntpfraatpehtpfnjeghisihcxfwhsishsjnhsjktpehtpfhlftpehtpfnjejzjojpfxhsjyihiojljpkktpehtpfniafxdyestpehtpfhlftpehtpfninjzjojpglkpjnidihjptpehtpfnjeesesesdpesesesdpesesestpehtpfhlftpehtpfninioinkoihjtglhsjnihtpehtpfniegegwfdgltpehtpfhlftpehtpfntpfrbttpehlstpfntpfthdcxaaenfsheytmseorfbsbzktrdrdfybkwntkeegetaveghzstattdertbswsihahvstpehtpfhlftpehtpfntpfraatpehtpfnksckgajkjkkpihiecxidkkcxjyisihcxgujyhsjyihcxjliycxfekshsjnjojzihtpehtpfhlftpehtpfntpfrastpehtpfntpcxkshyisjyjyjojkftdldlihkshsjnjojzihjzihieioihjpdmiajljndliainiedldyeeeoeneoieeciyiyesesemeoeoidiadyiyehecememidhsidhseeeedyhsiyehiaiyeoeeeehsieesiheeeceeiyhsieesieeheyetiadydyiyihiyenecdyecihettpehtpfhlftpehtpfntpfraxtpehlftpfntpfshdfzpyfhwyleaeahdsjshdjkidbggddrzoltielgtisfvlnlhneniabdnnqdnbvsmepefnidswswvduymydwkofggogabbfgcwlesfmwzsotpaimgtdliyhgmnstasbwkpkttpehtpfhlftpehtpfntpfraatpehtpfnkscagthsieihcxidkkcxjyisihcxgujyhsjyihcxjliycxfekshsjnjojzihdmeegttpge
```

### Tagged CBOR Binary

```
d83182d83186d83cd83a5820174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8d831d83f82d831d83c6a64617465497373756564d831d83cc11a62688780d831d83f82d831d83cd83b02d831d83c6a63726564656e7469616cd831d83f82d831d83cd83b04d831d83c7843546865205374617465206f66204578616d706c65207265636f676e697a6573204a4f484e20534d4954482061732061205065726d616e656e74205265736964656e742ed831d83f82d831d83cd83b0ed8318cd83cd83a582078bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadcd831d83f82d831d83c63736578d831d83c644d414c45d831d83f82d831d83c6d7265736964656e7453696e6365d831d83cc11a5a516300d831d83f82d831d83cd83b02d831d83c66506572736f6ed831d83f82d831d83c69626972746844617465d831d83cc11a07c56780d831d83f82d831d83c65696d616765d83183d83cd838582036be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999d831d83f82d831d83cd83b09d831d83c786168747470733a2f2f6578616d706c656c65646765722e636f6d2f6469676573742f33366265333037323662656662363563613133623133366165323964383038316636343739326332373032343135656236306164316335366564333363393939d831d83f82d831d83cd83b04d831d83c781f5468697320697320616e20696d616765206f66204a6f686e20536d6974682ed831d83f82d831d83c6a66616d696c794e616d65d831d83c65534d495448d831d83f82d831d83cd83b02d831d83c725065726d616e656e74205265736964656e74d831d83f82d831d83c6c6269727468436f756e747279d83182d83c626273d831d83f82d831d83cd83b04d831d83c6b54686520426168616d6173d831d83f82d831d83c6b6c707243617465676f7279d831d83c63433039d831d83f82d831d83c696c70724e756d626572d831d83c6b3939392d3939392d393939d831d83f82d831d83c69676976656e4e616d65d831d83c644a4f484ed831d83f82d831d83cd83b0dd83183d83cd83a582004363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8d831d83f82d831d83cd83b04d831d83c781e49737375656420627920746865205374617465206f66204578616d706c65d831d83f82d831d83cd83b09d831d83cd820785e68747470733a2f2f6578616d706c656c65646765722e636f6d2f6369642f30343336336435666639393733336263306631353737626162613434306166316366333434616439653435346661643964313238633030666566363530356538d831d83f82d831d83cd83b03d83182d83cd83d5840ab3fee8a0005267158736212502afb87648dd0cce3996036630b9eb3a0e891af3c62c6c6e7db8f2c7646554914461b8acc94faa3b16a4d2f66578ec709137577d831d83f82d831d83cd83b04d831d83c781d4d61646520627920746865205374617465206f66204578616d706c652e
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   [
      49(   ; envelope
         [
            60(   ; plaintext
               58(   ; crypto-cid
                  h'174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8'
               )
            ),
            49(   ; envelope
               63(   ; plaintext
                  [
                     49(   ; envelope
                        60("dateIssued")   ; plaintext
                     ),
                     49(   ; envelope
                        60(   ; plaintext
                           1(2022-04-27T00:00:00Z)
                        )
                     )
                  ]
               )
            ),
            49(   ; envelope
               63(   ; plaintext
                  [
                     49(   ; envelope
                        60(   ; plaintext
                           59(2)   ; predicate
                        )
                     ),
                     49(   ; envelope
                        60("credential")   ; plaintext
                     )
                  ]
               )
            ),
            49(   ; envelope
               63(   ; plaintext
                  [
                     49(   ; envelope
                        60(   ; plaintext
                           59(4)   ; predicate
                        )
                     ),
                     49(   ; envelope
                        60(   ; plaintext
                           "The State of Example recognizes JOHN SMITH as a Permanent Resident."
                        )
                     )
                  ]
               )
            ),
            49(   ; envelope
               63(   ; plaintext
                  [
                     49(   ; envelope
                        60(   ; plaintext
                           59(14)   ; predicate
                        )
                     ),
                     49(   ; envelope
                        [
                           60(   ; plaintext
                              58(   ; crypto-cid
                                 h'78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc'
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60("sex")   ; plaintext
                                    ),
                                    49(   ; envelope
                                       60("MALE")   ; plaintext
                                    )
                                 ]
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60("residentSince")   ; plaintext
                                    ),
                                    49(   ; envelope
                                       60(   ; plaintext
                                          1(2018-01-07T00:00:00Z)
                                       )
                                    )
                                 ]
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60(   ; plaintext
                                          59(2)   ; predicate
                                       )
                                    ),
                                    49(   ; envelope
                                       60("Person")   ; plaintext
                                    )
                                 ]
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60("birthDate")   ; plaintext
                                    ),
                                    49(   ; envelope
                                       60(   ; plaintext
                                          1(1974-02-18T00:00:00Z)
                                       )
                                    )
                                 ]
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60("image")   ; plaintext
                                    ),
                                    49(   ; envelope
                                       [
                                          60(   ; plaintext
                                             56(   ; crypto-digest
                                                h'36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999'
                                             )
                                          ),
                                          49(   ; envelope
                                             63(   ; plaintext
                                                [
                                                   49(   ; envelope
                                                      60(   ; plaintext
                                                         59(9)   ; predicate
                                                      )
                                                   ),
                                                   49(   ; envelope
                                                      60(   ; plaintext
                                                         "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                                                      )
                                                   )
                                                ]
                                             )
                                          ),
                                          49(   ; envelope
                                             63(   ; plaintext
                                                [
                                                   49(   ; envelope
                                                      60(   ; plaintext
                                                         59(4)   ; predicate
                                                      )
                                                   ),
                                                   49(   ; envelope
                                                      60(   ; plaintext
                                                         "This is an image of John Smith."
                                                      )
                                                   )
                                                ]
                                             )
                                          )
                                       ]
                                    )
                                 ]
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60("familyName")   ; plaintext
                                    ),
                                    49(   ; envelope
                                       60("SMITH")   ; plaintext
                                    )
                                 ]
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60(   ; plaintext
                                          59(2)   ; predicate
                                       )
                                    ),
                                    49(   ; envelope
                                       60("Permanent Resident")   ; plaintext
                                    )
                                 ]
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60("birthCountry")   ; plaintext
                                    ),
                                    49(   ; envelope
                                       [
                                          60("bs")   ; plaintext,
                                          49(   ; envelope
                                             63(   ; plaintext
                                                [
                                                   49(   ; envelope
                                                      60(   ; plaintext
                                                         59(4)   ; predicate
                                                      )
                                                   ),
                                                   49(   ; envelope
                                                      60("The Bahamas")   ; plaintext
                                                   )
                                                ]
                                             )
                                          )
                                       ]
                                    )
                                 ]
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60("lprCategory")   ; plaintext
                                    ),
                                    49(   ; envelope
                                       60("C09")   ; plaintext
                                    )
                                 ]
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60("lprNumber")   ; plaintext
                                    ),
                                    49(   ; envelope
                                       60("999-999-999")   ; plaintext
                                    )
                                 ]
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60("givenName")   ; plaintext
                                    ),
                                    49(   ; envelope
                                       60("JOHN")   ; plaintext
                                    )
                                 ]
                              )
                           )
                        ]
                     )
                  ]
               )
            ),
            49(   ; envelope
               63(   ; plaintext
                  [
                     49(   ; envelope
                        60(   ; plaintext
                           59(13)   ; predicate
                        )
                     ),
                     49(   ; envelope
                        [
                           60(   ; plaintext
                              58(   ; crypto-cid
                                 h'04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8'
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60(   ; plaintext
                                          59(4)   ; predicate
                                       )
                                    ),
                                    49(   ; envelope
                                       60(   ; plaintext
                                          "Issued by the State of Example"
                                       )
                                    )
                                 ]
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60(   ; plaintext
                                          59(9)   ; predicate
                                       )
                                    ),
                                    49(   ; envelope
                                       60(   ; plaintext
                                          32(   ; uri
                                             "https://exampleledger.com/cid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8"
                                          )
                                       )
                                    )
                                 ]
                              )
                           )
                        ]
                     )
                  ]
               )
            )
         ]
      ),
      49(   ; envelope
         63(   ; plaintext
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(3)   ; predicate
                  )
               ),
               49(   ; envelope
                  [
                     60(   ; plaintext
                        61(   ; signature
                           h'ab3fee8a0005267158736212502afb87648dd0cce3996036630b9eb3a0e891af3c62c6c6e7db8f2c7646554914461b8acc94faa3b16a4d2f66578ec709137577'
                        )
                     ),
                     49(   ; envelope
                        63(   ; plaintext
                           [
                              49(   ; envelope
                                 60(   ; plaintext
                                    59(4)   ; predicate
                                 )
                              ),
                              49(   ; envelope
                                 60(   ; plaintext
                                    "Made by the State of Example."
                                 )
                              )
                           ]
                        )
                     )
                  ]
               )
            ]
         )
      )
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   82                                    # array(2)
      d8 31                              # tag(49)   ; envelope
         86                              # array(6)
            d8 3c                        # tag(60)   ; plaintext
               d8 3a                     # tag(58)   ; crypto-cid
                  5820                   # bytes(32)
                     174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8
            d8 31                        # tag(49)   ; envelope
               d8 3f                     # tag(63)   ; plaintext
                  82                     # array(2)
                     d8 31               # tag(49)   ; envelope
                        d8 3c            # tag(60)   ; plaintext
                           6a            # text(10)
                              64617465497373756564 # "dateIssued"
                     d8 31               # tag(49)   ; envelope
                        d8 3c            # tag(60)   ; plaintext
                           c1 1a62688780 # date(2022-04-27 00:00:00 +0000)
            d8 31                        # tag(49)   ; envelope
               d8 3f                     # tag(63)   ; plaintext
                  82                     # array(2)
                     d8 31               # tag(49)   ; envelope
                        d8 3c            # tag(60)   ; plaintext
                           d8 3b         # tag(59)   ; predicate
                              02         # unsigned(2)
                     d8 31               # tag(49)   ; envelope
                        d8 3c            # tag(60)   ; plaintext
                           6a            # text(10)
                              63726564656e7469616c # "credential"
            d8 31                        # tag(49)   ; envelope
               d8 3f                     # tag(63)   ; plaintext
                  82                     # array(2)
                     d8 31               # tag(49)   ; envelope
                        d8 3c            # tag(60)   ; plaintext
                           d8 3b         # tag(59)   ; predicate
                              04         # unsigned(4)
                     d8 31               # tag(49)   ; envelope
                        d8 3c            # tag(60)   ; plaintext
                           78 43         # text(67)
                              546865205374617465206f66204578616d706c65207265636f676e697a6573204a4f484e20534d4954482061732061205065726d616e656e74205265736964656e742e # "The State of Example recognizes JOHN SMITH as a Permanent Resident."
            d8 31                        # tag(49)   ; envelope
               d8 3f                     # tag(63)   ; plaintext
                  82                     # array(2)
                     d8 31               # tag(49)   ; envelope
                        d8 3c            # tag(60)   ; plaintext
                           d8 3b         # tag(59)   ; predicate
                              0e         # unsigned(14)
                     d8 31               # tag(49)   ; envelope
                        8c               # array(12)
                           d8 3c         # tag(60)   ; plaintext
                              d8 3a      # tag(58)   ; crypto-cid
                                 5820    # bytes(32)
                                    78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          63 # text(3)
                                             736578 # "sex"
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          64 # text(4)
                                             4d414c45 # "MALE"
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          6d # text(13)
                                             7265736964656e7453696e6365 # "residentSince"
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          c1 1a5a516300 # date(2018-01-07 00:00:00 +0000)
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          d8 3b # tag(59)   ; predicate
                                             02 # unsigned(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          66 # text(6)
                                             506572736f6e # "Person"
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          69 # text(9)
                                             626972746844617465 # "birthDate"
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          c1 1a07c56780 # date(1974-02-18 00:00:00 +0000)
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          65 # text(5)
                                             696d616765 # "image"
                                    d8 31 # tag(49)   ; envelope
                                       83 # array(3)
                                          d8 3c # tag(60)   ; plaintext
                                             d8 38 # tag(56)   ; crypto-digest
                                                5820 # bytes(32)
                                                   36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999
                                          d8 31 # tag(49)   ; envelope
                                             d8 3f # tag(63)   ; plaintext
                                                82 # array(2)
                                                   d8 31 # tag(49)   ; envelope
                                                      d8 3c # tag(60)   ; plaintext
                                                         d8 3b # tag(59)   ; predicate
                                                            09 # unsigned(9)
                                                   d8 31 # tag(49)   ; envelope
                                                      d8 3c # tag(60)   ; plaintext
                                                         78 61 # text(97)
                                                            68747470733a2f2f6578616d706c656c65646765722e636f6d2f6469676573742f33366265333037323662656662363563613133623133366165323964383038316636343739326332373032343135656236306164316335366564333363393939 # "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                                          d8 31 # tag(49)   ; envelope
                                             d8 3f # tag(63)   ; plaintext
                                                82 # array(2)
                                                   d8 31 # tag(49)   ; envelope
                                                      d8 3c # tag(60)   ; plaintext
                                                         d8 3b # tag(59)   ; predicate
                                                            04 # unsigned(4)
                                                   d8 31 # tag(49)   ; envelope
                                                      d8 3c # tag(60)   ; plaintext
                                                         78 1f # text(31)
                                                            5468697320697320616e20696d616765206f66204a6f686e20536d6974682e # "This is an image of John Smith."
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          6a # text(10)
                                             66616d696c794e616d65 # "familyName"
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          65 # text(5)
                                             534d495448 # "SMITH"
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          d8 3b # tag(59)   ; predicate
                                             02 # unsigned(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          72 # text(18)
                                             5065726d616e656e74205265736964656e74 # "Permanent Resident"
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          6c # text(12)
                                             6269727468436f756e747279 # "birthCountry"
                                    d8 31 # tag(49)   ; envelope
                                       82 # array(2)
                                          d8 3c # tag(60)   ; plaintext
                                             62 # text(2)
                                                6273 # "bs"
                                          d8 31 # tag(49)   ; envelope
                                             d8 3f # tag(63)   ; plaintext
                                                82 # array(2)
                                                   d8 31 # tag(49)   ; envelope
                                                      d8 3c # tag(60)   ; plaintext
                                                         d8 3b # tag(59)   ; predicate
                                                            04 # unsigned(4)
                                                   d8 31 # tag(49)   ; envelope
                                                      d8 3c # tag(60)   ; plaintext
                                                         6b # text(11)
                                                            54686520426168616d6173 # "The Bahamas"
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          6b # text(11)
                                             6c707243617465676f7279 # "lprCategory"
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          63 # text(3)
                                             433039 # "C09"
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          69 # text(9)
                                             6c70724e756d626572 # "lprNumber"
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          6b # text(11)
                                             3939392d3939392d393939 # "999-999-999"
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          69 # text(9)
                                             676976656e4e616d65 # "givenName"
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          64 # text(4)
                                             4a4f484e # "JOHN"
            d8 31                        # tag(49)   ; envelope
               d8 3f                     # tag(63)   ; plaintext
                  82                     # array(2)
                     d8 31               # tag(49)   ; envelope
                        d8 3c            # tag(60)   ; plaintext
                           d8 3b         # tag(59)   ; predicate
                              0d         # unsigned(13)
                     d8 31               # tag(49)   ; envelope
                        83               # array(3)
                           d8 3c         # tag(60)   ; plaintext
                              d8 3a      # tag(58)   ; crypto-cid
                                 5820    # bytes(32)
                                    04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          d8 3b # tag(59)   ; predicate
                                             04 # unsigned(4)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          78 1e # text(30)
                                             49737375656420627920746865205374617465206f66204578616d706c65 # "Issued by the State of Example"
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          d8 3b # tag(59)   ; predicate
                                             09 # unsigned(9)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          d8 20 # tag(32)   ; uri
                                             78 5e # text(94)
                                                68747470733a2f2f6578616d706c656c65646765722e636f6d2f6369642f30343336336435666639393733336263306631353737626162613434306166316366333434616439653435346661643964313238633030666566363530356538 # "https://exampleledger.com/cid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8"
      d8 31                              # tag(49)   ; envelope
         d8 3f                           # tag(63)   ; plaintext
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        03               # unsigned(3)
               d8 31                     # tag(49)   ; envelope
                  82                     # array(2)
                     d8 3c               # tag(60)   ; plaintext
                        d8 3d            # tag(61)   ; signature
                           5840          # bytes(64)
                              ab3fee8a0005267158736212502afb87648dd0cce3996036630b9eb3a0e891af3c62c6c6e7db8f2c7646554914461b8acc94faa3b16a4d2f66578ec709137577
                     d8 31               # tag(49)   ; envelope
                        d8 3f            # tag(63)   ; plaintext
                           82            # array(2)
                              d8 31      # tag(49)   ; envelope
                                 d8 3c   # tag(60)   ; plaintext
                                    d8 3b # tag(59)   ; predicate
                                       04 # unsigned(4)
                              d8 31      # tag(49)   ; envelope
                                 d8 3c   # tag(60)   ; plaintext
                                    78 1d # text(29)
                                       4d61646520627920746865205374617465206f66204578616d706c652e # "Made by the State of Example."
```

---

## TEST VECTOR 10: Redacted Verifiable Credential

John wishes to identify himself to a third party using his government-issued credential, but does not wish to reveal more than his name, his photo, and the fact that the state has verified his identity. Despite redacting numerous fields, the overall digest of the redacted structure is the same, and the signature still validates.

### Payload in Envelope Notation

```
{
    CID(174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8) [
        REDACTED
        REDACTED
        holder: CID(78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc) [
            REDACTED
            REDACTED
            REDACTED
            REDACTED
            REDACTED
            REDACTED
            REDACTED
            REDACTED
            "familyName": "SMITH"
            "givenName": "JOHN"
            "image": Digest(36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999) [
                dereferenceVia: "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                note: "This is an image of John Smith."
            ]
        ]
        isA: "credential"
        issuer: CID(04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8) [
            dereferenceVia: URI(https://exampleledger.com/cid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8)
            note: "Issued by the State of Example"
        ]
    ]
} [
    verifiedBy: Signature [
        note: "Made by the State of Example."
    ]
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lftpehlntpfntpfthdcxchfdfwwdsrzofytsyndsvetsndkbbelbtdmuskhfdtyntbcprocktyatktaxaosptpehtpethdcxcnmwneoynesfrfdtceemckhhcanngdoxsessleeekslapkuejsdshkbzltmololotpehtpfhlftpehtpfntpfraotpehtpfnimiajpihieihjtjyinhsjztpehtpethdcxktsrssckcfzcfevwonmuvtteteknjetnndwlckuofsaefdjkwfnsjovamdecldaytpehtpfhlftpehtpfntpfrbatpehlktpfntpfthdcxksrfdyaeflkootmhhpsfrhronbeytkjpdwwdwtrkzocygawdwfcshepyhdaysguotpehtpethdcxckkeprwkcenertkejttyiskigecabtvotazckibnbeplsoueqdbadivedtfsaatntpehtpethdcxdtkoiapdmshswnlolycymkimuyhsftrttawfbtchwndkaawkotbtgmiogtjsmskbtpehtpethdcxdyioihnlrtspzcmnvesbidaawsrdoyonrfrlhdiygldnwekeuejlrhjtdslrsbchtpehtpethdcxfnptdmfxhdgrhsgdstchadntjndroeneiyswwnpsynckvypacmdpolmwfegraocltpehtpfhlftpehtpfnihinjnhsioihtpehlstpfntpethdcxenrndyjpjewsrphhoyfrbwimvontlalyynflmosajodkbzwmhnpmcehfweeosonltpehtpfhlftpehtpfntpfrastpehtpfnkshsisjyjyjojkftdldlihkshsjnjojzihjzihieioihjpdmiajljndlieinioihjkjydleoenidiheodyemeyenidihiyideneciahseheoideheoenhsiheyesieetdyetehiyeneeemeseyiaeyemdyeyeeehecihidendyhsieehiaecenihieeoeoiaesesestpehtpfhlftpehtpfntpfraatpehtpfnksctghisinjkcxinjkcxhsjtcxinjnhsioihcxjliycxgejlisjtcxgujninjyisdmtpehtpfhlftpehtpfnimiyhsjninjzkkglhsjnihtpehtpfnihgugtgaghfdtpehtpethdcxjeeowndkttpadibtkttbdisgoerepydrehftgalnzsjytdflbkuoclylfxytgltetpehtpethdcxltzmvspreezmgdndwfjpylvtmekgeccakgkskkptgwjzlrktcwbwgotbprnektfwtpehtpethdcxtldnjlmevwurdygdaolrluzcfsuyiejetldwltwmfgvseymkswcyjosnenchaeyktpehtpethdcxuraxmksnbdfrcwmnrlfsdspfmohndrbahkpdehfshscsdnlesrgmiswylndronwztpehtpfhlftpehtpfninioinkoihjtglhsjnihtpehtpfniegegwfdgltpehtpfhlftpehtpfntpfrbttpehlstpfntpfthdcxaaenfsheytmseorfbsbzktrdrdfybkwntkeegetaveghzstattdertbswsihahvstpehtpfhlftpehtpfntpfraatpehtpfnksckgajkjkkpihiecxidkkcxjyisihcxgujyhsjyihcxjliycxfekshsjnjojzihtpehtpfhlftpehtpfntpfrastpehtpfntpcxkshyisjyjyjojkftdldlihkshsjnjojzihjzihieioihjpdmiajljndliainiedldyeeeoeneoieeciyiyesesemeoeoidiadyiyehecememidhsidhseeeedyhsiyehiaiyeoeeeehsieesiheeeceeiyhsieesieeheyetiadydyiyihiyenecdyecihettpehtpfhlftpehtpfntpfraxtpehlftpfntpfshdfzpyfhwyleaeahdsjshdjkidbggddrzoltielgtisfvlnlhneniabdnnqdnbvsmepefnidswswvduymydwkofggogabbfgcwlesfmwzsotpaimgtdliyhgmnstasbwkpkttpehtpfhlftpehtpfntpfraatpehtpfnkscagthsieihcxidkkcxjyisihcxgujyhsjyihcxjliycxfekshsjnjojzihdmghjybywf
```

### Tagged CBOR Binary

```
d83182d83186d83cd83a5820174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8d831d838582023949fa19fccbc291c371e5c1d9e50a4c1c48a347880aade7126591587928888d831d83f82d831d83cd83b02d831d83c6a63726564656e7469616cd831d838582077c3c41e19fd45e5a593e0d3d37a6bda9be91edc3d004873f39c70e695358908d831d83f82d831d83cd83b0ed8318cd83cd83a582078bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadcd831d83858201e7cb2f41c9fc07c6ed4687d4a1d0de2d9fd7d0c10aec9deb30e27e4293d04dad831d8385820297663a89761f188811a986adb613ac0d9f30d17f12404f4a30d52674d71977ed831d838582030676599c0c8fd8ee4cb6204efbaa1a5bcb758664e2bed7cde6fb96e2684cb17d831d83858203ca92e43584b6150c717019d6d2aa29f66c6f1acf61ee1b1162da694454b0221d831d83f82d831d83c65696d616765d83183d83cd838582036be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999d831d83f82d831d83cd83b09d831d83c786168747470733a2f2f6578616d706c656c65646765722e636f6d2f6469676573742f33366265333037323662656662363563613133623133366165323964383038316636343739326332373032343135656236306164316335366564333363393939d831d83f82d831d83cd83b04d831d83c781f5468697320697320616e20696d616765206f66204a6f686e20536d6974682ed831d83f82d831d83c6a66616d696c794e616d65d831d83c65534d495448d831d83858206b33f124d1b1270d77d627caa2b5ab2a313a4986fa74d2470adc21f743f94ed3d831d838582087ffe8b234ff509bf372f7e0917b351d7b7879a94f6c84771b1355d6b29f7742d831d8385820d52b6f91e5df305002848bfd3ddb646bd52c87eb46e83298c61a70cd361700f5d831d8385820df0398cd0b3b1b8eb73d26b092602a0e59a8313d61182b8ac35268ee862aa5f2d831d83f82d831d83c69676976656e4e616d65d831d83c644a4f484ed831d83f82d831d83cd83b0dd83183d83cd83a582004363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8d831d83f82d831d83cd83b04d831d83c781e49737375656420627920746865205374617465206f66204578616d706c65d831d83f82d831d83cd83b09d831d83cd820785e68747470733a2f2f6578616d706c656c65646765722e636f6d2f6369642f30343336336435666639393733336263306631353737626162613434306166316366333434616439653435346661643964313238633030666566363530356538d831d83f82d831d83cd83b03d83182d83cd83d5840ab3fee8a0005267158736212502afb87648dd0cce3996036630b9eb3a0e891af3c62c6c6e7db8f2c7646554914461b8acc94faa3b16a4d2f66578ec709137577d831d83f82d831d83cd83b04d831d83c781d4d61646520627920746865205374617465206f66204578616d706c652e
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   [
      49(   ; envelope
         [
            60(   ; plaintext
               58(   ; crypto-cid
                  h'174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8'
               )
            ),
            49(   ; envelope
               56(   ; crypto-digest
                  h'23949fa19fccbc291c371e5c1d9e50a4c1c48a347880aade7126591587928888'
               )
            ),
            49(   ; envelope
               63(   ; plaintext
                  [
                     49(   ; envelope
                        60(   ; plaintext
                           59(2)   ; predicate
                        )
                     ),
                     49(   ; envelope
                        60("credential")   ; plaintext
                     )
                  ]
               )
            ),
            49(   ; envelope
               56(   ; crypto-digest
                  h'77c3c41e19fd45e5a593e0d3d37a6bda9be91edc3d004873f39c70e695358908'
               )
            ),
            49(   ; envelope
               63(   ; plaintext
                  [
                     49(   ; envelope
                        60(   ; plaintext
                           59(14)   ; predicate
                        )
                     ),
                     49(   ; envelope
                        [
                           60(   ; plaintext
                              58(   ; crypto-cid
                                 h'78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc'
                              )
                           ),
                           49(   ; envelope
                              56(   ; crypto-digest
                                 h'1e7cb2f41c9fc07c6ed4687d4a1d0de2d9fd7d0c10aec9deb30e27e4293d04da'
                              )
                           ),
                           49(   ; envelope
                              56(   ; crypto-digest
                                 h'297663a89761f188811a986adb613ac0d9f30d17f12404f4a30d52674d71977e'
                              )
                           ),
                           49(   ; envelope
                              56(   ; crypto-digest
                                 h'30676599c0c8fd8ee4cb6204efbaa1a5bcb758664e2bed7cde6fb96e2684cb17'
                              )
                           ),
                           49(   ; envelope
                              56(   ; crypto-digest
                                 h'3ca92e43584b6150c717019d6d2aa29f66c6f1acf61ee1b1162da694454b0221'
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60("image")   ; plaintext
                                    ),
                                    49(   ; envelope
                                       [
                                          60(   ; plaintext
                                             56(   ; crypto-digest
                                                h'36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999'
                                             )
                                          ),
                                          49(   ; envelope
                                             63(   ; plaintext
                                                [
                                                   49(   ; envelope
                                                      60(   ; plaintext
                                                         59(9)   ; predicate
                                                      )
                                                   ),
                                                   49(   ; envelope
                                                      60(   ; plaintext
                                                         "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                                                      )
                                                   )
                                                ]
                                             )
                                          ),
                                          49(   ; envelope
                                             63(   ; plaintext
                                                [
                                                   49(   ; envelope
                                                      60(   ; plaintext
                                                         59(4)   ; predicate
                                                      )
                                                   ),
                                                   49(   ; envelope
                                                      60(   ; plaintext
                                                         "This is an image of John Smith."
                                                      )
                                                   )
                                                ]
                                             )
                                          )
                                       ]
                                    )
                                 ]
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60("familyName")   ; plaintext
                                    ),
                                    49(   ; envelope
                                       60("SMITH")   ; plaintext
                                    )
                                 ]
                              )
                           ),
                           49(   ; envelope
                              56(   ; crypto-digest
                                 h'6b33f124d1b1270d77d627caa2b5ab2a313a4986fa74d2470adc21f743f94ed3'
                              )
                           ),
                           49(   ; envelope
                              56(   ; crypto-digest
                                 h'87ffe8b234ff509bf372f7e0917b351d7b7879a94f6c84771b1355d6b29f7742'
                              )
                           ),
                           49(   ; envelope
                              56(   ; crypto-digest
                                 h'd52b6f91e5df305002848bfd3ddb646bd52c87eb46e83298c61a70cd361700f5'
                              )
                           ),
                           49(   ; envelope
                              56(   ; crypto-digest
                                 h'df0398cd0b3b1b8eb73d26b092602a0e59a8313d61182b8ac35268ee862aa5f2'
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60("givenName")   ; plaintext
                                    ),
                                    49(   ; envelope
                                       60("JOHN")   ; plaintext
                                    )
                                 ]
                              )
                           )
                        ]
                     )
                  ]
               )
            ),
            49(   ; envelope
               63(   ; plaintext
                  [
                     49(   ; envelope
                        60(   ; plaintext
                           59(13)   ; predicate
                        )
                     ),
                     49(   ; envelope
                        [
                           60(   ; plaintext
                              58(   ; crypto-cid
                                 h'04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8'
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60(   ; plaintext
                                          59(4)   ; predicate
                                       )
                                    ),
                                    49(   ; envelope
                                       60(   ; plaintext
                                          "Issued by the State of Example"
                                       )
                                    )
                                 ]
                              )
                           ),
                           49(   ; envelope
                              63(   ; plaintext
                                 [
                                    49(   ; envelope
                                       60(   ; plaintext
                                          59(9)   ; predicate
                                       )
                                    ),
                                    49(   ; envelope
                                       60(   ; plaintext
                                          32(   ; uri
                                             "https://exampleledger.com/cid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8"
                                          )
                                       )
                                    )
                                 ]
                              )
                           )
                        ]
                     )
                  ]
               )
            )
         ]
      ),
      49(   ; envelope
         63(   ; plaintext
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(3)   ; predicate
                  )
               ),
               49(   ; envelope
                  [
                     60(   ; plaintext
                        61(   ; signature
                           h'ab3fee8a0005267158736212502afb87648dd0cce3996036630b9eb3a0e891af3c62c6c6e7db8f2c7646554914461b8acc94faa3b16a4d2f66578ec709137577'
                        )
                     ),
                     49(   ; envelope
                        63(   ; plaintext
                           [
                              49(   ; envelope
                                 60(   ; plaintext
                                    59(4)   ; predicate
                                 )
                              ),
                              49(   ; envelope
                                 60(   ; plaintext
                                    "Made by the State of Example."
                                 )
                              )
                           ]
                        )
                     )
                  ]
               )
            ]
         )
      )
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   82                                    # array(2)
      d8 31                              # tag(49)   ; envelope
         86                              # array(6)
            d8 3c                        # tag(60)   ; plaintext
               d8 3a                     # tag(58)   ; crypto-cid
                  5820                   # bytes(32)
                     174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8
            d8 31                        # tag(49)   ; envelope
               d8 38                     # tag(56)   ; crypto-digest
                  5820                   # bytes(32)
                     23949fa19fccbc291c371e5c1d9e50a4c1c48a347880aade7126591587928888
            d8 31                        # tag(49)   ; envelope
               d8 3f                     # tag(63)   ; plaintext
                  82                     # array(2)
                     d8 31               # tag(49)   ; envelope
                        d8 3c            # tag(60)   ; plaintext
                           d8 3b         # tag(59)   ; predicate
                              02         # unsigned(2)
                     d8 31               # tag(49)   ; envelope
                        d8 3c            # tag(60)   ; plaintext
                           6a            # text(10)
                              63726564656e7469616c # "credential"
            d8 31                        # tag(49)   ; envelope
               d8 38                     # tag(56)   ; crypto-digest
                  5820                   # bytes(32)
                     77c3c41e19fd45e5a593e0d3d37a6bda9be91edc3d004873f39c70e695358908
            d8 31                        # tag(49)   ; envelope
               d8 3f                     # tag(63)   ; plaintext
                  82                     # array(2)
                     d8 31               # tag(49)   ; envelope
                        d8 3c            # tag(60)   ; plaintext
                           d8 3b         # tag(59)   ; predicate
                              0e         # unsigned(14)
                     d8 31               # tag(49)   ; envelope
                        8c               # array(12)
                           d8 3c         # tag(60)   ; plaintext
                              d8 3a      # tag(58)   ; crypto-cid
                                 5820    # bytes(32)
                                    78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc
                           d8 31         # tag(49)   ; envelope
                              d8 38      # tag(56)   ; crypto-digest
                                 5820    # bytes(32)
                                    1e7cb2f41c9fc07c6ed4687d4a1d0de2d9fd7d0c10aec9deb30e27e4293d04da
                           d8 31         # tag(49)   ; envelope
                              d8 38      # tag(56)   ; crypto-digest
                                 5820    # bytes(32)
                                    297663a89761f188811a986adb613ac0d9f30d17f12404f4a30d52674d71977e
                           d8 31         # tag(49)   ; envelope
                              d8 38      # tag(56)   ; crypto-digest
                                 5820    # bytes(32)
                                    30676599c0c8fd8ee4cb6204efbaa1a5bcb758664e2bed7cde6fb96e2684cb17
                           d8 31         # tag(49)   ; envelope
                              d8 38      # tag(56)   ; crypto-digest
                                 5820    # bytes(32)
                                    3ca92e43584b6150c717019d6d2aa29f66c6f1acf61ee1b1162da694454b0221
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          65 # text(5)
                                             696d616765 # "image"
                                    d8 31 # tag(49)   ; envelope
                                       83 # array(3)
                                          d8 3c # tag(60)   ; plaintext
                                             d8 38 # tag(56)   ; crypto-digest
                                                5820 # bytes(32)
                                                   36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999
                                          d8 31 # tag(49)   ; envelope
                                             d8 3f # tag(63)   ; plaintext
                                                82 # array(2)
                                                   d8 31 # tag(49)   ; envelope
                                                      d8 3c # tag(60)   ; plaintext
                                                         d8 3b # tag(59)   ; predicate
                                                            09 # unsigned(9)
                                                   d8 31 # tag(49)   ; envelope
                                                      d8 3c # tag(60)   ; plaintext
                                                         78 61 # text(97)
                                                            68747470733a2f2f6578616d706c656c65646765722e636f6d2f6469676573742f33366265333037323662656662363563613133623133366165323964383038316636343739326332373032343135656236306164316335366564333363393939 # "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                                          d8 31 # tag(49)   ; envelope
                                             d8 3f # tag(63)   ; plaintext
                                                82 # array(2)
                                                   d8 31 # tag(49)   ; envelope
                                                      d8 3c # tag(60)   ; plaintext
                                                         d8 3b # tag(59)   ; predicate
                                                            04 # unsigned(4)
                                                   d8 31 # tag(49)   ; envelope
                                                      d8 3c # tag(60)   ; plaintext
                                                         78 1f # text(31)
                                                            5468697320697320616e20696d616765206f66204a6f686e20536d6974682e # "This is an image of John Smith."
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          6a # text(10)
                                             66616d696c794e616d65 # "familyName"
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          65 # text(5)
                                             534d495448 # "SMITH"
                           d8 31         # tag(49)   ; envelope
                              d8 38      # tag(56)   ; crypto-digest
                                 5820    # bytes(32)
                                    6b33f124d1b1270d77d627caa2b5ab2a313a4986fa74d2470adc21f743f94ed3
                           d8 31         # tag(49)   ; envelope
                              d8 38      # tag(56)   ; crypto-digest
                                 5820    # bytes(32)
                                    87ffe8b234ff509bf372f7e0917b351d7b7879a94f6c84771b1355d6b29f7742
                           d8 31         # tag(49)   ; envelope
                              d8 38      # tag(56)   ; crypto-digest
                                 5820    # bytes(32)
                                    d52b6f91e5df305002848bfd3ddb646bd52c87eb46e83298c61a70cd361700f5
                           d8 31         # tag(49)   ; envelope
                              d8 38      # tag(56)   ; crypto-digest
                                 5820    # bytes(32)
                                    df0398cd0b3b1b8eb73d26b092602a0e59a8313d61182b8ac35268ee862aa5f2
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          69 # text(9)
                                             676976656e4e616d65 # "givenName"
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          64 # text(4)
                                             4a4f484e # "JOHN"
            d8 31                        # tag(49)   ; envelope
               d8 3f                     # tag(63)   ; plaintext
                  82                     # array(2)
                     d8 31               # tag(49)   ; envelope
                        d8 3c            # tag(60)   ; plaintext
                           d8 3b         # tag(59)   ; predicate
                              0d         # unsigned(13)
                     d8 31               # tag(49)   ; envelope
                        83               # array(3)
                           d8 3c         # tag(60)   ; plaintext
                              d8 3a      # tag(58)   ; crypto-cid
                                 5820    # bytes(32)
                                    04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          d8 3b # tag(59)   ; predicate
                                             04 # unsigned(4)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          78 1e # text(30)
                                             49737375656420627920746865205374617465206f66204578616d706c65 # "Issued by the State of Example"
                           d8 31         # tag(49)   ; envelope
                              d8 3f      # tag(63)   ; plaintext
                                 82      # array(2)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          d8 3b # tag(59)   ; predicate
                                             09 # unsigned(9)
                                    d8 31 # tag(49)   ; envelope
                                       d8 3c # tag(60)   ; plaintext
                                          d8 20 # tag(32)   ; uri
                                             78 5e # text(94)
                                                68747470733a2f2f6578616d706c656c65646765722e636f6d2f6369642f30343336336435666639393733336263306631353737626162613434306166316366333434616439653435346661643964313238633030666566363530356538 # "https://exampleledger.com/cid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8"
      d8 31                              # tag(49)   ; envelope
         d8 3f                           # tag(63)   ; plaintext
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        03               # unsigned(3)
               d8 31                     # tag(49)   ; envelope
                  82                     # array(2)
                     d8 3c               # tag(60)   ; plaintext
                        d8 3d            # tag(61)   ; signature
                           5840          # bytes(64)
                              ab3fee8a0005267158736212502afb87648dd0cce3996036630b9eb3a0e891af3c62c6c6e7db8f2c7646554914461b8acc94faa3b16a4d2f66578ec709137577
                     d8 31               # tag(49)   ; envelope
                        d8 3f            # tag(63)   ; plaintext
                           82            # array(2)
                              d8 31      # tag(49)   ; envelope
                                 d8 3c   # tag(60)   ; plaintext
                                    d8 3b # tag(59)   ; predicate
                                       04 # unsigned(4)
                              d8 31      # tag(49)   ; envelope
                                 d8 3c   # tag(60)   ; plaintext
                                    78 1d # text(29)
                                       4d61646520627920746865205374617465206f66204578616d706c652e # "Made by the State of Example."
```

---
