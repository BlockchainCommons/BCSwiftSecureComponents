# Secure Components - Envelope Test Vectors

**Authors:** Wolf McNally, Christopher Allen, Blockchain Commons</br>
**Revised:** Jul 27, 2022</br>
**Status:** DRAFT

## Contents

* [Overview](1-OVERVIEW.md)
* [Envelope Overview](2-ENVELOPE.md)
* [Envelope Notation](3-ENVELOPE-NOTATION.md)
* [Envelope Expressions](4-ENVELOPE-EXPRESSIONS.md)
* [Definitions](5-DEFINITIONS.md)
* [Examples](6-EXAMPLES.md)
* Envelope Test Vectors: This document
* [Envelope SSKR Test Vectors](8-ENVELOPE-SSKR-TEST-VECTORS.md)

---

## Introduction

This document provides test vectors for `crypto-envelope`. It is generated by `EnvelopeTestVectors.testGenerateEnvelopeTestVectors()` in the `BCSwiftSecureComponents` test suite.

## Status

This document is a draft with a reference implementation in [BCSwiftSecureComponents](https://github.com/blockchaincommons/BCSwiftSecureComponents).

---

These test vectors use these fixed seed values, from which other key pairs are derived:

* Alice's Seed: `82f32c855d3d542256180810797e0073`
* Bob's Seed: `187a5973c64d359c836eba466a44db7b`
* Carol's Seed: `8574afab18e229651c1be8f76ffee523`
* Symmetric Key: `38900719dea655e9a1bc1682aaccf0bfcd79a7239db672d39216e4acdd660dc0`

## INDEX

1. [Hello, World!](#TEST-VECTOR-1-Hello-World)
2. [Signed Plaintext](#TEST-VECTOR-2-Signed-Plaintext)
3. [Multisigned Plaintext](#TEST-VECTOR-3-Multisigned-Plaintext)
4. [Symmetric Encryption](#TEST-VECTOR-4-Symmetric-Encryption)
5. [Sign Then Encrypt](#TEST-VECTOR-5-Sign-Then-Encrypt)

---

## TEST VECTOR 1: Hello, World!

The simplest case: encoding a plaintext string as the envelope's `subject`. The `subject` can be any CBOR-encodable structure.

### Payload

ðŸ‘‰ _In Envelope Notation._

```
"Hello."
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:crypto-envelope/tpfniyfdihjzjzjldmtklproam
```

### Tagged CBOR Binary

```
d831d83c6648656c6c6f2e
```

### Tagged CBOR Diagnostic Notation

```
49(   ; crypto-envelope
   60("Hello.")   ; plaintext
)
```

### Tagged CBOR Annotated Binary

```
d8 31                 # tag(49)   ; crypto-envelope
   d8 3c              # tag(60)   ; plaintext
      66              # text(6)
         48656c6c6f2e # "Hello."
```

---

## TEST VECTOR 2: Signed Plaintext

A string has been signed by Alice.

### Payload

ðŸ‘‰ _In Envelope Notation._

```
"Hello." [
    verifiedBy: Signature
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:crypto-envelope/lftpfniyfdihjzjzjldmlftpehtpfntpfraxtpehtpfntpfshdfzktpkcpbzcsiyeyzedtencshghdguswamwlutceetttlfsshlfsdiwzptosinetpshksnzmmdgmroosylswfybegdmhpdmoesykkthsssbwgdgdurtlmhvlhftlidbkftuynblswp
```

### Tagged CBOR Binary

```
d83182d83c6648656c6c6f2e82d831d83cd83b03d831d83cd83d584077aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

### Tagged CBOR Diagnostic Notation

```
49(   ; crypto-envelope
   [
      60("Hello.")   ; plaintext,
      [
         49(   ; crypto-envelope
            60(   ; plaintext
               59(3)   ; predicate
            )
         ),
         49(   ; crypto-envelope
            60(   ; plaintext
               61(   ; signature
                  h'77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a'
               )
            )
         )
      ]
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; crypto-envelope
   82                                    # array(2)
      d8 3c                              # tag(60)   ; plaintext
         66                              # text(6)
            48656c6c6f2e                 # "Hello."
      82                                 # array(2)
         d8 31                           # tag(49)   ; crypto-envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3b                     # tag(59)   ; predicate
                  03                     # unsigned(3)
         d8 31                           # tag(49)   ; crypto-envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3d                     # tag(61)   ; signature
                  5840                   # bytes(64)
                     77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

---

## TEST VECTOR 3: Multisigned Plaintext

Alice and Carol jointly send a signed plaintext message to Bob.

### Payload

ðŸ‘‰ _In Envelope Notation._

```
"Hello." [
    verifiedBy: Signature
    verifiedBy: Signature
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:crypto-envelope/lstpfniyfdihjzjzjldmlftpehtpfntpfraxtpehtpfntpfshdfzceoxaemteepkgwbzeylgplplsehlurstinjtcmrthfhginuesamoktpllrwlgooyrfcpeofrhfztyljydycpmwfmoshdkgdsotamieleaamkylghsfgtvoasdijoropalftpehtpfntpfraxtpehtpfntpfshdfzktpkcpbzcsiyeyzedtencshghdguswamwlutceetttlfsshlfsdiwzptosinetpshksnzmmdgmroosylswfybegdmhpdmoesykkthsssbwgdgdurtlmhvlhftlidbkftvwbdwmlg
```

### Tagged CBOR Binary

```
d83183d83c6648656c6c6f2e82d831d83cd83b03d831d83cd83d58401ca4009634aa4f15328daeaec15ddfc7696e16c0565769dec29277ae84e955a1bc22333b56fcf7743022943ea7587b26a306648a0498f754cc4de2092770b8b182d831d83cd83b03d831d83cd83d584077aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

### Tagged CBOR Diagnostic Notation

```
49(   ; crypto-envelope
   [
      60("Hello.")   ; plaintext,
      [
         49(   ; crypto-envelope
            60(   ; plaintext
               59(3)   ; predicate
            )
         ),
         49(   ; crypto-envelope
            60(   ; plaintext
               61(   ; signature
                  h'1ca4009634aa4f15328daeaec15ddfc7696e16c0565769dec29277ae84e955a1bc22333b56fcf7743022943ea7587b26a306648a0498f754cc4de2092770b8b1'
               )
            )
         )
      ],
      [
         49(   ; crypto-envelope
            60(   ; plaintext
               59(3)   ; predicate
            )
         ),
         49(   ; crypto-envelope
            60(   ; plaintext
               61(   ; signature
                  h'77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a'
               )
            )
         )
      ]
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; crypto-envelope
   83                                    # array(3)
      d8 3c                              # tag(60)   ; plaintext
         66                              # text(6)
            48656c6c6f2e                 # "Hello."
      82                                 # array(2)
         d8 31                           # tag(49)   ; crypto-envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3b                     # tag(59)   ; predicate
                  03                     # unsigned(3)
         d8 31                           # tag(49)   ; crypto-envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3d                     # tag(61)   ; signature
                  5840                   # bytes(64)
                     1ca4009634aa4f15328daeaec15ddfc7696e16c0565769dec29277ae84e955a1bc22333b56fcf7743022943ea7587b26a306648a0498f754cc4de2092770b8b1
      82                                 # array(2)
         d8 31                           # tag(49)   ; crypto-envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3b                     # tag(59)   ; predicate
                  03                     # unsigned(3)
         d8 31                           # tag(49)   ; crypto-envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3d                     # tag(61)   ; signature
                  5840                   # bytes(64)
                     77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

---

## TEST VECTOR 4: Symmetric Encryption

Alice and Bob have agreed to use a symmetric key.

### Payload

ðŸ‘‰ _In Envelope Notation._

```
EncryptedMessage
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:crypto-envelope/tpdylrflytcwjpmspfiogmgsgtkshfhdwfjzcpzohtweftrtgdtnjlkpidntttbayldptirpzoldwekolyhddktpethdcxloimbnlplsdloycftluoftcfguayrsbwghlbctcmplwteyynsawsnlbgsnhkmovwlpfgclge
```

### Tagged CBOR Binary

```
d831d8308447f91b7297b067524c4d785658f36c22fb5aed3ac050da6f75629dd10ef72dd0b6fb89ed76815824d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
```

### Tagged CBOR Diagnostic Notation

```
49(   ; crypto-envelope
   48(   ; crypto-msg
      [
         h'f91b7297b06752',
         h'4d785658f36c22fb5aed3ac0',
         h'da6f75629dd10ef72dd0b6fb89ed7681',
         h'd8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5'
      ]
   )
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; crypto-envelope
   d8 30                                 # tag(48)   ; crypto-msg
      84                                 # array(4)
         47                              # bytes(7)
            f91b7297b06752
         4c                              # bytes(12)
            4d785658f36c22fb5aed3ac0
         50                              # bytes(16)
            da6f75629dd10ef72dd0b6fb89ed7681
         5824                            # bytes(36)
            d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
```

---

## TEST VECTOR 5: Sign Then Encrypt

A message is first signed, then encrypted. Its signature can only be checked once the envelope is decrypted.

### Payload

ðŸ‘‰ _In Envelope Notation._

```
EncryptedMessage
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:crypto-envelope/tpdylrhdhhflidmdcnvtjteeaectiskssknygscpasswamnszmuemeestpgavteykpehgdureyvecmfnnyskkbpsmuaxflssntykksdnayinmugrlyrogsamimvthkolpmaanyoslosfgylptlfwsodmhnrfmevomkswbzuefwftttflhkchuejetnamrlaxqzgsgtkshfhdwfjzcpzohtweftrtgdtnlthtchsejpbkwmctpdahayynutbzfzhddktpethdcxlfrhdwrhkbqdiymerkhhidpldpmessmsidcxaxnnsatlweteglldsriojkuywynyjlfndkat
```

### Tagged CBOR Binary

```
d831d83084585c47629523e06e34001f6878c59a4c2209c6069cffde9139d849e032753150df32e4163c9ac57eac930347c49df5782b0869934b81b84c066ae059a6ad049aa788cc5185d542c92e60bc91e298c615de423ad1475917de6bda06b703b44c4d785658f36c22fb5aed3ac050da875a17c1720aeb1fa80508f6dd15405824d838582082b92cb97eb36691bb5c62ae2d91c4976220039ec2d5edd34e89c36773dbee9a
```

### Tagged CBOR Diagnostic Notation

```
49(   ; crypto-envelope
   48(   ; crypto-msg
      [
         h'47629523e06e34001f6878c59a4c2209c6069cffde9139d849e032753150df32e4163c9ac57eac930347c49df5782b0869934b81b84c066ae059a6ad049aa788cc5185d542c92e60bc91e298c615de423ad1475917de6bda06b703b4',
         h'4d785658f36c22fb5aed3ac0',
         h'da875a17c1720aeb1fa80508f6dd1540',
         h'd838582082b92cb97eb36691bb5c62ae2d91c4976220039ec2d5edd34e89c36773dbee9a'
      ]
   )
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; crypto-envelope
   d8 30                                 # tag(48)   ; crypto-msg
      84                                 # array(4)
         585c                            # bytes(92)
            47629523e06e34001f6878c59a4c2209c6069cffde9139d849e032753150df32e4163c9ac57eac930347c49df5782b0869934b81b84c066ae059a6ad049aa788cc5185d542c92e60bc91e298c615de423ad1475917de6bda06b703b4
         4c                              # bytes(12)
            4d785658f36c22fb5aed3ac0
         50                              # bytes(16)
            da875a17c1720aeb1fa80508f6dd1540
         5824                            # bytes(36)
            d838582082b92cb97eb36691bb5c62ae2d91c4976220039ec2d5edd34e89c36773dbee9a
```

---
