# Secure Components - Envelope Test Vectors

**Authors:** Wolf McNally, Christopher Allen, Blockchain Commons</br>
**Revised:** Aug 12, 2022</br>
**Status:** DRAFT

## Contents

* [Overview](1-OVERVIEW.md)
* [Envelope Overview](2-ENVELOPE.md)
* [Envelope Notation](3-ENVELOPE-NOTATION.md)
* [Envelope Expressions](4-ENVELOPE-EXPRESSIONS.md)
* [Definitions](5-DEFINITIONS.md)
* [Examples](6-EXAMPLES.md)
* Envelope Test Vectors: This document
* [Envelope SSKR Test Vectors](8-ENVELOPE-SSKR-TEST-VECTORS.md)

---

## Introduction

This document provides test vectors for `envelope`. It is generated by `EnvelopeTestVectors.testGenerateEnvelopeTestVectors()` in the `BCSwiftSecureComponents` test suite.

## Status

This document is a draft with a reference implementation in [BCSwiftSecureComponents](https://github.com/blockchaincommons/BCSwiftSecureComponents).

---

These test vectors use these fixed seed values, from which other key pairs are derived:

* Alice's Seed: `82f32c855d3d542256180810797e0073`
* Bob's Seed: `187a5973c64d359c836eba466a44db7b`
* Carol's Seed: `8574afab18e229651c1be8f76ffee523`

These objects are normally random, but they are fixed for these test vectors:

* Symmetric key used for encryption: `526afd95b2229c5381baec4a1788507a3c4a566ca5cce64543b46ad12aff0035`
* Nonce for encryption: `4d785658f36c22fb5aed3ac0`
* Random generator for signing returns repeating sequence: `dca8cfe8e67d03fab4177279d5498e7a`

## INDEX

1. [Hello, World!](#TEST-VECTOR-1-Hello-World)
2. [Signed Plaintext](#TEST-VECTOR-2-Signed-Plaintext)
3. [Multisigned Plaintext](#TEST-VECTOR-3-Multisigned-Plaintext)
4. [Symmetric Encryption](#TEST-VECTOR-4-Symmetric-Encryption)
5. [Sign Then Encrypt](#TEST-VECTOR-5-Sign-Then-Encrypt)
6. [Encrypt Then Sign](#TEST-VECTOR-6-Encrypt-Then-Sign)
7. [Multi-Recipient](#TEST-VECTOR-7-MultiRecipient)
8. [Visible Signature Multi-Recipient](#TEST-VECTOR-8-Visible-Signature-MultiRecipient)
9. [Verifiable Credential](#TEST-VECTOR-9-Verifiable-Credential)
10. [Redacted Verifiable Credential](#TEST-VECTOR-10-Redacted-Verifiable-Credential)

---

## TEST VECTOR 1: Hello, World!

The simplest case: encoding a plaintext string as the envelope's `subject`. The `subject` can be any CBOR-encodable structure.

### Payload in Envelope Notation

```
"Hello."
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/tpfniyfdihjzjzjldmtklproam
```

### Tagged CBOR Binary

```
d831d83c6648656c6c6f2e
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   60("Hello.")   ; plaintext
)
```

### Tagged CBOR Annotated Binary

```
d8 31                 # tag(49)   ; envelope
   d8 3c              # tag(60)   ; plaintext
      66              # text(6)
         48656c6c6f2e # "Hello."
```

---

## TEST VECTOR 2: Signed Plaintext

A string has been signed by Alice.

### Payload in Envelope Notation

```
"Hello." [
    verifiedBy: Signature
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lftpfniyfdihjzjzjldmlftpehtpfntpfraxtpehtpfntpfshdfzktpkcpbzcsiyeyzedtencshghdguswamwlutceetttlfsshlfsdiwzptosinetpshksnzmmdgmroosylswfybegdmhpdmoesykkthsssbwgdgdurtlmhvlhftlidbkftuynblswp
```

### Tagged CBOR Binary

```
d83182d83c6648656c6c6f2e82d831d83cd83b03d831d83cd83d584077aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   [
      60("Hello.")   ; plaintext,
      [
         49(   ; envelope
            60(   ; plaintext
               59(3)   ; predicate
            )
         ),
         49(   ; envelope
            60(   ; plaintext
               61(   ; signature
                  h'77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a'
               )
            )
         )
      ]
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   82                                    # array(2)
      d8 3c                              # tag(60)   ; plaintext
         66                              # text(6)
            48656c6c6f2e                 # "Hello."
      82                                 # array(2)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3b                     # tag(59)   ; predicate
                  03                     # unsigned(3)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3d                     # tag(61)   ; signature
                  5840                   # bytes(64)
                     77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

---

## TEST VECTOR 3: Multisigned Plaintext

Alice and Carol jointly send a signed plaintext message to Bob.

### Payload in Envelope Notation

```
"Hello." [
    verifiedBy: Signature
    verifiedBy: Signature
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lstpfniyfdihjzjzjldmlftpehtpfntpfraxtpehtpfntpfshdfzceoxaemteepkgwbzeylgplplsehlurstinjtcmrthfhginuesamoktpllrwlgooyrfcpeofrhfztyljydycpmwfmoshdkgdsotamieleaamkylghsfgtvoasdijoropalftpehtpfntpfraxtpehtpfntpfshdfzktpkcpbzcsiyeyzedtencshghdguswamwlutceetttlfsshlfsdiwzptosinetpshksnzmmdgmroosylswfybegdmhpdmoesykkthsssbwgdgdurtlmhvlhftlidbkftvwbdwmlg
```

### Tagged CBOR Binary

```
d83183d83c6648656c6c6f2e82d831d83cd83b03d831d83cd83d58401ca4009634aa4f15328daeaec15ddfc7696e16c0565769dec29277ae84e955a1bc22333b56fcf7743022943ea7587b26a306648a0498f754cc4de2092770b8b182d831d83cd83b03d831d83cd83d584077aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   [
      60("Hello.")   ; plaintext,
      [
         49(   ; envelope
            60(   ; plaintext
               59(3)   ; predicate
            )
         ),
         49(   ; envelope
            60(   ; plaintext
               61(   ; signature
                  h'1ca4009634aa4f15328daeaec15ddfc7696e16c0565769dec29277ae84e955a1bc22333b56fcf7743022943ea7587b26a306648a0498f754cc4de2092770b8b1'
               )
            )
         )
      ],
      [
         49(   ; envelope
            60(   ; plaintext
               59(3)   ; predicate
            )
         ),
         49(   ; envelope
            60(   ; plaintext
               61(   ; signature
                  h'77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a'
               )
            )
         )
      ]
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   83                                    # array(3)
      d8 3c                              # tag(60)   ; plaintext
         66                              # text(6)
            48656c6c6f2e                 # "Hello."
      82                                 # array(2)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3b                     # tag(59)   ; predicate
                  03                     # unsigned(3)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3d                     # tag(61)   ; signature
                  5840                   # bytes(64)
                     1ca4009634aa4f15328daeaec15ddfc7696e16c0565769dec29277ae84e955a1bc22333b56fcf7743022943ea7587b26a306648a0498f754cc4de2092770b8b1
      82                                 # array(2)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3b                     # tag(59)   ; predicate
                  03                     # unsigned(3)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3d                     # tag(61)   ; signature
                  5840                   # bytes(64)
                     77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

---

## TEST VECTOR 4: Symmetric Encryption

Alice and Bob have agreed to use a symmetric key.

### Payload in Envelope Notation

```
EncryptedMessage
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/tpdylrflrlbnplynmdhdpkgsgtkshfhdwfjzcpzohtweftrtgdmsuecktbdivotduentfrspgmastegdtshddktpethdcxloimbnlplsdloycftluoftcfguayrsbwghlbctcmplwteyynsawsnlbgsnhkmovwieclaaen
```

### Tagged CBOR Binary

```
d831d8308447b70caef69558aa4c4d785658f36c22fb5aed3ac05097de1ed627e2d2de9d3bc85209d350d75824d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   48(   ; crypto-msg
      [
         h'b70caef69558aa',
         h'4d785658f36c22fb5aed3ac0',
         h'97de1ed627e2d2de9d3bc85209d350d7',
         h'd8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5'
      ]
   )
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   d8 30                                 # tag(48)   ; crypto-msg
      84                                 # array(4)
         47                              # bytes(7)
            b70caef69558aa
         4c                              # bytes(12)
            4d785658f36c22fb5aed3ac0
         50                              # bytes(16)
            97de1ed627e2d2de9d3bc85209d350d7
         5824                            # bytes(36)
            d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
```

---

## TEST VECTOR 5: Sign Then Encrypt

A message is first signed, then encrypted. Its signature can only be checked once the envelope is decrypted.

### Payload in Envelope Notation

```
EncryptedMessage
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/tpdylrhdhhaskpgafwskgysfsrghkofptihsstrnihpfwpgwkptpsbkgutynlgdihhwtgeytbbotrlmdtpetnthdpsfnfddppkdagaldctgywdhnmwhshtnlzmmutpwdiyrkrepyrezcfxqdlupyhdhtpkveroeerkjpdscltdksenrphnfrcsonnyynyafhhtgsgtkshfhdwfjzcpzohtweftrtgdutlektlfbemnnnntadmsluiasggdfncxhddktpethdcxlfrhdwrhkbqdiymerkhhidpldpmessmsidcxaxnnsatlweteglldsriojkuywynygttdinpm
```

### Tagged CBOR Binary

```
d831d83084585c09754942c551ccc3547641d061c7be65b0ec4f75d8cb7bddf68d275cf04af914a3b795d8389d58ac3c482daa2549891f51ea6094615a99ff93d8ea66bbb5abb5fd43b38bab585aaae4b834bb722621d27836b6603b18a59af6f83f5a4c4d785658f36c22fb5aed3ac050dd8a7782108e9e9d01978b63ca503c205824d838582082b92cb97eb36691bb5c62ae2d91c4976220039ec2d5edd34e89c36773dbee9a
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   48(   ; crypto-msg
      [
         h'09754942c551ccc3547641d061c7be65b0ec4f75d8cb7bddf68d275cf04af914a3b795d8389d58ac3c482daa2549891f51ea6094615a99ff93d8ea66bbb5abb5fd43b38bab585aaae4b834bb722621d27836b6603b18a59af6f83f5a',
         h'4d785658f36c22fb5aed3ac0',
         h'dd8a7782108e9e9d01978b63ca503c20',
         h'd838582082b92cb97eb36691bb5c62ae2d91c4976220039ec2d5edd34e89c36773dbee9a'
      ]
   )
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   d8 30                                 # tag(48)   ; crypto-msg
      84                                 # array(4)
         585c                            # bytes(92)
            09754942c551ccc3547641d061c7be65b0ec4f75d8cb7bddf68d275cf04af914a3b795d8389d58ac3c482daa2549891f51ea6094615a99ff93d8ea66bbb5abb5fd43b38bab585aaae4b834bb722621d27836b6603b18a59af6f83f5a
         4c                              # bytes(12)
            4d785658f36c22fb5aed3ac0
         50                              # bytes(16)
            dd8a7782108e9e9d01978b63ca503c20
         5824                            # bytes(36)
            d838582082b92cb97eb36691bb5c62ae2d91c4976220039ec2d5edd34e89c36773dbee9a
```

---

## TEST VECTOR 6: Encrypt Then Sign

A message is first encrypted, then signed. Its signature may be checked before the envelope is decrypted.

### Payload in Envelope Notation

```
EncryptedMessage [
    verifiedBy: Signature
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lftpdylrflrlbnplynmdhdpkgsgtkshfhdwfjzcpzohtweftrtgdmsuecktbdivotduentfrspgmastegdtshddktpethdcxloimbnlplsdloycftluoftcfguayrsbwghlbctcmplwteyynsawsnlbgsnhkmovwlftpehtpfntpfraxtpehtpfntpfshdfzktpkcpbzcsiyeyzedtencshghdguswamwlutceetttlfsshlfsdiwzptosinetpshksnzmmdgmroosylswfybegdmhpdmoesykkthsssbwgdgdurtlmhvlhftlidbkftmesnlghl
```

### Tagged CBOR Binary

```
d83182d8308447b70caef69558aa4c4d785658f36c22fb5aed3ac05097de1ed627e2d2de9d3bc85209d350d75824d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e582d831d83cd83b03d831d83cd83d584077aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   [
      48(   ; crypto-msg
         [
            h'b70caef69558aa',
            h'4d785658f36c22fb5aed3ac0',
            h'97de1ed627e2d2de9d3bc85209d350d7',
            h'd8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5'
         ]
      ),
      [
         49(   ; envelope
            60(   ; plaintext
               59(3)   ; predicate
            )
         ),
         49(   ; envelope
            60(   ; plaintext
               61(   ; signature
                  h'77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a'
               )
            )
         )
      ]
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   82                                    # array(2)
      d8 30                              # tag(48)   ; crypto-msg
         84                              # array(4)
            47                           # bytes(7)
               b70caef69558aa
            4c                           # bytes(12)
               4d785658f36c22fb5aed3ac0
            50                           # bytes(16)
               97de1ed627e2d2de9d3bc85209d350d7
            5824                         # bytes(36)
               d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
      82                                 # array(2)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3b                     # tag(59)   ; predicate
                  03                     # unsigned(3)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3d                     # tag(61)   ; signature
                  5840                   # bytes(64)
                     77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

---

## TEST VECTOR 7: Multi-Recipient

Alice encrypts a message using the public keys of Bob and Carol so that it can only be decrypted by the private key of either Bob or Carol. Each of the `SealedMessage` encrypts just the symmetric key used to encrypt the payload.

### Payload in Envelope Notation

```
EncryptedMessage [
    hasRecipient: SealedMessage
    hasRecipient: SealedMessage
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lstpdylrflrlbnplynmdhdpkgsgtkshfhdwfjzcpzohtweftrtgdmsuecktbdivotduentfrspgmastegdtshddktpethdcxloimbnlplsdloycftluoftcfguayrsbwghlbctcmplwteyynsawsnlbgsnhkmovwlftpehtpfntpfrahtpehtpfntpemlftpdylshddkfgcewybnaaurnsrlvlwekkdtiochbbdtspceoxwfcttletfwihamcsahdmhdwsldswgukeoegsgtkshfhdwfjzcpzohtweftrtgdlpktwkiyttuyonmosfgwyadruohkjnvotpfmhdcxgsgdldnevokicpsgledwwefesnstolnnvtisfzrfrtcamkahlecpmnaxrpmsghjzlftpehtpfntpfrahtpehtpfntpemlftpdylshddkjpfebsdnqdatsprsaxbytojllnkohytnnyiewdftdwntnnesqzcnrplskngshlbneminpeeegsgtkshfhdwfjzcpzohtweftrtgdjogauovyzogwaxhheouebdrnkbvlvefytpfmhdcxgsgdldnevokicpsgledwwefesnstolnnvtisfzrfrtcamkahlecpmnaxrpmsghjzqdwzpeol
```

### Tagged CBOR Binary

```
d83183d8308447b70caef69558aa4c4d785658f36c22fb5aed3ac05097de1ed627e2d2de9d3bc85209d350d75824d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e582d831d83cd83b05d831d83cd83782d830835824461cee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca24c4d785658f36c22fb5aed3ac0508577f466d1dba592cc4ff82adc596de2d83e58204c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c82d831d83cd83b05d831d83cd83782d83083582472450f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af344c4d785658f36c22fb5aed3ac0507049dce1fb4f035c33de0bbe7ee3e444d83e58204c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   [
      48(   ; crypto-msg
         [
            h'b70caef69558aa',
            h'4d785658f36c22fb5aed3ac0',
            h'97de1ed627e2d2de9d3bc85209d350d7',
            h'd8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5'
         ]
      ),
      [
         49(   ; envelope
            60(   ; plaintext
               59(5)   ; predicate
            )
         ),
         49(   ; envelope
            60(   ; plaintext
               55(   ; crypto-sealed
                  [
                     48(   ; crypto-msg
                        [
                           h'461cee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca2',
                           h'4d785658f36c22fb5aed3ac0',
                           h'8577f466d1dba592cc4ff82adc596de2'
                        ]
                     ),
                     62(   ; agreement-public-key
                        h'4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c'
                     )
                  ]
               )
            )
         )
      ],
      [
         49(   ; envelope
            60(   ; plaintext
               59(5)   ; predicate
            )
         ),
         49(   ; envelope
            60(   ; plaintext
               55(   ; crypto-sealed
                  [
                     48(   ; crypto-msg
                        [
                           h'72450f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af34',
                           h'4d785658f36c22fb5aed3ac0',
                           h'7049dce1fb4f035c33de0bbe7ee3e444'
                        ]
                     ),
                     62(   ; agreement-public-key
                        h'4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c'
                     )
                  ]
               )
            )
         )
      ]
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   83                                    # array(3)
      d8 30                              # tag(48)   ; crypto-msg
         84                              # array(4)
            47                           # bytes(7)
               b70caef69558aa
            4c                           # bytes(12)
               4d785658f36c22fb5aed3ac0
            50                           # bytes(16)
               97de1ed627e2d2de9d3bc85209d350d7
            5824                         # bytes(36)
               d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
      82                                 # array(2)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3b                     # tag(59)   ; predicate
                  05                     # unsigned(5)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 37                     # tag(55)   ; crypto-sealed
                  82                     # array(2)
                     d8 30               # tag(48)   ; crypto-msg
                        83               # array(3)
                           5824          # bytes(36)
                              461cee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca2
                           4c            # bytes(12)
                              4d785658f36c22fb5aed3ac0
                           50            # bytes(16)
                              8577f466d1dba592cc4ff82adc596de2
                     d8 3e               # tag(62)   ; agreement-public-key
                        5820             # bytes(32)
                           4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
      82                                 # array(2)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3b                     # tag(59)   ; predicate
                  05                     # unsigned(5)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 37                     # tag(55)   ; crypto-sealed
                  82                     # array(2)
                     d8 30               # tag(48)   ; crypto-msg
                        83               # array(3)
                           5824          # bytes(36)
                              72450f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af34
                           4c            # bytes(12)
                              4d785658f36c22fb5aed3ac0
                           50            # bytes(16)
                              7049dce1fb4f035c33de0bbe7ee3e444
                     d8 3e               # tag(62)   ; agreement-public-key
                        5820             # bytes(32)
                           4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
```

---

## TEST VECTOR 8: Visible Signature Multi-Recipient

Alice encrypts a message using the public keys of Bob and Carol so that it can only be decrypted by the private key of either Bob or Carol. Each of the `SealedMessage` encrypts just the symmetric key used to encrypt the payload. Alice then signs the envelope so her signature may be verified by anyone with her public key.

### Payload in Envelope Notation

```
EncryptedMessage [
    hasRecipient: SealedMessage
    hasRecipient: SealedMessage
    verifiedBy: Signature
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lrtpdylrflrlbnplynmdhdpkgsgtkshfhdwfjzcpzohtweftrtgdmsuecktbdivotduentfrspgmastegdtshddktpethdcxloimbnlplsdloycftluoftcfguayrsbwghlbctcmplwteyynsawsnlbgsnhkmovwlftpehtpfntpfraxtpehtpfntpfshdfzktpkcpbzcsiyeyzedtencshghdguswamwlutceetttlfsshlfsdiwzptosinetpshksnzmmdgmroosylswfybegdmhpdmoesykkthsssbwgdgdurtlmhvlhftlidbkftlftpehtpfntpfrahtpehtpfntpemlftpdylshddkfgcewybnaaurnsrlvlwekkdtiochbbdtspceoxwfcttletfwihamcsahdmhdwsldswgukeoegsgtkshfhdwfjzcpzohtweftrtgdlpktwkiyttuyonmosfgwyadruohkjnvotpfmhdcxgsgdldnevokicpsgledwwefesnstolnnvtisfzrfrtcamkahlecpmnaxrpmsghjzlftpehtpfntpfrahtpehtpfntpemlftpdylshddkjpfebsdnqdatsprsaxbytojllnkohytnnyiewdftdwntnnesqzcnrplskngshlbneminpeeegsgtkshfhdwfjzcpzohtweftrtgdjogauovyzogwaxhheouebdrnkbvlvefytpfmhdcxgsgdldnevokicpsgledwwefesnstolnnvtisfzrfrtcamkahlecpmnaxrpmsghjzvepapscl
```

### Tagged CBOR Binary

```
d83184d8308447b70caef69558aa4c4d785658f36c22fb5aed3ac05097de1ed627e2d2de9d3bc85209d350d75824d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e582d831d83cd83b03d831d83cd83d584077aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a82d831d83cd83b05d831d83cd83782d830835824461cee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca24c4d785658f36c22fb5aed3ac0508577f466d1dba592cc4ff82adc596de2d83e58204c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c82d831d83cd83b05d831d83cd83782d83083582472450f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af344c4d785658f36c22fb5aed3ac0507049dce1fb4f035c33de0bbe7ee3e444d83e58204c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   [
      48(   ; crypto-msg
         [
            h'b70caef69558aa',
            h'4d785658f36c22fb5aed3ac0',
            h'97de1ed627e2d2de9d3bc85209d350d7',
            h'd8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5'
         ]
      ),
      [
         49(   ; envelope
            60(   ; plaintext
               59(3)   ; predicate
            )
         ),
         49(   ; envelope
            60(   ; plaintext
               61(   ; signature
                  h'77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a'
               )
            )
         )
      ],
      [
         49(   ; envelope
            60(   ; plaintext
               59(5)   ; predicate
            )
         ),
         49(   ; envelope
            60(   ; plaintext
               55(   ; crypto-sealed
                  [
                     48(   ; crypto-msg
                        [
                           h'461cee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca2',
                           h'4d785658f36c22fb5aed3ac0',
                           h'8577f466d1dba592cc4ff82adc596de2'
                        ]
                     ),
                     62(   ; agreement-public-key
                        h'4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c'
                     )
                  ]
               )
            )
         )
      ],
      [
         49(   ; envelope
            60(   ; plaintext
               59(5)   ; predicate
            )
         ),
         49(   ; envelope
            60(   ; plaintext
               55(   ; crypto-sealed
                  [
                     48(   ; crypto-msg
                        [
                           h'72450f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af34',
                           h'4d785658f36c22fb5aed3ac0',
                           h'7049dce1fb4f035c33de0bbe7ee3e444'
                        ]
                     ),
                     62(   ; agreement-public-key
                        h'4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c'
                     )
                  ]
               )
            )
         )
      ]
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   84                                    # array(4)
      d8 30                              # tag(48)   ; crypto-msg
         84                              # array(4)
            47                           # bytes(7)
               b70caef69558aa
            4c                           # bytes(12)
               4d785658f36c22fb5aed3ac0
            50                           # bytes(16)
               97de1ed627e2d2de9d3bc85209d350d7
            5824                         # bytes(36)
               d8385820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
      82                                 # array(2)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3b                     # tag(59)   ; predicate
                  03                     # unsigned(3)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3d                     # tag(61)   ; signature
                  5840                   # bytes(64)
                     77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
      82                                 # array(2)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3b                     # tag(59)   ; predicate
                  05                     # unsigned(5)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 37                     # tag(55)   ; crypto-sealed
                  82                     # array(2)
                     d8 30               # tag(48)   ; crypto-msg
                        83               # array(3)
                           5824          # bytes(36)
                              461cee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca2
                           4c            # bytes(12)
                              4d785658f36c22fb5aed3ac0
                           50            # bytes(16)
                              8577f466d1dba592cc4ff82adc596de2
                     d8 3e               # tag(62)   ; agreement-public-key
                        5820             # bytes(32)
                           4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
      82                                 # array(2)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3b                     # tag(59)   ; predicate
                  05                     # unsigned(5)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 37                     # tag(55)   ; crypto-sealed
                  82                     # array(2)
                     d8 30               # tag(48)   ; crypto-msg
                        83               # array(3)
                           5824          # bytes(36)
                              72450f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af34
                           4c            # bytes(12)
                              4d785658f36c22fb5aed3ac0
                           50            # bytes(16)
                              7049dce1fb4f035c33de0bbe7ee3e444
                     d8 3e               # tag(62)   ; agreement-public-key
                        5820             # bytes(32)
                           4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
```

---

## TEST VECTOR 9: Verifiable Credential

John Smith is issued a Permanent Resident Card signed by the State of Example

### Payload in Envelope Notation

```
{
    SCID(174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8) [
        "dateIssued": 2022-04-27
        holder: SCID(78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc) [
            "birthCountry": "bs" [
                note: "The Bahamas"
            ]
            "birthDate": 1974-02-18
            "familyName": "SMITH"
            "givenName": "JOHN"
            "image": Digest(36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999) [
                dereferenceVia: "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                note: "This is an image of John Smith."
            ]
            "lprCategory": "C09"
            "lprNumber": "999-999-999"
            "residentSince": 2018-01-07
            "sex": "MALE"
            isA: "Permanent Resident"
            isA: "Person"
        ]
        isA: "credential"
        issuer: SCID(04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8) [
            dereferenceVia: URI(https://exampleledger.com/scid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8)
            note: "Issued by the State of Example"
        ]
        note: "The State of Example recognizes JOHN SMITH as a Permanent Resident."
    ]
} [
    verifiedBy: Signature [
        note: "Made by the State of Example."
    ]
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lftpehlntpfntpfthdcxchfdfwwdsrzofytsyndsvetsndkbbelbtdmuskhfdtyntbcprocktyatktaxaosplftpehtpfnimiehsjyihgajkjkkpihietpehtpfnsecyidisltlalftpehtpfntpfraatpehtpfnksfxghisihcxgujyhsjyihcxjliycxfekshsjnjojzihcxjpihiajliojtinknihjkcxgegwfdglcxgugtgaghfdcxhsjkcxhscxgdihjpjnhsjtihjtjycxgmihjkinieihjtjydmlftpehtpfntpfrbttpehlstpfntpfthdcxaaenfsheytmseorfbsbzktrdrdfybkwntkeegetaveghzstattdertbswsihahvslftpehtpfntpfrastpehtpfntpcxksheisjyjyjojkftdldlihkshsjnjojzihjzihieioihjpdmiajljndljkiainiedldyeeeoeneoieeciyiyesesemeoeoidiadyiyehecememidhsidhseeeedyhsiyehiaiyeoeeeehsieesiheeeceeiyhsieesieeheyetiadydyiyihiyenecdyecihetlftpehtpfntpfraatpehtpfnksckgajkjkkpihiecxidkkcxjyisihcxgujyhsjyihcxjliycxfekshsjnjojzihlftpehtpfntpfraotpehtpfnimiajpihieihjtjyinhsjzlftpehtpfntpfrbatpehlktpfntpfthdcxksrfdyaeflkootmhhpsfrhronbeytkjpdwwdwtrkzocygawdwfcshepyhdaysguolftpehtpfntpfraotpehtpfniygdihjpjkjljtlftpehtpfnjnjpihjkinieihjtjyguinjtiaihtpehtpfnsecyhtgyiaaelftpehtpfninioinkoihjtglhsjnihtpehtpfniegegwfdgllftpehtpfnjzidinjpjyisfxjlkpjtjyjpkktpehlftpfnididjklftpehtpfntpfraatpehtpfnjeghisihcxfwhsishsjnhsjklftpehtpfninjzjojpglkpjnidihjptpehtpfnjeesesesdpesesesdpeseseslftpehtpfniajkihkstpehtpfniegtfpgsfelftpehtpfninidinjpjyisfyhsjyihtpehtpfnsecyatskiolalftpehtpfnihinjnhsioihtpehlstpfntpethdcxenrndyjpjewsrphhoyfrbwimvontlalyynflmosajodkbzwmhnpmcehfweeosonllftpehtpfntpfrastpehtpfnkshsisjyjyjojkftdldlihkshsjnjojzihjzihieioihjpdmiajljndlieinioihjkjydleoenidiheodyemeyenidihiyideneciahseheoideheoenhsiheyesieetdyetehiyeneeemeseyiaeyemdyeyeeehecihidendyhsieehiaecenihieeoeoiaeseseslftpehtpfntpfraatpehtpfnksctghisinjkcxinjkcxhsjtcxinjnhsioihcxjliycxgejlisjtcxgujninjyisdmlftpehtpfnimiyhsjninjzkkglhsjnihtpehtpfnihgugtgaghfdlftpehtpfntpfraotpehtpfnjpgdihjpjnhsjtihjtjycxgmihjkinieihjtjylftpehtpfnjejzjojpfxhsjyihiojljpkktpehtpfniafxdyeslftpehtpfntpfraxtpehlftpfntpfshdfzhevysacyrtvefhsnwesaaafdhsastplaenpmemnlfwttjeurcpbsjopfhnseehkourdeprjovohfmyfhjpqzcspslyehgdgaecghonhgwkrsdrtboxksftiofsltkkqdlftpehtpfntpfraatpehtpfnkscagthsieihcxidkkcxjyisihcxgujyhsjyihcxjliycxfekshsjnjojzihdmwsfnckgw
```

### Tagged CBOR Binary

```
d83182d83186d83cd83a5820174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c882d831d83c6a64617465497373756564d831d83cc11a6268878082d831d83cd83b04d831d83c7843546865205374617465206f66204578616d706c65207265636f676e697a6573204a4f484e20534d4954482061732061205065726d616e656e74205265736964656e742e82d831d83cd83b0dd83183d83cd83a582004363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e882d831d83cd83b09d831d83cd820785f68747470733a2f2f6578616d706c656c65646765722e636f6d2f736369642f3034333633643566663939373333626330663135373762616261343430616631636633343461643965343534666164396431323863303066656636353035653882d831d83cd83b04d831d83c781e49737375656420627920746865205374617465206f66204578616d706c6582d831d83cd83b02d831d83c6a63726564656e7469616c82d831d83cd83b0ed8318cd83cd83a582078bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc82d831d83cd83b02d831d83c66506572736f6e82d831d83c6d7265736964656e7453696e6365d831d83cc11a5a51630082d831d83c69676976656e4e616d65d831d83c644a4f484e82d831d83c6c6269727468436f756e747279d83182d83c62627382d831d83cd83b04d831d83c6b54686520426168616d617382d831d83c696c70724e756d626572d831d83c6b3939392d3939392d39393982d831d83c63736578d831d83c644d414c4582d831d83c69626972746844617465d831d83cc11a07c5678082d831d83c65696d616765d83183d83cd838582036be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c99982d831d83cd83b09d831d83c786168747470733a2f2f6578616d706c656c65646765722e636f6d2f6469676573742f3336626533303732366265666236356361313362313336616532396438303831663634373932633237303234313565623630616431633536656433336339393982d831d83cd83b04d831d83c781f5468697320697320616e20696d616765206f66204a6f686e20536d6974682e82d831d83c6a66616d696c794e616d65d831d83c65534d49544882d831d83cd83b02d831d83c725065726d616e656e74205265736964656e7482d831d83c6b6c707243617465676f7279d831d83c6343303982d831d83cd83b03d83182d83cd83d58405fe1c21ac0e43fcdedc204486109d88036ad379942d16bdf220f70b060c13176df28b270e2568f3f72b418ac813150493554a557f4bf2ad6a4783a673d8779b382d831d83cd83b04d831d83c781d4d61646520627920746865205374617465206f66204578616d706c652e
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   [
      49(   ; envelope
         [
            60(   ; plaintext
               58(   ; crypto-scid
                  h'174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8'
               )
            ),
            [
               49(   ; envelope
                  60("dateIssued")   ; plaintext
               ),
               49(   ; envelope
                  60(   ; plaintext
                     1(2022-04-27T00:00:00Z)
                  )
               )
            ],
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(4)   ; predicate
                  )
               ),
               49(   ; envelope
                  60(   ; plaintext
                     "The State of Example recognizes JOHN SMITH as a Permanent Resident."
                  )
               )
            ],
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(13)   ; predicate
                  )
               ),
               49(   ; envelope
                  [
                     60(   ; plaintext
                        58(   ; crypto-scid
                           h'04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8'
                        )
                     ),
                     [
                        49(   ; envelope
                           60(   ; plaintext
                              59(9)   ; predicate
                           )
                        ),
                        49(   ; envelope
                           60(   ; plaintext
                              32(   ; uri
                                 "https://exampleledger.com/scid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8"
                              )
                           )
                        )
                     ],
                     [
                        49(   ; envelope
                           60(   ; plaintext
                              59(4)   ; predicate
                           )
                        ),
                        49(   ; envelope
                           60(   ; plaintext
                              "Issued by the State of Example"
                           )
                        )
                     ]
                  ]
               )
            ],
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(2)   ; predicate
                  )
               ),
               49(   ; envelope
                  60("credential")   ; plaintext
               )
            ],
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(14)   ; predicate
                  )
               ),
               49(   ; envelope
                  [
                     60(   ; plaintext
                        58(   ; crypto-scid
                           h'78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc'
                        )
                     ),
                     [
                        49(   ; envelope
                           60(   ; plaintext
                              59(2)   ; predicate
                           )
                        ),
                        49(   ; envelope
                           60("Person")   ; plaintext
                        )
                     ],
                     [
                        49(   ; envelope
                           60("residentSince")   ; plaintext
                        ),
                        49(   ; envelope
                           60(   ; plaintext
                              1(2018-01-07T00:00:00Z)
                           )
                        )
                     ],
                     [
                        49(   ; envelope
                           60("givenName")   ; plaintext
                        ),
                        49(   ; envelope
                           60("JOHN")   ; plaintext
                        )
                     ],
                     [
                        49(   ; envelope
                           60("birthCountry")   ; plaintext
                        ),
                        49(   ; envelope
                           [
                              60("bs")   ; plaintext,
                              [
                                 49(   ; envelope
                                    60(   ; plaintext
                                       59(4)   ; predicate
                                    )
                                 ),
                                 49(   ; envelope
                                    60("The Bahamas")   ; plaintext
                                 )
                              ]
                           ]
                        )
                     ],
                     [
                        49(   ; envelope
                           60("lprNumber")   ; plaintext
                        ),
                        49(   ; envelope
                           60("999-999-999")   ; plaintext
                        )
                     ],
                     [
                        49(   ; envelope
                           60("sex")   ; plaintext
                        ),
                        49(   ; envelope
                           60("MALE")   ; plaintext
                        )
                     ],
                     [
                        49(   ; envelope
                           60("birthDate")   ; plaintext
                        ),
                        49(   ; envelope
                           60(   ; plaintext
                              1(1974-02-18T00:00:00Z)
                           )
                        )
                     ],
                     [
                        49(   ; envelope
                           60("image")   ; plaintext
                        ),
                        49(   ; envelope
                           [
                              60(   ; plaintext
                                 56(   ; crypto-digest
                                    h'36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999'
                                 )
                              ),
                              [
                                 49(   ; envelope
                                    60(   ; plaintext
                                       59(9)   ; predicate
                                    )
                                 ),
                                 49(   ; envelope
                                    60(   ; plaintext
                                       "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                                    )
                                 )
                              ],
                              [
                                 49(   ; envelope
                                    60(   ; plaintext
                                       59(4)   ; predicate
                                    )
                                 ),
                                 49(   ; envelope
                                    60(   ; plaintext
                                       "This is an image of John Smith."
                                    )
                                 )
                              ]
                           ]
                        )
                     ],
                     [
                        49(   ; envelope
                           60("familyName")   ; plaintext
                        ),
                        49(   ; envelope
                           60("SMITH")   ; plaintext
                        )
                     ],
                     [
                        49(   ; envelope
                           60(   ; plaintext
                              59(2)   ; predicate
                           )
                        ),
                        49(   ; envelope
                           60("Permanent Resident")   ; plaintext
                        )
                     ],
                     [
                        49(   ; envelope
                           60("lprCategory")   ; plaintext
                        ),
                        49(   ; envelope
                           60("C09")   ; plaintext
                        )
                     ]
                  ]
               )
            ]
         ]
      ),
      [
         49(   ; envelope
            60(   ; plaintext
               59(3)   ; predicate
            )
         ),
         49(   ; envelope
            [
               60(   ; plaintext
                  61(   ; signature
                     h'5fe1c21ac0e43fcdedc204486109d88036ad379942d16bdf220f70b060c13176df28b270e2568f3f72b418ac813150493554a557f4bf2ad6a4783a673d8779b3'
                  )
               ),
               [
                  49(   ; envelope
                     60(   ; plaintext
                        59(4)   ; predicate
                     )
                  ),
                  49(   ; envelope
                     60(   ; plaintext
                        "Made by the State of Example."
                     )
                  )
               ]
            ]
         )
      ]
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   82                                    # array(2)
      d8 31                              # tag(49)   ; envelope
         86                              # array(6)
            d8 3c                        # tag(60)   ; plaintext
               d8 3a                     # tag(58)   ; crypto-scid
                  5820                   # bytes(32)
                     174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     6a                  # text(10)
                        64617465497373756564 # "dateIssued"
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     c1 1a62688780       # date(2022-04-27 00:00:00 +0000)
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        04               # unsigned(4)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     78 43               # text(67)
                        546865205374617465206f66204578616d706c65207265636f676e697a6573204a4f484e20534d4954482061732061205065726d616e656e74205265736964656e742e # "The State of Example recognizes JOHN SMITH as a Permanent Resident."
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        0d               # unsigned(13)
               d8 31                     # tag(49)   ; envelope
                  83                     # array(3)
                     d8 3c               # tag(60)   ; plaintext
                        d8 3a            # tag(58)   ; crypto-scid
                           5820          # bytes(32)
                              04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              d8 3b      # tag(59)   ; predicate
                                 09      # unsigned(9)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              d8 20      # tag(32)   ; uri
                                 78 5f   # text(95)
                                    68747470733a2f2f6578616d706c656c65646765722e636f6d2f736369642f30343336336435666639393733336263306631353737626162613434306166316366333434616439653435346661643964313238633030666566363530356538 # "https://exampleledger.com/scid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8"
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              d8 3b      # tag(59)   ; predicate
                                 04      # unsigned(4)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              78 1e      # text(30)
                                 49737375656420627920746865205374617465206f66204578616d706c65 # "Issued by the State of Example"
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        02               # unsigned(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     6a                  # text(10)
                        63726564656e7469616c # "credential"
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        0e               # unsigned(14)
               d8 31                     # tag(49)   ; envelope
                  8c                     # array(12)
                     d8 3c               # tag(60)   ; plaintext
                        d8 3a            # tag(58)   ; crypto-scid
                           5820          # bytes(32)
                              78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              d8 3b      # tag(59)   ; predicate
                                 02      # unsigned(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              66         # text(6)
                                 506572736f6e # "Person"
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              6d         # text(13)
                                 7265736964656e7453696e6365 # "residentSince"
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              c1 1a5a516300 # date(2018-01-07 00:00:00 +0000)
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              69         # text(9)
                                 676976656e4e616d65 # "givenName"
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              64         # text(4)
                                 4a4f484e # "JOHN"
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              6c         # text(12)
                                 6269727468436f756e747279 # "birthCountry"
                        d8 31            # tag(49)   ; envelope
                           82            # array(2)
                              d8 3c      # tag(60)   ; plaintext
                                 62      # text(2)
                                    6273 # "bs"
                              82         # array(2)
                                 d8 31   # tag(49)   ; envelope
                                    d8 3c # tag(60)   ; plaintext
                                       d8 3b # tag(59)   ; predicate
                                          04 # unsigned(4)
                                 d8 31   # tag(49)   ; envelope
                                    d8 3c # tag(60)   ; plaintext
                                       6b # text(11)
                                          54686520426168616d6173 # "The Bahamas"
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              69         # text(9)
                                 6c70724e756d626572 # "lprNumber"
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              6b         # text(11)
                                 3939392d3939392d393939 # "999-999-999"
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              63         # text(3)
                                 736578  # "sex"
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              64         # text(4)
                                 4d414c45 # "MALE"
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              69         # text(9)
                                 626972746844617465 # "birthDate"
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              c1 1a07c56780 # date(1974-02-18 00:00:00 +0000)
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              65         # text(5)
                                 696d616765 # "image"
                        d8 31            # tag(49)   ; envelope
                           83            # array(3)
                              d8 3c      # tag(60)   ; plaintext
                                 d8 38   # tag(56)   ; crypto-digest
                                    5820 # bytes(32)
                                       36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999
                              82         # array(2)
                                 d8 31   # tag(49)   ; envelope
                                    d8 3c # tag(60)   ; plaintext
                                       d8 3b # tag(59)   ; predicate
                                          09 # unsigned(9)
                                 d8 31   # tag(49)   ; envelope
                                    d8 3c # tag(60)   ; plaintext
                                       78 61 # text(97)
                                          68747470733a2f2f6578616d706c656c65646765722e636f6d2f6469676573742f33366265333037323662656662363563613133623133366165323964383038316636343739326332373032343135656236306164316335366564333363393939 # "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                              82         # array(2)
                                 d8 31   # tag(49)   ; envelope
                                    d8 3c # tag(60)   ; plaintext
                                       d8 3b # tag(59)   ; predicate
                                          04 # unsigned(4)
                                 d8 31   # tag(49)   ; envelope
                                    d8 3c # tag(60)   ; plaintext
                                       78 1f # text(31)
                                          5468697320697320616e20696d616765206f66204a6f686e20536d6974682e # "This is an image of John Smith."
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              6a         # text(10)
                                 66616d696c794e616d65 # "familyName"
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              65         # text(5)
                                 534d495448 # "SMITH"
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              d8 3b      # tag(59)   ; predicate
                                 02      # unsigned(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              72         # text(18)
                                 5065726d616e656e74205265736964656e74 # "Permanent Resident"
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              6b         # text(11)
                                 6c707243617465676f7279 # "lprCategory"
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              63         # text(3)
                                 433039  # "C09"
      82                                 # array(2)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3b                     # tag(59)   ; predicate
                  03                     # unsigned(3)
         d8 31                           # tag(49)   ; envelope
            82                           # array(2)
               d8 3c                     # tag(60)   ; plaintext
                  d8 3d                  # tag(61)   ; signature
                     5840                # bytes(64)
                        5fe1c21ac0e43fcdedc204486109d88036ad379942d16bdf220f70b060c13176df28b270e2568f3f72b418ac813150493554a557f4bf2ad6a4783a673d8779b3
               82                        # array(2)
                  d8 31                  # tag(49)   ; envelope
                     d8 3c               # tag(60)   ; plaintext
                        d8 3b            # tag(59)   ; predicate
                           04            # unsigned(4)
                  d8 31                  # tag(49)   ; envelope
                     d8 3c               # tag(60)   ; plaintext
                        78 1d            # text(29)
                           4d61646520627920746865205374617465206f66204578616d706c652e # "Made by the State of Example."
```

---

## TEST VECTOR 10: Redacted Verifiable Credential

John wishes to identify himself to a third party using his government-issued credential, but does not wish to reveal more than his name, his photo, and the fact that the state has verified his identity. Despite redacting numerous fields, the overall digest of the redacted structure is the same, and the signature still validates.

### Payload in Envelope Notation

```
{
    SCID(174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8) [
        REDACTED
        REDACTED
        holder: SCID(78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc) [
            REDACTED
            REDACTED
            REDACTED
            REDACTED
            REDACTED
            REDACTED
            REDACTED
            REDACTED
            "familyName": "SMITH"
            "givenName": "JOHN"
            "image": Digest(36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999) [
                dereferenceVia: "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                note: "This is an image of John Smith."
            ]
        ]
        isA: "credential"
        issuer: SCID(04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8) [
            dereferenceVia: URI(https://exampleledger.com/scid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8)
            note: "Issued by the State of Example"
        ]
    ]
} [
    verifiedBy: Signature [
        note: "Made by the State of Example."
    ]
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lftpehlntpfntpfthdcxchfdfwwdsrzofytsyndsvetsndkbbelbtdmuskhfdtyntbcprocktyatktaxaosptpethdcxcskkguyaflmdtilghyzeteahqzmnlbbtoectwlutmwastytyfxwtheryemhkkeettpethdcxfzlkimswsawmkibkdrfxlnjlfrpftkfeuerehfvtsbykyasnayfseecelpcxfgtolftpehtpfntpfrbttpehlstpfntpfthdcxaaenfsheytmseorfbsbzktrdrdfybkwntkeegetaveghzstattdertbswsihahvslftpehtpfntpfrastpehtpfntpcxksheisjyjyjojkftdldlihkshsjnjojzihjzihieioihjpdmiajljndljkiainiedldyeeeoeneoieeciyiyesesemeoeoidiadyiyehecememidhsidhseeeedyhsiyehiaiyeoeeeehsieesiheeeceeiyhsieesieeheyetiadydyiyihiyenecdyecihetlftpehtpfntpfraatpehtpfnksckgajkjkkpihiecxidkkcxjyisihcxgujyhsjyihcxjliycxfekshsjnjojzihlftpehtpfntpfraotpehtpfnimiajpihieihjtjyinhsjzlftpehtpfntpfrbatpehlktpfntpfthdcxksrfdyaeflkootmhhpsfrhronbeytkjpdwwdwtrkzocygawdwfcshepyhdaysguotpethdcxaeldhpztclrtbwmtiorytiloihbwhkbtpkwtmemnpfmyiaaegeoslgtpdlnyjzprtpethdcxcfctlpnbtojlbdgrwpmhhgoeinlbwpaechbthgiywszowpghgeotgoidkbmdiontlftpehtpfninioinkoihjtglhsjnihtpehtpfniegegwfdgltpethdcxkbsnhggycngsfpiogdlrtdjsttplbwktsnfspevovsndkeotlnnlchtsnbkimhmotpethdcxlgrensuyvdskgsdktnurwnbnaeldcslbtkatdwjofmttswwfldvtcmrpaepdvepytpethdcxmypeoxotdieopaimtnpdbbnymyheykwtbeylvyoxwpurcfwmksamkscatdkghynetpethdcxnlpkgsqzuylpgysbieltetiyfhkgctadpedscwwzldrncnotcslymycavsgrcpntlftpehtpfnihinjnhsioihtpehlstpfntpethdcxenrndyjpjewsrphhoyfrbwimvontlalyynflmosajodkbzwmhnpmcehfweeosonllftpehtpfntpfrastpehtpfnkshsisjyjyjojkftdldlihkshsjnjojzihjzihieioihjpdmiajljndlieinioihjkjydleoenidiheodyemeyenidihiyideneciahseheoideheoenhsiheyesieetdyetehiyeneeemeseyiaeyemdyeyeeehecihidendyhsieehiaecenihieeoeoiaeseseslftpehtpfntpfraatpehtpfnksctghisinjkcxinjkcxhsjtcxinjnhsioihcxjliycxgejlisjtcxgujninjyisdmlftpehtpfnimiyhsjninjzkkglhsjnihtpehtpfnihgugtgaghfdtpethdcxtyzocxcmtijebtwdbsvwtlwekoclecghdtrpcmclfzctlgcapsdlcysezsehmyrntpethdcxvwgmjtftoycngesffpkofntlspmnasbdgsfmimsstbcndrztzmdetakicwcwykahlftpehtpfntpfraxtpehlftpfntpfshdfzhevysacyrtvefhsnwesaaafdhsastplaenpmemnlfwttjeurcpbsjopfhnseehkourdeprjovohfmyfhjpqzcspslyehgdgaecghonhgwkrsdrtboxksftiofsltkkqdlftpehtpfntpfraatpehtpfnkscagthsieihcxidkkcxjyisihcxgujyhsjyihcxjliycxfekshsjnjojzihdmlyiavwjz
```

### Tagged CBOR Binary

```
d83182d83186d83cd83a5820174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8d8385820187953f84795d08d5efed305b48e7f0da21fe9dd9409d4d443f05fbd37597c38d8385820408c6ac6c2eb7d0a2a43866f3bb0cf45deb556e0cbf5f8cd083d341c852046ce82d831d83cd83b0dd83183d83cd83a582004363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e882d831d83cd83b09d831d83cd820785f68747470733a2f2f6578616d706c656c65646765722e636f6d2f736369642f3034333633643566663939373333626330663135373762616261343430616631636633343461643965343534666164396431323863303066656636353035653882d831d83cd83b04d831d83c781e49737375656420627920746865205374617465206f66204578616d706c6582d831d83cd83b02d831d83c6a63726564656e7469616c82d831d83cd83b0ed8318cd83cd83a582078bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadcd838582000895bfc21c0139667bdd0886513590daaf0918eb08f63004aa78dd82f9a6cb2d8385820191f85a0ce6f0b4bec9057a2697fec00170d5766effbec544aa355627e95679d82d831d83c69676976656e4e616d65d831d83c644a4f484ed83858207ecd5751234c41675084d271d1ae1377cd3dafe2e89b7ca3869917d7a07d9092d83858208db59cdbe7c54c24dadff10c0089187fcf072c703ed1c6f389e016b600a8e4abd83858208fafa4a32733b16adaa8149a8f5ff5f010f7e1a4ecdf19eb7806781dd27b5e9fd838582099aa4cb4db8551cb648738663f7b1f01af261bf289be23a318818f1de84b229d82d831d83c65696d616765d83183d83cd838582036be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c99982d831d83cd83b09d831d83c786168747470733a2f2f6578616d706c656c65646765722e636f6d2f6469676573742f3336626533303732366265666236356361313362313336616532396438303831663634373932633237303234313565623630616431633536656433336339393982d831d83cd83b04d831d83c781f5468697320697320616e20696d616765206f66204a6f686e20536d6974682e82d831d83c6a66616d696c794e616d65d831d83c65534d495448d8385820d4fb2016d06b0dea0fe5d5ed7621355429b61621401f8d1dac2f1ac1fa318fbed8385820e5526e3aa1234acc41763cd5c88e090b4c3e6ac4d6232afcff28d97d1b1bf50582d831d83cd83b03d83182d83cd83d58405fe1c21ac0e43fcdedc204486109d88036ad379942d16bdf220f70b060c13176df28b270e2568f3f72b418ac813150493554a557f4bf2ad6a4783a673d8779b382d831d83cd83b04d831d83c781d4d61646520627920746865205374617465206f66204578616d706c652e
```

### Tagged CBOR Diagnostic Notation

```
49(   ; envelope
   [
      49(   ; envelope
         [
            60(   ; plaintext
               58(   ; crypto-scid
                  h'174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8'
               )
            ),
            56(   ; crypto-digest
               h'187953f84795d08d5efed305b48e7f0da21fe9dd9409d4d443f05fbd37597c38'
            ),
            56(   ; crypto-digest
               h'408c6ac6c2eb7d0a2a43866f3bb0cf45deb556e0cbf5f8cd083d341c852046ce'
            ),
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(13)   ; predicate
                  )
               ),
               49(   ; envelope
                  [
                     60(   ; plaintext
                        58(   ; crypto-scid
                           h'04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8'
                        )
                     ),
                     [
                        49(   ; envelope
                           60(   ; plaintext
                              59(9)   ; predicate
                           )
                        ),
                        49(   ; envelope
                           60(   ; plaintext
                              32(   ; uri
                                 "https://exampleledger.com/scid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8"
                              )
                           )
                        )
                     ],
                     [
                        49(   ; envelope
                           60(   ; plaintext
                              59(4)   ; predicate
                           )
                        ),
                        49(   ; envelope
                           60(   ; plaintext
                              "Issued by the State of Example"
                           )
                        )
                     ]
                  ]
               )
            ],
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(2)   ; predicate
                  )
               ),
               49(   ; envelope
                  60("credential")   ; plaintext
               )
            ],
            [
               49(   ; envelope
                  60(   ; plaintext
                     59(14)   ; predicate
                  )
               ),
               49(   ; envelope
                  [
                     60(   ; plaintext
                        58(   ; crypto-scid
                           h'78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc'
                        )
                     ),
                     56(   ; crypto-digest
                        h'00895bfc21c0139667bdd0886513590daaf0918eb08f63004aa78dd82f9a6cb2'
                     ),
                     56(   ; crypto-digest
                        h'191f85a0ce6f0b4bec9057a2697fec00170d5766effbec544aa355627e95679d'
                     ),
                     [
                        49(   ; envelope
                           60("givenName")   ; plaintext
                        ),
                        49(   ; envelope
                           60("JOHN")   ; plaintext
                        )
                     ],
                     56(   ; crypto-digest
                        h'7ecd5751234c41675084d271d1ae1377cd3dafe2e89b7ca3869917d7a07d9092'
                     ),
                     56(   ; crypto-digest
                        h'8db59cdbe7c54c24dadff10c0089187fcf072c703ed1c6f389e016b600a8e4ab'
                     ),
                     56(   ; crypto-digest
                        h'8fafa4a32733b16adaa8149a8f5ff5f010f7e1a4ecdf19eb7806781dd27b5e9f'
                     ),
                     56(   ; crypto-digest
                        h'99aa4cb4db8551cb648738663f7b1f01af261bf289be23a318818f1de84b229d'
                     ),
                     [
                        49(   ; envelope
                           60("image")   ; plaintext
                        ),
                        49(   ; envelope
                           [
                              60(   ; plaintext
                                 56(   ; crypto-digest
                                    h'36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999'
                                 )
                              ),
                              [
                                 49(   ; envelope
                                    60(   ; plaintext
                                       59(9)   ; predicate
                                    )
                                 ),
                                 49(   ; envelope
                                    60(   ; plaintext
                                       "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                                    )
                                 )
                              ],
                              [
                                 49(   ; envelope
                                    60(   ; plaintext
                                       59(4)   ; predicate
                                    )
                                 ),
                                 49(   ; envelope
                                    60(   ; plaintext
                                       "This is an image of John Smith."
                                    )
                                 )
                              ]
                           ]
                        )
                     ],
                     [
                        49(   ; envelope
                           60("familyName")   ; plaintext
                        ),
                        49(   ; envelope
                           60("SMITH")   ; plaintext
                        )
                     ],
                     56(   ; crypto-digest
                        h'd4fb2016d06b0dea0fe5d5ed7621355429b61621401f8d1dac2f1ac1fa318fbe'
                     ),
                     56(   ; crypto-digest
                        h'e5526e3aa1234acc41763cd5c88e090b4c3e6ac4d6232afcff28d97d1b1bf505'
                     )
                  ]
               )
            ]
         ]
      ),
      [
         49(   ; envelope
            60(   ; plaintext
               59(3)   ; predicate
            )
         ),
         49(   ; envelope
            [
               60(   ; plaintext
                  61(   ; signature
                     h'5fe1c21ac0e43fcdedc204486109d88036ad379942d16bdf220f70b060c13176df28b270e2568f3f72b418ac813150493554a557f4bf2ad6a4783a673d8779b3'
                  )
               ),
               [
                  49(   ; envelope
                     60(   ; plaintext
                        59(4)   ; predicate
                     )
                  ),
                  49(   ; envelope
                     60(   ; plaintext
                        "Made by the State of Example."
                     )
                  )
               ]
            ]
         )
      ]
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 31                                    # tag(49)   ; envelope
   82                                    # array(2)
      d8 31                              # tag(49)   ; envelope
         86                              # array(6)
            d8 3c                        # tag(60)   ; plaintext
               d8 3a                     # tag(58)   ; crypto-scid
                  5820                   # bytes(32)
                     174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8
            d8 38                        # tag(56)   ; crypto-digest
               5820                      # bytes(32)
                  187953f84795d08d5efed305b48e7f0da21fe9dd9409d4d443f05fbd37597c38
            d8 38                        # tag(56)   ; crypto-digest
               5820                      # bytes(32)
                  408c6ac6c2eb7d0a2a43866f3bb0cf45deb556e0cbf5f8cd083d341c852046ce
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        0d               # unsigned(13)
               d8 31                     # tag(49)   ; envelope
                  83                     # array(3)
                     d8 3c               # tag(60)   ; plaintext
                        d8 3a            # tag(58)   ; crypto-scid
                           5820          # bytes(32)
                              04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              d8 3b      # tag(59)   ; predicate
                                 09      # unsigned(9)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              d8 20      # tag(32)   ; uri
                                 78 5f   # text(95)
                                    68747470733a2f2f6578616d706c656c65646765722e636f6d2f736369642f30343336336435666639393733336263306631353737626162613434306166316366333434616439653435346661643964313238633030666566363530356538 # "https://exampleledger.com/scid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8"
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              d8 3b      # tag(59)   ; predicate
                                 04      # unsigned(4)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              78 1e      # text(30)
                                 49737375656420627920746865205374617465206f66204578616d706c65 # "Issued by the State of Example"
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        02               # unsigned(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     6a                  # text(10)
                        63726564656e7469616c # "credential"
            82                           # array(2)
               d8 31                     # tag(49)   ; envelope
                  d8 3c                  # tag(60)   ; plaintext
                     d8 3b               # tag(59)   ; predicate
                        0e               # unsigned(14)
               d8 31                     # tag(49)   ; envelope
                  8c                     # array(12)
                     d8 3c               # tag(60)   ; plaintext
                        d8 3a            # tag(58)   ; crypto-scid
                           5820          # bytes(32)
                              78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc
                     d8 38               # tag(56)   ; crypto-digest
                        5820             # bytes(32)
                           00895bfc21c0139667bdd0886513590daaf0918eb08f63004aa78dd82f9a6cb2
                     d8 38               # tag(56)   ; crypto-digest
                        5820             # bytes(32)
                           191f85a0ce6f0b4bec9057a2697fec00170d5766effbec544aa355627e95679d
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              69         # text(9)
                                 676976656e4e616d65 # "givenName"
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              64         # text(4)
                                 4a4f484e # "JOHN"
                     d8 38               # tag(56)   ; crypto-digest
                        5820             # bytes(32)
                           7ecd5751234c41675084d271d1ae1377cd3dafe2e89b7ca3869917d7a07d9092
                     d8 38               # tag(56)   ; crypto-digest
                        5820             # bytes(32)
                           8db59cdbe7c54c24dadff10c0089187fcf072c703ed1c6f389e016b600a8e4ab
                     d8 38               # tag(56)   ; crypto-digest
                        5820             # bytes(32)
                           8fafa4a32733b16adaa8149a8f5ff5f010f7e1a4ecdf19eb7806781dd27b5e9f
                     d8 38               # tag(56)   ; crypto-digest
                        5820             # bytes(32)
                           99aa4cb4db8551cb648738663f7b1f01af261bf289be23a318818f1de84b229d
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              65         # text(5)
                                 696d616765 # "image"
                        d8 31            # tag(49)   ; envelope
                           83            # array(3)
                              d8 3c      # tag(60)   ; plaintext
                                 d8 38   # tag(56)   ; crypto-digest
                                    5820 # bytes(32)
                                       36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999
                              82         # array(2)
                                 d8 31   # tag(49)   ; envelope
                                    d8 3c # tag(60)   ; plaintext
                                       d8 3b # tag(59)   ; predicate
                                          09 # unsigned(9)
                                 d8 31   # tag(49)   ; envelope
                                    d8 3c # tag(60)   ; plaintext
                                       78 61 # text(97)
                                          68747470733a2f2f6578616d706c656c65646765722e636f6d2f6469676573742f33366265333037323662656662363563613133623133366165323964383038316636343739326332373032343135656236306164316335366564333363393939 # "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                              82         # array(2)
                                 d8 31   # tag(49)   ; envelope
                                    d8 3c # tag(60)   ; plaintext
                                       d8 3b # tag(59)   ; predicate
                                          04 # unsigned(4)
                                 d8 31   # tag(49)   ; envelope
                                    d8 3c # tag(60)   ; plaintext
                                       78 1f # text(31)
                                          5468697320697320616e20696d616765206f66204a6f686e20536d6974682e # "This is an image of John Smith."
                     82                  # array(2)
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              6a         # text(10)
                                 66616d696c794e616d65 # "familyName"
                        d8 31            # tag(49)   ; envelope
                           d8 3c         # tag(60)   ; plaintext
                              65         # text(5)
                                 534d495448 # "SMITH"
                     d8 38               # tag(56)   ; crypto-digest
                        5820             # bytes(32)
                           d4fb2016d06b0dea0fe5d5ed7621355429b61621401f8d1dac2f1ac1fa318fbe
                     d8 38               # tag(56)   ; crypto-digest
                        5820             # bytes(32)
                           e5526e3aa1234acc41763cd5c88e090b4c3e6ac4d6232afcff28d97d1b1bf505
      82                                 # array(2)
         d8 31                           # tag(49)   ; envelope
            d8 3c                        # tag(60)   ; plaintext
               d8 3b                     # tag(59)   ; predicate
                  03                     # unsigned(3)
         d8 31                           # tag(49)   ; envelope
            82                           # array(2)
               d8 3c                     # tag(60)   ; plaintext
                  d8 3d                  # tag(61)   ; signature
                     5840                # bytes(64)
                        5fe1c21ac0e43fcdedc204486109d88036ad379942d16bdf220f70b060c13176df28b270e2568f3f72b418ac813150493554a557f4bf2ad6a4783a673d8779b3
               82                        # array(2)
                  d8 31                  # tag(49)   ; envelope
                     d8 3c               # tag(60)   ; plaintext
                        d8 3b            # tag(59)   ; predicate
                           04            # unsigned(4)
                  d8 31                  # tag(49)   ; envelope
                     d8 3c               # tag(60)   ; plaintext
                        78 1d            # text(29)
                           4d61646520627920746865205374617465206f66204578616d706c652e # "Made by the State of Example."
```

---
