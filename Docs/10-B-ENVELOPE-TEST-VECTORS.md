# Secure Components - Envelope Test Vectors

**Authors:** Wolf McNally, Christopher Allen, Blockchain Commons</br>
**Revised:** Sep 16, 2022</br>
**Status:** DRAFT

## Contents

* [Envelope Introduction](00-INTRODUCTION.md)
* [Types](01-TYPES.md)
* [Envelope Overview](02-ENVELOPE.md)
* [Envelope Notation](03-ENVELOPE-NOTATION.md)
* [Envelope Expressions](04-ENVELOPE-EXPRESSIONS.md)
* [Definitions](05-DEFINITIONS.md)
* [Examples](06-EXAMPLES.md)
* [Noncorrelation](07-NONCORRELATION.md)
* [Elision and Redaction](08-ELISION-REDACTION.md)
* [Appendix A: MVA Algorithm Suite](09-A-ALGORITHMS.md)
* Appendix B: Envelope Test Vectors: This document
* [Appendix C: Envelope SSKR Test Vectors](11-C-ENVELOPE-SSKR-TEST-VECTORS.md)

---

## Introduction

This document provides test vectors for `envelope`. It is generated by `EnvelopeTestVectors.testGenerateEnvelopeTestVectors()` in the `BCSwiftSecureComponents` test suite.

## Status

This document is a draft with a reference implementation in [BCSwiftSecureComponents](https://github.com/blockchaincommons/BCSwiftSecureComponents).

---

These test vectors use these fixed seed values, from which other key pairs are derived:

* Alice's Seed: `82f32c855d3d542256180810797e0073`
* Bob's Seed: `187a5973c64d359c836eba466a44db7b`
* Carol's Seed: `8574afab18e229651c1be8f76ffee523`

These objects are normally random, but they are fixed for these test vectors:

* Symmetric key used for encryption: `526afd95b2229c5381baec4a1788507a3c4a566ca5cce64543b46ad12aff0035`
* Nonce for encryption: `4d785658f36c22fb5aed3ac0`
* Random generator for signing returns repeating sequence: `dca8cfe8e67d03fab4177279d5498e7a`

## INDEX

1. [Hello, World!](#TEST-VECTOR-1-Hello-World)
2. [Signed Plaintext](#TEST-VECTOR-2-Signed-Plaintext)
3. [Multisigned Plaintext](#TEST-VECTOR-3-Multisigned-Plaintext)
4. [Symmetric Encryption](#TEST-VECTOR-4-Symmetric-Encryption)
5. [Sign Then Encrypt](#TEST-VECTOR-5-Sign-Then-Encrypt)
6. [Encrypt Then Sign](#TEST-VECTOR-6-Encrypt-Then-Sign)
7. [Multi-Recipient](#TEST-VECTOR-7-MultiRecipient)
8. [Visible Signature Multi-Recipient](#TEST-VECTOR-8-Visible-Signature-MultiRecipient)
9. [Verifiable Credential](#TEST-VECTOR-9-Verifiable-Credential)
10. [Redacted Verifiable Credential](#TEST-VECTOR-10-Redacted-Verifiable-Credential)

---

## TEST VECTOR 1: Hello, World!

The simplest case: encoding a plaintext string as the envelope's `subject`. The `subject` can be any CBOR-encodable structure.

### Payload in Envelope Notation

```
"Hello."
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/tpuoiyfdihjzjzjldmgsgontio
```

### Tagged CBOR Binary

```
d8c8d8dc6648656c6c6f2e
```

### Tagged CBOR Diagnostic Notation

```
200(   ; envelope
   220("Hello.")   ; leaf
)
```

### Tagged CBOR Annotated Binary

```
d8 c8                 # tag(200)   ; envelope
   d8 dc              # tag(220)   ; leaf
      66              # text(6)
         48656c6c6f2e # "Hello."
```

---

## TEST VECTOR 2: Signed Plaintext

A string has been signed by Alice.

### Payload in Envelope Notation

```
"Hello." [
    verifiedBy: Signature
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lftpsptpuoiyfdihjzjzjldmtpsptputlftpsptpuraxtpsptpuotpuehdfzktpkcpbzcsiyeyzedtencshghdguswamwlutceetttlfsshlfsdiwzptosinetpshksnzmmdgmroosylswfybegdmhpdmoesykkthsssbwgdgdurtlmhvlhftlidbkftskdwstdl
```

### Tagged CBOR Binary

```
d8c882d8c8d8dc6648656c6c6f2ed8c8d8dd82d8c8d8df03d8c8d8dcd8de584077aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

### Tagged CBOR Diagnostic Notation

```
200(   ; envelope
   [
      200(   ; envelope
         220("Hello.")   ; leaf
      ),
      200(   ; envelope
         221(   ; assertion
            [
               200(   ; envelope
                  223(3)   ; known-predicate
               ),
               200(   ; envelope
                  220(   ; leaf
                     222(   ; signature
                        h'77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a'
                     )
                  )
               )
            ]
         )
      )
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 c8                                    # tag(200)   ; envelope
   82                                    # array(2)
      d8 c8                              # tag(200)   ; envelope
         d8 dc                           # tag(220)   ; leaf
            66                           # text(6)
               48656c6c6f2e              # "Hello."
      d8 c8                              # tag(200)   ; envelope
         d8 dd                           # tag(221)   ; assertion
            82                           # array(2)
               d8 c8                     # tag(200)   ; envelope
                  d8 df                  # tag(223)   ; known-predicate
                     03                  # unsigned(3)
               d8 c8                     # tag(200)   ; envelope
                  d8 dc                  # tag(220)   ; leaf
                     d8 de               # tag(222)   ; signature
                        5840             # bytes(64)
                           77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

---

## TEST VECTOR 3: Multisigned Plaintext

Alice and Carol jointly send a signed plaintext message to Bob.

### Payload in Envelope Notation

```
"Hello." [
    verifiedBy: Signature
    verifiedBy: Signature
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lstpsptpuoiyfdihjzjzjldmtpsptputlftpsptpuraxtpsptpuotpuehdfzktpkcpbzcsiyeyzedtencshghdguswamwlutceetttlfsshlfsdiwzptosinetpshksnzmmdgmroosylswfybegdmhpdmoesykkthsssbwgdgdurtlmhvlhftlidbkfttpsptputlftpsptpuraxtpsptpuotpuehdfzceoxaemteepkgwbzeylgplplsehlurstinjtcmrthfhginuesamoktpllrwlgooyrfcpeofrhfztyljydycpmwfmoshdkgdsotamieleaamkylghsfgtvoasdijoropasrtnwmpm
```

### Tagged CBOR Binary

```
d8c883d8c8d8dc6648656c6c6f2ed8c8d8dd82d8c8d8df03d8c8d8dcd8de584077aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3ad8c8d8dd82d8c8d8df03d8c8d8dcd8de58401ca4009634aa4f15328daeaec15ddfc7696e16c0565769dec29277ae84e955a1bc22333b56fcf7743022943ea7587b26a306648a0498f754cc4de2092770b8b1
```

### Tagged CBOR Diagnostic Notation

```
200(   ; envelope
   [
      200(   ; envelope
         220("Hello.")   ; leaf
      ),
      200(   ; envelope
         221(   ; assertion
            [
               200(   ; envelope
                  223(3)   ; known-predicate
               ),
               200(   ; envelope
                  220(   ; leaf
                     222(   ; signature
                        h'77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a'
                     )
                  )
               )
            ]
         )
      ),
      200(   ; envelope
         221(   ; assertion
            [
               200(   ; envelope
                  223(3)   ; known-predicate
               ),
               200(   ; envelope
                  220(   ; leaf
                     222(   ; signature
                        h'1ca4009634aa4f15328daeaec15ddfc7696e16c0565769dec29277ae84e955a1bc22333b56fcf7743022943ea7587b26a306648a0498f754cc4de2092770b8b1'
                     )
                  )
               )
            ]
         )
      )
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 c8                                    # tag(200)   ; envelope
   83                                    # array(3)
      d8 c8                              # tag(200)   ; envelope
         d8 dc                           # tag(220)   ; leaf
            66                           # text(6)
               48656c6c6f2e              # "Hello."
      d8 c8                              # tag(200)   ; envelope
         d8 dd                           # tag(221)   ; assertion
            82                           # array(2)
               d8 c8                     # tag(200)   ; envelope
                  d8 df                  # tag(223)   ; known-predicate
                     03                  # unsigned(3)
               d8 c8                     # tag(200)   ; envelope
                  d8 dc                  # tag(220)   ; leaf
                     d8 de               # tag(222)   ; signature
                        5840             # bytes(64)
                           77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
      d8 c8                              # tag(200)   ; envelope
         d8 dd                           # tag(221)   ; assertion
            82                           # array(2)
               d8 c8                     # tag(200)   ; envelope
                  d8 df                  # tag(223)   ; known-predicate
                     03                  # unsigned(3)
               d8 c8                     # tag(200)   ; envelope
                  d8 dc                  # tag(220)   ; leaf
                     d8 de               # tag(222)   ; signature
                        5840             # bytes(64)
                           1ca4009634aa4f15328daeaec15ddfc7696e16c0565769dec29277ae84e955a1bc22333b56fcf7743022943ea7587b26a306648a0498f754cc4de2092770b8b1
```

---

## TEST VECTOR 4: Symmetric Encryption

Alice and Bob have agreed to use a symmetric key.

### Payload in Envelope Notation

```
ENCRYPTED
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/tpsolrgaasmkpmtdnshpvssocmgsgtkshfhdwfjzcpzohtweftrtgddifnrnglgdgdryjkeedthnuevtksswidhddktpsbhdcxloimbnlplsdloycftluoftcfguayrsbwghlbctcmplwteyynsawsnlbgsnhkmovwzclplsfl
```

### Tagged CBOR Binary

```
d8c8d8c984490998add29c5be8c9164c4d785658f36c22fb5aed3ac050273cbe4e5050bd73342960dee078c6625824d8cb5820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
```

### Tagged CBOR Diagnostic Notation

```
200(   ; envelope
   201(   ; crypto-msg
      [
         h'0998add29c5be8c916',
         h'4d785658f36c22fb5aed3ac0',
         h'273cbe4e5050bd73342960dee078c662',
         h'd8cb5820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5'
      ]
   )
)
```

### Tagged CBOR Annotated Binary

```
d8 c8                                    # tag(200)   ; envelope
   d8 c9                                 # tag(201)   ; crypto-msg
      84                                 # array(4)
         49                              # bytes(9)
            0998add29c5be8c916
         4c                              # bytes(12)
            4d785658f36c22fb5aed3ac0
         50                              # bytes(16)
            273cbe4e5050bd73342960dee078c662
         5824                            # bytes(36)
            d8cb5820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
```

---

## TEST VECTOR 5: Sign Then Encrypt

A message is first signed, then encrypted. Its signature can only be checked once the envelope is decrypted.

### Payload in Envelope Notation

```
ENCRYPTED
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/tpsolrhdhnasoxgafwehwshdrtjolbfwmolkehhgkpghwlynplspcpkevoynksosrthefmlsfpsfkglpeoassnjpahgtdpwfzomwstguclinrerownlgzmpebdasmtcxiafebyjzlkynenwmwlfhoxwebtprghrptdchyttddlnnbyltkgzctpcmbwynbktbenfntbjzhygsgtkshfhdwfjzcpzohtweftrtgdwljsvschlamyqzaowmqdztieztfwtptihddktpsbhdcxwlzcvwhsluchbdzssogyhprdahutfdlelotychpmmymokiaxtsfdytuorpvlfpftbkgwplfn
```

### Tagged CBOR Binary

```
d8c8d8c984586009a4494231ef58c0707f42928c31577554e9f6aec8227ce2f678a7c05f3e8341cc7b853309cd72054d2df3fb94c7532169b5b8f18dffaf0b0996206345116c8cf636ebe93fa4ed0db254b6d217f9d22f9e11877bfdd81613f60ad6363cd66c5e4c4d785658f36c22fb5aed3ac050e971e817808fb402ebb3fc64fc42d8d05824d8cb5820e9fde5618b170bfac9515bba05dd488a88d417ad8f927d03d748f9dcb6e3413a
```

### Tagged CBOR Diagnostic Notation

```
200(   ; envelope
   201(   ; crypto-msg
      [
         h'09a4494231ef58c0707f42928c31577554e9f6aec8227ce2f678a7c05f3e8341cc7b853309cd72054d2df3fb94c7532169b5b8f18dffaf0b0996206345116c8cf636ebe93fa4ed0db254b6d217f9d22f9e11877bfdd81613f60ad6363cd66c5e',
         h'4d785658f36c22fb5aed3ac0',
         h'e971e817808fb402ebb3fc64fc42d8d0',
         h'd8cb5820e9fde5618b170bfac9515bba05dd488a88d417ad8f927d03d748f9dcb6e3413a'
      ]
   )
)
```

### Tagged CBOR Annotated Binary

```
d8 c8                                    # tag(200)   ; envelope
   d8 c9                                 # tag(201)   ; crypto-msg
      84                                 # array(4)
         5860                            # bytes(96)
            09a4494231ef58c0707f42928c31577554e9f6aec8227ce2f678a7c05f3e8341cc7b853309cd72054d2df3fb94c7532169b5b8f18dffaf0b0996206345116c8cf636ebe93fa4ed0db254b6d217f9d22f9e11877bfdd81613f60ad6363cd66c5e
         4c                              # bytes(12)
            4d785658f36c22fb5aed3ac0
         50                              # bytes(16)
            e971e817808fb402ebb3fc64fc42d8d0
         5824                            # bytes(36)
            d8cb5820e9fde5618b170bfac9515bba05dd488a88d417ad8f927d03d748f9dcb6e3413a
```

---

## TEST VECTOR 6: Encrypt Then Sign

A message is first encrypted, then signed. Its signature may be checked before the envelope is decrypted.

### Payload in Envelope Notation

```
ENCRYPTED [
    verifiedBy: Signature
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lftpsptpsolrgaasmkpmtdnshpvssocmgsgtkshfhdwfjzcpzohtweftrtgddifnrnglgdgdryjkeedthnuevtksswidhddktpsbhdcxloimbnlplsdloycftluoftcfguayrsbwghlbctcmplwteyynsawsnlbgsnhkmovwtpsptputlftpsptpuraxtpsptpuotpuehdfzktpkcpbzcsiyeyzedtencshghdguswamwlutceetttlfsshlfsdiwzptosinetpshksnzmmdgmroosylswfybegdmhpdmoesykkthsssbwgdgdurtlmhvlhftlidbkftgwkspkny
```

### Tagged CBOR Binary

```
d8c882d8c8d8c984490998add29c5be8c9164c4d785658f36c22fb5aed3ac050273cbe4e5050bd73342960dee078c6625824d8cb5820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5d8c8d8dd82d8c8d8df03d8c8d8dcd8de584077aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

### Tagged CBOR Diagnostic Notation

```
200(   ; envelope
   [
      200(   ; envelope
         201(   ; crypto-msg
            [
               h'0998add29c5be8c916',
               h'4d785658f36c22fb5aed3ac0',
               h'273cbe4e5050bd73342960dee078c662',
               h'd8cb5820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5'
            ]
         )
      ),
      200(   ; envelope
         221(   ; assertion
            [
               200(   ; envelope
                  223(3)   ; known-predicate
               ),
               200(   ; envelope
                  220(   ; leaf
                     222(   ; signature
                        h'77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a'
                     )
                  )
               )
            ]
         )
      )
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 c8                                    # tag(200)   ; envelope
   82                                    # array(2)
      d8 c8                              # tag(200)   ; envelope
         d8 c9                           # tag(201)   ; crypto-msg
            84                           # array(4)
               49                        # bytes(9)
                  0998add29c5be8c916
               4c                        # bytes(12)
                  4d785658f36c22fb5aed3ac0
               50                        # bytes(16)
                  273cbe4e5050bd73342960dee078c662
               5824                      # bytes(36)
                  d8cb5820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
      d8 c8                              # tag(200)   ; envelope
         d8 dd                           # tag(221)   ; assertion
            82                           # array(2)
               d8 c8                     # tag(200)   ; envelope
                  d8 df                  # tag(223)   ; known-predicate
                     03                  # unsigned(3)
               d8 c8                     # tag(200)   ; envelope
                  d8 dc                  # tag(220)   ; leaf
                     d8 de               # tag(222)   ; signature
                        5840             # bytes(64)
                           77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
```

---

## TEST VECTOR 7: Multi-Recipient

Alice encrypts a message using the public keys of Bob and Carol so that it can only be decrypted by the private key of either Bob or Carol. Each of the `SealedMessage` encrypts just the symmetric key used to encrypt the payload.

### Payload in Envelope Notation

```
ENCRYPTED [
    hasRecipient: SealedMessage
    hasRecipient: SealedMessage
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lstpsptpsolrgaasmkpmtdnshpvssocmgsgtkshfhdwfjzcpzohtweftrtgddifnrnglgdgdryjkeedthnuevtksswidhddktpsbhdcxloimbnlplsdloycftluoftcfguayrsbwghlbctcmplwteyynsawsnlbgsnhkmovwtpsptputlftpsptpurahtpsptpuotptklftpsolshddkfgwlwybnaaurnsrlvlwekkdtiochbbdtspceoxwfcttletfwihamcsahdmhdwsldswgukeoegsgtkshfhdwfjzcpzohtweftrtgdtkostlwkbadknsjodwztflbnhldetkjktpvahdcxgsgdldnevokicpsgledwwefesnstolnnvtisfzrfrtcamkahlecpmnaxrpmsghjztpsptputlftpsptpurahtpsptpuotptklftpsolshddkjppfbsdnqdatsprsaxbytojllnkohytnnyiewdftdwntnnesqzcnrplskngshlbneminpeeegsgtkshfhdwfjzcpzohtweftrtgdmndphhdyplnsfrmwrsbgfefxmkrdplrltpvahdcxgsgdldnevokicpsgledwwefesnstolnnvtisfzrfrtcamkahlecpmnaxrpmsghjzknrtvlbw
```

### Tagged CBOR Binary

```
d8c883d8c8d8c984490998add29c5be8c9164c4d785658f36c22fb5aed3ac050273cbe4e5050bd73342960dee078c6625824d8cb5820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5d8c8d8dd82d8c8d8df05d8c8d8dcd8cf82d8c983582446e9ee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca24c4d785658f36c22fb5aed3ac050cfa7d5f40e249c702cfc470c5d28cf73d8e658204c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546cd8c8d8dd82d8c8d8df05d8c8d8dcd8cf82d8c983582472b00f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af344c4d785658f36c22fb5aed3ac0508e2d5c30ae9c3b94bf12454398baaeb7d8e658204c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
```

### Tagged CBOR Diagnostic Notation

```
200(   ; envelope
   [
      200(   ; envelope
         201(   ; crypto-msg
            [
               h'0998add29c5be8c916',
               h'4d785658f36c22fb5aed3ac0',
               h'273cbe4e5050bd73342960dee078c662',
               h'd8cb5820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5'
            ]
         )
      ),
      200(   ; envelope
         221(   ; assertion
            [
               200(   ; envelope
                  223(5)   ; known-predicate
               ),
               200(   ; envelope
                  220(   ; leaf
                     207(   ; crypto-sealed
                        [
                           201(   ; crypto-msg
                              [
                                 h'46e9ee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca2',
                                 h'4d785658f36c22fb5aed3ac0',
                                 h'cfa7d5f40e249c702cfc470c5d28cf73'
                              ]
                           ),
                           230(   ; agreement-public-key
                              h'4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c'
                           )
                        ]
                     )
                  )
               )
            ]
         )
      ),
      200(   ; envelope
         221(   ; assertion
            [
               200(   ; envelope
                  223(5)   ; known-predicate
               ),
               200(   ; envelope
                  220(   ; leaf
                     207(   ; crypto-sealed
                        [
                           201(   ; crypto-msg
                              [
                                 h'72b00f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af34',
                                 h'4d785658f36c22fb5aed3ac0',
                                 h'8e2d5c30ae9c3b94bf12454398baaeb7'
                              ]
                           ),
                           230(   ; agreement-public-key
                              h'4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c'
                           )
                        ]
                     )
                  )
               )
            ]
         )
      )
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 c8                                    # tag(200)   ; envelope
   83                                    # array(3)
      d8 c8                              # tag(200)   ; envelope
         d8 c9                           # tag(201)   ; crypto-msg
            84                           # array(4)
               49                        # bytes(9)
                  0998add29c5be8c916
               4c                        # bytes(12)
                  4d785658f36c22fb5aed3ac0
               50                        # bytes(16)
                  273cbe4e5050bd73342960dee078c662
               5824                      # bytes(36)
                  d8cb5820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
      d8 c8                              # tag(200)   ; envelope
         d8 dd                           # tag(221)   ; assertion
            82                           # array(2)
               d8 c8                     # tag(200)   ; envelope
                  d8 df                  # tag(223)   ; known-predicate
                     05                  # unsigned(5)
               d8 c8                     # tag(200)   ; envelope
                  d8 dc                  # tag(220)   ; leaf
                     d8 cf               # tag(207)   ; crypto-sealed
                        82               # array(2)
                           d8 c9         # tag(201)   ; crypto-msg
                              83         # array(3)
                                 5824    # bytes(36)
                                    46e9ee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca2
                                 4c      # bytes(12)
                                    4d785658f36c22fb5aed3ac0
                                 50      # bytes(16)
                                    cfa7d5f40e249c702cfc470c5d28cf73
                           d8 e6         # tag(230)   ; agreement-public-key
                              5820       # bytes(32)
                                 4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
      d8 c8                              # tag(200)   ; envelope
         d8 dd                           # tag(221)   ; assertion
            82                           # array(2)
               d8 c8                     # tag(200)   ; envelope
                  d8 df                  # tag(223)   ; known-predicate
                     05                  # unsigned(5)
               d8 c8                     # tag(200)   ; envelope
                  d8 dc                  # tag(220)   ; leaf
                     d8 cf               # tag(207)   ; crypto-sealed
                        82               # array(2)
                           d8 c9         # tag(201)   ; crypto-msg
                              83         # array(3)
                                 5824    # bytes(36)
                                    72b00f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af34
                                 4c      # bytes(12)
                                    4d785658f36c22fb5aed3ac0
                                 50      # bytes(16)
                                    8e2d5c30ae9c3b94bf12454398baaeb7
                           d8 e6         # tag(230)   ; agreement-public-key
                              5820       # bytes(32)
                                 4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
```

---

## TEST VECTOR 8: Visible Signature Multi-Recipient

Alice encrypts a message using the public keys of Bob and Carol so that it can only be decrypted by the private key of either Bob or Carol. Each of the `SealedMessage` encrypts just the symmetric key used to encrypt the payload. Alice then signs the envelope so her signature may be verified by anyone with her public key.

### Payload in Envelope Notation

```
ENCRYPTED [
    hasRecipient: SealedMessage
    hasRecipient: SealedMessage
    verifiedBy: Signature
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lrtpsptpsolrgraslkbwfgnelbvysgghkpaegsgtkshfhdwfjzcpzohtweftrtgdtpzeknktkgdakgcysfcwspswqddsteuehddktpsbhdcxloimbnlplsdloycftluoftcfguayrsbwghlbctcmplwteyynsawsnlbgsnhkmovwtpsptputlftpsptpuraxtpsptpuotpuehdfzktpkcpbzcsiyeyzedtencshghdguswamwlutceetttlfsshlfsdiwzptosinetpshksnzmmdgmroosylswfybegdmhpdmoesykkthsssbwgdgdurtlmhvlhftlidbkfttpsptputlftpsptpurahtpsptpuotptklftpsolshddkfgwlwybnaaurnsrlvlwekkdtiochbbdtspceoxwfcttletfwihamcsahdmhdwsldswgukeoegsgtkshfhdwfjzcpzohtweftrtgdtkostlwkbadknsjodwztflbnhldetkjktpvahdcxgsgdldnevokicpsgledwwefesnstolnnvtisfzrfrtcamkahlecpmnaxrpmsghjztpsptputlftpsptpurahtpsptpuotptklftpsolshddkjppfbsdnqdatsprsaxbytojllnkohytnnyiewdftdwntnnesqzcnrplskngshlbneminpeeegsgtkshfhdwfjzcpzohtweftrtgdmndphhdyplnsfrmwrsbgfefxmkrdplrltpvahdcxgsgdldnevokicpsgledwwefesnstolnnvtisfzrfrtcamkahlecpmnaxrpmsghjzwnlrckpe
```

### Tagged CBOR Binary

```
d8c884d8c8d8c9844b098c13469f7fe1ca5475004c4d785658f36c22fb5aed3ac050d8fe7a777b257b1acc1bc8c6b326d3de5824d8cb5820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5d8c8d8dd82d8c8d8df03d8c8d8dcd8de584077aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3ad8c8d8dd82d8c8d8df05d8c8d8dcd8cf82d8c983582446e9ee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca24c4d785658f36c22fb5aed3ac050cfa7d5f40e249c702cfc470c5d28cf73d8e658204c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546cd8c8d8dd82d8c8d8df05d8c8d8dcd8cf82d8c983582472b00f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af344c4d785658f36c22fb5aed3ac0508e2d5c30ae9c3b94bf12454398baaeb7d8e658204c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
```

### Tagged CBOR Diagnostic Notation

```
200(   ; envelope
   [
      200(   ; envelope
         201(   ; crypto-msg
            [
               h'098c13469f7fe1ca547500',
               h'4d785658f36c22fb5aed3ac0',
               h'd8fe7a777b257b1acc1bc8c6b326d3de',
               h'd8cb5820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5'
            ]
         )
      ),
      200(   ; envelope
         221(   ; assertion
            [
               200(   ; envelope
                  223(3)   ; known-predicate
               ),
               200(   ; envelope
                  220(   ; leaf
                     222(   ; signature
                        h'77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a'
                     )
                  )
               )
            ]
         )
      ),
      200(   ; envelope
         221(   ; assertion
            [
               200(   ; envelope
                  223(5)   ; known-predicate
               ),
               200(   ; envelope
                  220(   ; leaf
                     207(   ; crypto-sealed
                        [
                           201(   ; crypto-msg
                              [
                                 h'46e9ee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca2',
                                 h'4d785658f36c22fb5aed3ac0',
                                 h'cfa7d5f40e249c702cfc470c5d28cf73'
                              ]
                           ),
                           230(   ; agreement-public-key
                              h'4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c'
                           )
                        ]
                     )
                  )
               )
            ]
         )
      ),
      200(   ; envelope
         221(   ; assertion
            [
               200(   ; envelope
                  223(5)   ; known-predicate
               ),
               200(   ; envelope
                  220(   ; leaf
                     207(   ; crypto-sealed
                        [
                           201(   ; crypto-msg
                              [
                                 h'72b00f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af34',
                                 h'4d785658f36c22fb5aed3ac0',
                                 h'8e2d5c30ae9c3b94bf12454398baaeb7'
                              ]
                           ),
                           230(   ; agreement-public-key
                              h'4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c'
                           )
                        ]
                     )
                  )
               )
            ]
         )
      )
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 c8                                    # tag(200)   ; envelope
   84                                    # array(4)
      d8 c8                              # tag(200)   ; envelope
         d8 c9                           # tag(201)   ; crypto-msg
            84                           # array(4)
               4b                        # bytes(11)
                  098c13469f7fe1ca547500
               4c                        # bytes(12)
                  4d785658f36c22fb5aed3ac0
               50                        # bytes(16)
                  d8fe7a777b257b1acc1bc8c6b326d3de
               5824                      # bytes(36)
                  d8cb5820886a0c85832fa119d5dc3a195308bf13547f1f16aef032f6c2ef9912cd5992e5
      d8 c8                              # tag(200)   ; envelope
         d8 dd                           # tag(221)   ; assertion
            82                           # array(2)
               d8 c8                     # tag(200)   ; envelope
                  d8 df                  # tag(223)   ; known-predicate
                     03                  # unsigned(3)
               d8 c8                     # tag(200)   ; envelope
                  d8 dc                  # tag(220)   ; leaf
                     d8 de               # tag(222)   ; signature
                        5840             # bytes(64)
                           77aa2215186632fe293618575853c606e9dd1c38d182c45d3d27f2a9a76938ac59cdff9552b8a7f7c644105090a89239f57761c4135050dfd590e356d5620a3a
      d8 c8                              # tag(200)   ; envelope
         d8 dd                           # tag(221)   ; assertion
            82                           # array(2)
               d8 c8                     # tag(200)   ; envelope
                  d8 df                  # tag(223)   ; known-predicate
                     05                  # unsigned(5)
               d8 c8                     # tag(200)   ; envelope
                  d8 dc                  # tag(220)   ; leaf
                     d8 cf               # tag(207)   ; crypto-sealed
                        82               # array(2)
                           d8 c9         # tag(201)   ; crypto-msg
                              83         # array(3)
                                 5824    # bytes(36)
                                    46e9ee0c04df9cb7e3ed792967171429c81ca4f31fd53842650618052e58ef89c6537ca2
                                 4c      # bytes(12)
                                    4d785658f36c22fb5aed3ac0
                                 50      # bytes(16)
                                    cfa7d5f40e249c702cfc470c5d28cf73
                           d8 e6         # tag(230)   ; agreement-public-key
                              5820       # bytes(32)
                                 4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
      d8 c8                              # tag(200)   ; envelope
         d8 dd                           # tag(221)   ; assertion
            82                           # array(2)
               d8 c8                     # tag(200)   ; envelope
                  d8 df                  # tag(223)   ; known-predicate
                     05                  # unsigned(5)
               d8 c8                     # tag(200)   ; envelope
                  d8 dc                  # tag(220)   ; leaf
                     d8 cf               # tag(207)   ; crypto-sealed
                        82               # array(2)
                           d8 c9         # tag(201)   ; crypto-msg
                              83         # array(3)
                                 5824    # bytes(36)
                                    72b00f2bb307c8bf0311ce6f86765eda9a64ea3a2c9d9e39b423b6837a4c5d0c3769af34
                                 4c      # bytes(12)
                                    4d785658f36c22fb5aed3ac0
                                 50      # bytes(16)
                                    8e2d5c30ae9c3b94bf12454398baaeb7
                           d8 e6         # tag(230)   ; agreement-public-key
                              5820       # bytes(32)
                                 4c50899fe27d22ca8a2ced45cdc7a69ee06840bcc01d98058a228e03b697546c
```

---

## TEST VECTOR 9: Verifiable Credential

John Smith is issued a Permanent Resident Card signed by the State of Example

### Payload in Envelope Notation

```
{
    CID(174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8) [
        "dateIssued": 2022-04-27
        holder: CID(78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc) [
            "birthCountry": "bs" [
                note: "The Bahamas"
            ]
            "birthDate": 1974-02-18
            "familyName": "SMITH"
            "givenName": "JOHN"
            "image": Digest(36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999) [
                dereferenceVia: "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                note: "This is an image of John Smith."
            ]
            "lprCategory": "C09"
            "lprNumber": "999-999-999"
            "residentSince": 2018-01-07
            "sex": "MALE"
            isA: "Permanent Resident"
            isA: "Person"
        ]
        isA: "credential"
        issuer: CID(04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8) [
            dereferenceVia: URI(https://exampleledger.com/cid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8)
            note: "Issued by the State of Example"
        ]
        note: "The State of Example recognizes JOHN SMITH as a Permanent Resident."
    ]
} [
    verifiedBy: Signature [
        note: "Made by the State of Example."
    ]
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lftpsptpvtlntpsptpuotpsghdcxchfdfwwdsrzofytsyndsvetsndkbbelbtdmuskhfdtyntbcprocktyatktaxaosptpsptputlftpsptpuraatpsptpuoksfxghisihcxgujyhsjyihcxjliycxfekshsjnjojzihcxjpihiajliojtinknihjkcxgegwfdglcxgugtgaghfdcxhsjkcxhscxgdihjpjnhsjtihjtjycxgmihjkinieihjtjydmtpsptputlftpsptpurbatpsplktpsptpuotpsghdcxksrfdyaeflkootmhhpsfrhronbeytkjpdwwdwtrkzocygawdwfcshepyhdaysguotpsptputlftpsptpuojzidinjpjyisfxjlkpjtjyjpkktpsplftpsptpuoididjktpsptputlftpsptpuraatpsptpuojeghisihcxfwhsishsjnhsjktpsptputlftpsptpuoinjzjojpglkpjnidihjptpsptpuojeesesesdpesesesdpesesestpsptputlftpsptpuraotpsptpuoiygdihjpjkjljttpsptputlftpsptpuoimiyhsjninjzkkglhsjnihtpsptpuoihgugtgaghfdtpsptputlftpsptpuojnjpihjkinieihjtjyguinjtiaihtpsptpuosecyhtgyiaaetpsptputlftpsptpuraotpsptpuojpgdihjpjnhsjtihjtjycxgmihjkinieihjtjytpsptputlftpsptpuojejzjojpfxhsjyihiojljpkktpsptpuoiafxdyestpsptputlftpsptpuoinioinkoihjtglhsjnihtpsptpuoiegegwfdgltpsptputlftpsptpuoinidinjpjyisfyhsjyihtpsptpuosecyatskiolatpsptputlftpsptpuoiajkihkstpsptpuoiegtfpgsfetpsptputlftpsptpuoihinjnhsioihtpsplstpsptpuotpsbhdcxenrndyjpjewsrphhoyfrbwimvontlalyynflmosajodkbzwmhnpmcehfweeosonltpsptputlftpsptpuraatpsptpuoksctghisinjkcxinjkcxhsjtcxinjnhsioihcxjliycxgejlisjtcxgujninjyisdmtpsptputlftpsptpurastpsptpuokshsisjyjyjojkftdldlihkshsjnjojzihjzihieioihjpdmiajljndlieinioihjkjydleoenidiheodyemeyenidihiyideneciahseheoideheoenhsiheyesieetdyetehiyeneeemeseyiaeyemdyeyeeehecihidendyhsieehiaecenihieeoeoiaesesestpsptputlftpsptpuoimiehsjyihgajkjkkpihietpsptpuosecyidisltlatpsptputlftpsptpuraotpsptpuoimiajpihieihjtjyinhsjztpsptputlftpsptpurbttpsplstpsptpuotpsghdcxaaenfsheytmseorfbsbzktrdrdfybkwntkeegetaveghzstattdertbswsihahvstpsptputlftpsptpurastpsptpuotpcxkshyisjyjyjojkftdldlihkshsjnjojzihjzihieioihjpdmiajljndliainiedldyeeeoeneoieeciyiyesesemeoeoidiadyiyehecememidhsidhseeeedyhsiyehiaiyeoeeeehsieesiheeeceeiyhsieesieeheyetiadydyiyihiyenecdyecihettpsptputlftpsptpuraatpsptpuoksckgajkjkkpihiecxidkkcxjyisihcxgujyhsjyihcxjliycxfekshsjnjojzihtpsptputlftpsptpuraxtpsplftpsptpuotpuehdfzhflrfwlrsgghimwmjyvsolsoglqzbwwtnsahdirptlhhkozohfkgcpfzkpstjyadhsswzmlscndlfsbnvdfnuordttjywzwkrtadneoslksnlemkrfswvdaywpehtsvdtpsptputlftpsptpuraatpsptpuokscagthsieihcxidkkcxjyisihcxgujyhsjyihcxjliycxfekshsjnjojzihdmcybyswsb
```

### Tagged CBOR Binary

```
d8c882d8c8d8e086d8c8d8dcd8ca5820174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8d8c8d8dd82d8c8d8df04d8c8d8dc7843546865205374617465206f66204578616d706c65207265636f676e697a6573204a4f484e20534d4954482061732061205065726d616e656e74205265736964656e742ed8c8d8dd82d8c8d8df0ed8c88cd8c8d8dcd8ca582078bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadcd8c8d8dd82d8c8d8dc6c6269727468436f756e747279d8c882d8c8d8dc626273d8c8d8dd82d8c8d8df04d8c8d8dc6b54686520426168616d6173d8c8d8dd82d8c8d8dc696c70724e756d626572d8c8d8dc6b3939392d3939392d393939d8c8d8dd82d8c8d8df02d8c8d8dc66506572736f6ed8c8d8dd82d8c8d8dc6a66616d696c794e616d65d8c8d8dc65534d495448d8c8d8dd82d8c8d8dc6d7265736964656e7453696e6365d8c8d8dcc11a5a516300d8c8d8dd82d8c8d8df02d8c8d8dc725065726d616e656e74205265736964656e74d8c8d8dd82d8c8d8dc6b6c707243617465676f7279d8c8d8dc63433039d8c8d8dd82d8c8d8dc69676976656e4e616d65d8c8d8dc644a4f484ed8c8d8dd82d8c8d8dc69626972746844617465d8c8d8dcc11a07c56780d8c8d8dd82d8c8d8dc63736578d8c8d8dc644d414c45d8c8d8dd82d8c8d8dc65696d616765d8c883d8c8d8dcd8cb582036be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999d8c8d8dd82d8c8d8df04d8c8d8dc781f5468697320697320616e20696d616765206f66204a6f686e20536d6974682ed8c8d8dd82d8c8d8df09d8c8d8dc786168747470733a2f2f6578616d706c656c65646765722e636f6d2f6469676573742f33366265333037323662656662363563613133623133366165323964383038316636343739326332373032343135656236306164316335366564333363393939d8c8d8dd82d8c8d8dc6a64617465497373756564d8c8d8dcc11a62688780d8c8d8dd82d8c8d8df02d8c8d8dc6a63726564656e7469616cd8c8d8dd82d8c8d8df0dd8c883d8c8d8dcd8ca582004363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8d8c8d8dd82d8c8d8df09d8c8d8dcd820785e68747470733a2f2f6578616d706c656c65646765722e636f6d2f6369642f30343336336435666639393733336263306631353737626162613434306166316366333434616439653435346661643964313238633030666566363530356538d8c8d8dd82d8c8d8df04d8c8d8dc781e49737375656420627920746865205374617465206f66204578616d706c65d8c8d8dd82d8c8d8df03d8c882d8c8d8dcd8de584056844284ca546aeb74e8a6c94eb413f09c0527b6d55c76fb567b224075c7740161c6ff83232f3d0ce73cdcbad174f2f4c0019fa78ccd8a98bcc6e708ec31d7e7d8c8d8dd82d8c8d8df04d8c8d8dc781d4d61646520627920746865205374617465206f66204578616d706c652e
```

### Tagged CBOR Diagnostic Notation

```
200(   ; envelope
   [
      200(   ; envelope
         224(   ; wrapped-envelope
            [
               200(   ; envelope
                  220(   ; leaf
                     202(   ; crypto-cid
                        h'174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8'
                     )
                  )
               ),
               200(   ; envelope
                  221(   ; assertion
                     [
                        200(   ; envelope
                           223(4)   ; known-predicate
                        ),
                        200(   ; envelope
                           220(   ; leaf
                              "The State of Example recognizes JOHN SMITH as a Permanent Resident."
                           )
                        )
                     ]
                  )
               ),
               200(   ; envelope
                  221(   ; assertion
                     [
                        200(   ; envelope
                           223(14)   ; known-predicate
                        ),
                        200(   ; envelope
                           [
                              200(   ; envelope
                                 220(   ; leaf
                                    202(   ; crypto-cid
                                       h'78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc'
                                    )
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          220("birthCountry")   ; leaf
                                       ),
                                       200(   ; envelope
                                          [
                                             200(   ; envelope
                                                220("bs")   ; leaf
                                             ),
                                             200(   ; envelope
                                                221(   ; assertion
                                                   [
                                                      200(   ; envelope
                                                         223(4)   ; known-predicate
                                                      ),
                                                      200(   ; envelope
                                                         220("The Bahamas")   ; leaf
                                                      )
                                                   ]
                                                )
                                             )
                                          ]
                                       )
                                    ]
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          220("lprNumber")   ; leaf
                                       ),
                                       200(   ; envelope
                                          220("999-999-999")   ; leaf
                                       )
                                    ]
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          223(2)   ; known-predicate
                                       ),
                                       200(   ; envelope
                                          220("Person")   ; leaf
                                       )
                                    ]
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          220("familyName")   ; leaf
                                       ),
                                       200(   ; envelope
                                          220("SMITH")   ; leaf
                                       )
                                    ]
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          220("residentSince")   ; leaf
                                       ),
                                       200(   ; envelope
                                          220(   ; leaf
                                             1(2018-01-07T00:00:00Z)
                                          )
                                       )
                                    ]
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          223(2)   ; known-predicate
                                       ),
                                       200(   ; envelope
                                          220("Permanent Resident")   ; leaf
                                       )
                                    ]
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          220("lprCategory")   ; leaf
                                       ),
                                       200(   ; envelope
                                          220("C09")   ; leaf
                                       )
                                    ]
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          220("givenName")   ; leaf
                                       ),
                                       200(   ; envelope
                                          220("JOHN")   ; leaf
                                       )
                                    ]
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          220("birthDate")   ; leaf
                                       ),
                                       200(   ; envelope
                                          220(   ; leaf
                                             1(1974-02-18T00:00:00Z)
                                          )
                                       )
                                    ]
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          220("sex")   ; leaf
                                       ),
                                       200(   ; envelope
                                          220("MALE")   ; leaf
                                       )
                                    ]
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          220("image")   ; leaf
                                       ),
                                       200(   ; envelope
                                          [
                                             200(   ; envelope
                                                220(   ; leaf
                                                   203(   ; crypto-digest
                                                      h'36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999'
                                                   )
                                                )
                                             ),
                                             200(   ; envelope
                                                221(   ; assertion
                                                   [
                                                      200(   ; envelope
                                                         223(4)   ; known-predicate
                                                      ),
                                                      200(   ; envelope
                                                         220(   ; leaf
                                                            "This is an image of John Smith."
                                                         )
                                                      )
                                                   ]
                                                )
                                             ),
                                             200(   ; envelope
                                                221(   ; assertion
                                                   [
                                                      200(   ; envelope
                                                         223(9)   ; known-predicate
                                                      ),
                                                      200(   ; envelope
                                                         220(   ; leaf
                                                            "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                                                         )
                                                      )
                                                   ]
                                                )
                                             )
                                          ]
                                       )
                                    ]
                                 )
                              )
                           ]
                        )
                     ]
                  )
               ),
               200(   ; envelope
                  221(   ; assertion
                     [
                        200(   ; envelope
                           220("dateIssued")   ; leaf
                        ),
                        200(   ; envelope
                           220(   ; leaf
                              1(2022-04-27T00:00:00Z)
                           )
                        )
                     ]
                  )
               ),
               200(   ; envelope
                  221(   ; assertion
                     [
                        200(   ; envelope
                           223(2)   ; known-predicate
                        ),
                        200(   ; envelope
                           220("credential")   ; leaf
                        )
                     ]
                  )
               ),
               200(   ; envelope
                  221(   ; assertion
                     [
                        200(   ; envelope
                           223(13)   ; known-predicate
                        ),
                        200(   ; envelope
                           [
                              200(   ; envelope
                                 220(   ; leaf
                                    202(   ; crypto-cid
                                       h'04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8'
                                    )
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          223(9)   ; known-predicate
                                       ),
                                       200(   ; envelope
                                          220(   ; leaf
                                             32(   ; uri
                                                "https://exampleledger.com/cid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8"
                                             )
                                          )
                                       )
                                    ]
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          223(4)   ; known-predicate
                                       ),
                                       200(   ; envelope
                                          220(   ; leaf
                                             "Issued by the State of Example"
                                          )
                                       )
                                    ]
                                 )
                              )
                           ]
                        )
                     ]
                  )
               )
            ]
         )
      ),
      200(   ; envelope
         221(   ; assertion
            [
               200(   ; envelope
                  223(3)   ; known-predicate
               ),
               200(   ; envelope
                  [
                     200(   ; envelope
                        220(   ; leaf
                           222(   ; signature
                              h'56844284ca546aeb74e8a6c94eb413f09c0527b6d55c76fb567b224075c7740161c6ff83232f3d0ce73cdcbad174f2f4c0019fa78ccd8a98bcc6e708ec31d7e7'
                           )
                        )
                     ),
                     200(   ; envelope
                        221(   ; assertion
                           [
                              200(   ; envelope
                                 223(4)   ; known-predicate
                              ),
                              200(   ; envelope
                                 220(   ; leaf
                                    "Made by the State of Example."
                                 )
                              )
                           ]
                        )
                     )
                  ]
               )
            ]
         )
      )
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 c8                                    # tag(200)   ; envelope
   82                                    # array(2)
      d8 c8                              # tag(200)   ; envelope
         d8 e0                           # tag(224)   ; wrapped-envelope
            86                           # array(6)
               d8 c8                     # tag(200)   ; envelope
                  d8 dc                  # tag(220)   ; leaf
                     d8 ca               # tag(202)   ; crypto-cid
                        5820             # bytes(32)
                           174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8
               d8 c8                     # tag(200)   ; envelope
                  d8 dd                  # tag(221)   ; assertion
                     82                  # array(2)
                        d8 c8            # tag(200)   ; envelope
                           d8 df         # tag(223)   ; known-predicate
                              04         # unsigned(4)
                        d8 c8            # tag(200)   ; envelope
                           d8 dc         # tag(220)   ; leaf
                              78 43      # text(67)
                                 546865205374617465206f66204578616d706c65207265636f676e697a6573204a4f484e20534d4954482061732061205065726d616e656e74205265736964656e742e # "The State of Example recognizes JOHN SMITH as a Permanent Resident."
               d8 c8                     # tag(200)   ; envelope
                  d8 dd                  # tag(221)   ; assertion
                     82                  # array(2)
                        d8 c8            # tag(200)   ; envelope
                           d8 df         # tag(223)   ; known-predicate
                              0e         # unsigned(14)
                        d8 c8            # tag(200)   ; envelope
                           8c            # array(12)
                              d8 c8      # tag(200)   ; envelope
                                 d8 dc   # tag(220)   ; leaf
                                    d8 ca # tag(202)   ; crypto-cid
                                       5820 # bytes(32)
                                          78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             6c # text(12)
                                                6269727468436f756e747279 # "birthCountry"
                                       d8 c8 # tag(200)   ; envelope
                                          82 # array(2)
                                             d8 c8 # tag(200)   ; envelope
                                                d8 dc # tag(220)   ; leaf
                                                   62 # text(2)
                                                      6273 # "bs"
                                             d8 c8 # tag(200)   ; envelope
                                                d8 dd # tag(221)   ; assertion
                                                   82 # array(2)
                                                      d8 c8 # tag(200)   ; envelope
                                                         d8 df # tag(223)   ; known-predicate
                                                            04 # unsigned(4)
                                                      d8 c8 # tag(200)   ; envelope
                                                         d8 dc # tag(220)   ; leaf
                                                            6b # text(11)
                                                               54686520426168616d6173 # "The Bahamas"
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             69 # text(9)
                                                6c70724e756d626572 # "lprNumber"
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             6b # text(11)
                                                3939392d3939392d393939 # "999-999-999"
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 df # tag(223)   ; known-predicate
                                             02 # unsigned(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             66 # text(6)
                                                506572736f6e # "Person"
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             6a # text(10)
                                                66616d696c794e616d65 # "familyName"
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             65 # text(5)
                                                534d495448 # "SMITH"
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             6d # text(13)
                                                7265736964656e7453696e6365 # "residentSince"
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             c1 1a5a516300 # date(2018-01-07 00:00:00 +0000)
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 df # tag(223)   ; known-predicate
                                             02 # unsigned(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             72 # text(18)
                                                5065726d616e656e74205265736964656e74 # "Permanent Resident"
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             6b # text(11)
                                                6c707243617465676f7279 # "lprCategory"
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             63 # text(3)
                                                433039 # "C09"
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             69 # text(9)
                                                676976656e4e616d65 # "givenName"
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             64 # text(4)
                                                4a4f484e # "JOHN"
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             69 # text(9)
                                                626972746844617465 # "birthDate"
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             c1 1a07c56780 # date(1974-02-18 00:00:00 +0000)
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             63 # text(3)
                                                736578 # "sex"
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             64 # text(4)
                                                4d414c45 # "MALE"
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             65 # text(5)
                                                696d616765 # "image"
                                       d8 c8 # tag(200)   ; envelope
                                          83 # array(3)
                                             d8 c8 # tag(200)   ; envelope
                                                d8 dc # tag(220)   ; leaf
                                                   d8 cb # tag(203)   ; crypto-digest
                                                      5820 # bytes(32)
                                                         36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999
                                             d8 c8 # tag(200)   ; envelope
                                                d8 dd # tag(221)   ; assertion
                                                   82 # array(2)
                                                      d8 c8 # tag(200)   ; envelope
                                                         d8 df # tag(223)   ; known-predicate
                                                            04 # unsigned(4)
                                                      d8 c8 # tag(200)   ; envelope
                                                         d8 dc # tag(220)   ; leaf
                                                            78 1f # text(31)
                                                               5468697320697320616e20696d616765206f66204a6f686e20536d6974682e # "This is an image of John Smith."
                                             d8 c8 # tag(200)   ; envelope
                                                d8 dd # tag(221)   ; assertion
                                                   82 # array(2)
                                                      d8 c8 # tag(200)   ; envelope
                                                         d8 df # tag(223)   ; known-predicate
                                                            09 # unsigned(9)
                                                      d8 c8 # tag(200)   ; envelope
                                                         d8 dc # tag(220)   ; leaf
                                                            78 61 # text(97)
                                                               68747470733a2f2f6578616d706c656c65646765722e636f6d2f6469676573742f33366265333037323662656662363563613133623133366165323964383038316636343739326332373032343135656236306164316335366564333363393939 # "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
               d8 c8                     # tag(200)   ; envelope
                  d8 dd                  # tag(221)   ; assertion
                     82                  # array(2)
                        d8 c8            # tag(200)   ; envelope
                           d8 dc         # tag(220)   ; leaf
                              6a         # text(10)
                                 64617465497373756564 # "dateIssued"
                        d8 c8            # tag(200)   ; envelope
                           d8 dc         # tag(220)   ; leaf
                              c1 1a62688780 # date(2022-04-27 00:00:00 +0000)
               d8 c8                     # tag(200)   ; envelope
                  d8 dd                  # tag(221)   ; assertion
                     82                  # array(2)
                        d8 c8            # tag(200)   ; envelope
                           d8 df         # tag(223)   ; known-predicate
                              02         # unsigned(2)
                        d8 c8            # tag(200)   ; envelope
                           d8 dc         # tag(220)   ; leaf
                              6a         # text(10)
                                 63726564656e7469616c # "credential"
               d8 c8                     # tag(200)   ; envelope
                  d8 dd                  # tag(221)   ; assertion
                     82                  # array(2)
                        d8 c8            # tag(200)   ; envelope
                           d8 df         # tag(223)   ; known-predicate
                              0d         # unsigned(13)
                        d8 c8            # tag(200)   ; envelope
                           83            # array(3)
                              d8 c8      # tag(200)   ; envelope
                                 d8 dc   # tag(220)   ; leaf
                                    d8 ca # tag(202)   ; crypto-cid
                                       5820 # bytes(32)
                                          04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 df # tag(223)   ; known-predicate
                                             09 # unsigned(9)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             d8 20 # tag(32)   ; uri
                                                78 5e # text(94)
                                                   68747470733a2f2f6578616d706c656c65646765722e636f6d2f6369642f30343336336435666639393733336263306631353737626162613434306166316366333434616439653435346661643964313238633030666566363530356538 # "https://exampleledger.com/cid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8"
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 df # tag(223)   ; known-predicate
                                             04 # unsigned(4)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             78 1e # text(30)
                                                49737375656420627920746865205374617465206f66204578616d706c65 # "Issued by the State of Example"
      d8 c8                              # tag(200)   ; envelope
         d8 dd                           # tag(221)   ; assertion
            82                           # array(2)
               d8 c8                     # tag(200)   ; envelope
                  d8 df                  # tag(223)   ; known-predicate
                     03                  # unsigned(3)
               d8 c8                     # tag(200)   ; envelope
                  82                     # array(2)
                     d8 c8               # tag(200)   ; envelope
                        d8 dc            # tag(220)   ; leaf
                           d8 de         # tag(222)   ; signature
                              5840       # bytes(64)
                                 56844284ca546aeb74e8a6c94eb413f09c0527b6d55c76fb567b224075c7740161c6ff83232f3d0ce73cdcbad174f2f4c0019fa78ccd8a98bcc6e708ec31d7e7
                     d8 c8               # tag(200)   ; envelope
                        d8 dd            # tag(221)   ; assertion
                           82            # array(2)
                              d8 c8      # tag(200)   ; envelope
                                 d8 df   # tag(223)   ; known-predicate
                                    04   # unsigned(4)
                              d8 c8      # tag(200)   ; envelope
                                 d8 dc   # tag(220)   ; leaf
                                    78 1d # text(29)
                                       4d61646520627920746865205374617465206f66204578616d706c652e # "Made by the State of Example."
```

---

## TEST VECTOR 10: Redacted Verifiable Credential

John wishes to identify himself to a third party using his government-issued credential, but does not wish to reveal more than his name, his photo, and the fact that the state has verified his identity. Despite redacting numerous fields, the overall digest of the elided structure is the same, and the signature still validates.

### Payload in Envelope Notation

```
{
    CID(174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8) [
        holder: CID(78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc) [
            "familyName": "SMITH"
            "givenName": "JOHN"
            "image": Digest(36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999) [
                dereferenceVia: "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                note: "This is an image of John Smith."
            ]
            ELIDED (8)
        ]
        isA: "credential"
        issuer: CID(04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8) [
            dereferenceVia: URI(https://exampleledger.com/cid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8)
            note: "Issued by the State of Example"
        ]
        ELIDED (2)
    ]
} [
    verifiedBy: Signature [
        note: "Made by the State of Example."
    ]
]
```

### UR

ðŸ‘‰ _The CBOR in a UR is never tagged, because the UR `type` field serves this purpose._

```
ur:envelope/lftpsptpvtlntpsptpuotpsghdcxchfdfwwdsrzofytsyndsvetsndkbbelbtdmuskhfdtyntbcprocktyatktaxaosptpsptpsbhdcxaerpcplkhszttoadbwdknyemlrctwmhyndwdlynetncwpklrkknbmtqduebswsvotpsptputlftpsptpurbatpsplktpsptpuotpsghdcxksrfdyaeflkootmhhpsfrhronbeytkjpdwwdwtrkzocygawdwfcshepyhdaysguotpsptpsbhdcxaooltpwtglykmhvdiovomkplnsaylkkkrlyazmfnseahtehyaodphlzodajpswbytpsptpsbhdcxdpfsrdfwaxylperyttjpbkdazcfloxeobesamemktpptrepaldbwnnbgpdregokntpsptpsbhdcxesinrolnghrklkoecmbylsvolenefnbeaxsnjtgahhkiwnolmohynybgctoymsrytpsptputlftpsptpuoimiyhsjninjzkkglhsjnihtpsptpuoihgugtgaghfdtpsptpsbhdcxfxrfwluoadksroptlsghsejlgscntelprpnbpehttlmuolahtkasiajplnjyursftpsptpsbhdcxgslsqzweeeperprylseotlzmdratjejehgfgfsayqzlfemcsoyrpbkglwfrojewztpsptpsbhdcxgydrzcwkdebehszcpswfmdzcwymtfzwdgdoyaejnlklrpayttkfzftsbprpdwkprtpsptputlftpsptpuoinioinkoihjtglhsjnihtpsptpuoiegegwfdgltpsptpsbhdcxpfgebkjlcyfgfdsgsghgaowyotvwwmykjkiybtrktkhsdwhnbkaxcxcwvtwstlbgtpsptpsbhdcxssoeidahgogebesopsinsewyetzmkiltlabyhpkbfdpaglfdmnjtpahnstfekgeotpsptputlftpsptpuoihinjnhsioihtpsplstpsptpuotpsbhdcxenrndyjpjewsrphhoyfrbwimvontlalyynflmosajodkbzwmhnpmcehfweeosonltpsptputlftpsptpuraatpsptpuoksctghisinjkcxinjkcxhsjtcxinjnhsioihcxjliycxgejlisjtcxgujninjyisdmtpsptputlftpsptpurastpsptpuokshsisjyjyjojkftdldlihkshsjnjojzihjzihieioihjpdmiajljndlieinioihjkjydleoenidiheodyemeyenidihiyideneciahseheoideheoenhsiheyesieetdyetehiyeneeemeseyiaeyemdyeyeeehecihidendyhsieehiaecenihieeoeoiaesesestpsptpsbhdcxgudyehkpbsplnbvabtemqduoqzveayltempebkcklrsarortasuectdilerhdyghtpsptputlftpsptpuraotpsptpuoimiajpihieihjtjyinhsjztpsptputlftpsptpurbttpsplstpsptpuotpsghdcxaaenfsheytmseorfbsbzktrdrdfybkwntkeegetaveghzstattdertbswsihahvstpsptputlftpsptpurastpsptpuotpcxkshyisjyjyjojkftdldlihkshsjnjojzihjzihieioihjpdmiajljndliainiedldyeeeoeneoieeciyiyesesemeoeoidiadyiyehecememidhsidhseeeedyhsiyehiaiyeoeeeehsieesiheeeceeiyhsieesieeheyetiadydyiyihiyenecdyecihettpsptputlftpsptpuraatpsptpuoksckgajkjkkpihiecxidkkcxjyisihcxgujyhsjyihcxjliycxfekshsjnjojzihtpsptputlftpsptpuraxtpsplftpsptpuotpuehdfzhflrfwlrsgghimwmjyvsolsoglqzbwwtnsahdirptlhhkozohfkgcpfzkpstjyadhsswzmlscndlfsbnvdfnuordttjywzwkrtadneoslksnlemkrfswvdaywpehtsvdtpsptputlftpsptpuraatpsptpuokscagthsieihcxidkkcxjyisihcxgujyhsjyihcxjliycxfekshsjnjojzihdmneyagrhh
```

### Tagged CBOR Binary

```
d8c882d8c8d8e086d8c8d8dcd8ca5820174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8d8c8d8cb582000b6228c61fcce0113249a37841feb5e9bea819fda1baa8479a096b3de0fefe2d8c8d8dd82d8c8d8df0ed8c88cd8c8d8dcd8ca582078bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadcd8c8d8cb582002a6d8f04ef590e767e298ae9c088c79b7f8ff3cc105d35e022d5dfb2572c611d8c8d8cb58202d3dba4203f7afbdd1720a25fd47a43310c29198d8a9b5b189139e12a8b5557ad8c8d8cb58203969b88654bb8ca2161183e28a9f3c1003cd6e495c7df1a6925e9a121fa197bdd8c8d8dd82d8c8d8dc6a66616d696c794e616d65d8c8d8dc65534d495448d8c8d8cb582043bce9dc0178b8a98354c16f4c23d385b6a0af5ad593a605cf0963728674dfccd8c8d8cb58204c83b4ed34afb6bd8333d5ff2a076b6b57463d08b4823718a1b60a4ef3b86bf2d8c8d8cb5820512afdf4281061fdacf395fdee9640ea50a1006d8c84b1f9cf403acbb2a8f4b2d8c8d8dd82d8c8d8dc69676976656e4e616d65d8c8d8dc644a4f484ed8c8d8cb5820b04a0a6f1a4648caca5702eea3e5ebf573660dbbcf612c600a03201be0efd512d8c8d8cb5820c4a26205554a10c9ac69c1ee38ff7d8780115b7e48b14e488e6eb160c7457b33d8c8d8dd82d8c8d8dc65696d616765d8c883d8c8d8dcd8cb582036be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999d8c8d8dd82d8c8d8df04d8c8d8dc781f5468697320697320616e20696d616765206f66204a6f686e20536d6974682ed8c8d8dd82d8c8d8df09d8c8d8dc786168747470733a2f2f6578616d706c656c65646765722e636f6d2f6469676573742f33366265333037323662656662363563613133623133366165323964383038316636343739326332373032343135656236306164316335366564333363393939d8c8d8cb5820533031750faea0e60d37b3dcb4e4088737af0a1e84c2b8c009de1f278ab93054d8c8d8dd82d8c8d8df02d8c8d8dc6a63726564656e7469616cd8c8d8dd82d8c8d8df0dd8c883d8c8d8dcd8ca582004363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8d8c8d8dd82d8c8d8df09d8c8d8dcd820785e68747470733a2f2f6578616d706c656c65646765722e636f6d2f6369642f30343336336435666639393733336263306631353737626162613434306166316366333434616439653435346661643964313238633030666566363530356538d8c8d8dd82d8c8d8df04d8c8d8dc781e49737375656420627920746865205374617465206f66204578616d706c65d8c8d8dd82d8c8d8df03d8c882d8c8d8dcd8de584056844284ca546aeb74e8a6c94eb413f09c0527b6d55c76fb567b224075c7740161c6ff83232f3d0ce73cdcbad174f2f4c0019fa78ccd8a98bcc6e708ec31d7e7d8c8d8dd82d8c8d8df04d8c8d8dc781d4d61646520627920746865205374617465206f66204578616d706c652e
```

### Tagged CBOR Diagnostic Notation

```
200(   ; envelope
   [
      200(   ; envelope
         224(   ; wrapped-envelope
            [
               200(   ; envelope
                  220(   ; leaf
                     202(   ; crypto-cid
                        h'174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8'
                     )
                  )
               ),
               200(   ; envelope
                  203(   ; crypto-digest
                     h'00b6228c61fcce0113249a37841feb5e9bea819fda1baa8479a096b3de0fefe2'
                  )
               ),
               200(   ; envelope
                  221(   ; assertion
                     [
                        200(   ; envelope
                           223(14)   ; known-predicate
                        ),
                        200(   ; envelope
                           [
                              200(   ; envelope
                                 220(   ; leaf
                                    202(   ; crypto-cid
                                       h'78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc'
                                    )
                                 )
                              ),
                              200(   ; envelope
                                 203(   ; crypto-digest
                                    h'02a6d8f04ef590e767e298ae9c088c79b7f8ff3cc105d35e022d5dfb2572c611'
                                 )
                              ),
                              200(   ; envelope
                                 203(   ; crypto-digest
                                    h'2d3dba4203f7afbdd1720a25fd47a43310c29198d8a9b5b189139e12a8b5557a'
                                 )
                              ),
                              200(   ; envelope
                                 203(   ; crypto-digest
                                    h'3969b88654bb8ca2161183e28a9f3c1003cd6e495c7df1a6925e9a121fa197bd'
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          220("familyName")   ; leaf
                                       ),
                                       200(   ; envelope
                                          220("SMITH")   ; leaf
                                       )
                                    ]
                                 )
                              ),
                              200(   ; envelope
                                 203(   ; crypto-digest
                                    h'43bce9dc0178b8a98354c16f4c23d385b6a0af5ad593a605cf0963728674dfcc'
                                 )
                              ),
                              200(   ; envelope
                                 203(   ; crypto-digest
                                    h'4c83b4ed34afb6bd8333d5ff2a076b6b57463d08b4823718a1b60a4ef3b86bf2'
                                 )
                              ),
                              200(   ; envelope
                                 203(   ; crypto-digest
                                    h'512afdf4281061fdacf395fdee9640ea50a1006d8c84b1f9cf403acbb2a8f4b2'
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          220("givenName")   ; leaf
                                       ),
                                       200(   ; envelope
                                          220("JOHN")   ; leaf
                                       )
                                    ]
                                 )
                              ),
                              200(   ; envelope
                                 203(   ; crypto-digest
                                    h'b04a0a6f1a4648caca5702eea3e5ebf573660dbbcf612c600a03201be0efd512'
                                 )
                              ),
                              200(   ; envelope
                                 203(   ; crypto-digest
                                    h'c4a26205554a10c9ac69c1ee38ff7d8780115b7e48b14e488e6eb160c7457b33'
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          220("image")   ; leaf
                                       ),
                                       200(   ; envelope
                                          [
                                             200(   ; envelope
                                                220(   ; leaf
                                                   203(   ; crypto-digest
                                                      h'36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999'
                                                   )
                                                )
                                             ),
                                             200(   ; envelope
                                                221(   ; assertion
                                                   [
                                                      200(   ; envelope
                                                         223(4)   ; known-predicate
                                                      ),
                                                      200(   ; envelope
                                                         220(   ; leaf
                                                            "This is an image of John Smith."
                                                         )
                                                      )
                                                   ]
                                                )
                                             ),
                                             200(   ; envelope
                                                221(   ; assertion
                                                   [
                                                      200(   ; envelope
                                                         223(9)   ; known-predicate
                                                      ),
                                                      200(   ; envelope
                                                         220(   ; leaf
                                                            "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
                                                         )
                                                      )
                                                   ]
                                                )
                                             )
                                          ]
                                       )
                                    ]
                                 )
                              )
                           ]
                        )
                     ]
                  )
               ),
               200(   ; envelope
                  203(   ; crypto-digest
                     h'533031750faea0e60d37b3dcb4e4088737af0a1e84c2b8c009de1f278ab93054'
                  )
               ),
               200(   ; envelope
                  221(   ; assertion
                     [
                        200(   ; envelope
                           223(2)   ; known-predicate
                        ),
                        200(   ; envelope
                           220("credential")   ; leaf
                        )
                     ]
                  )
               ),
               200(   ; envelope
                  221(   ; assertion
                     [
                        200(   ; envelope
                           223(13)   ; known-predicate
                        ),
                        200(   ; envelope
                           [
                              200(   ; envelope
                                 220(   ; leaf
                                    202(   ; crypto-cid
                                       h'04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8'
                                    )
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          223(9)   ; known-predicate
                                       ),
                                       200(   ; envelope
                                          220(   ; leaf
                                             32(   ; uri
                                                "https://exampleledger.com/cid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8"
                                             )
                                          )
                                       )
                                    ]
                                 )
                              ),
                              200(   ; envelope
                                 221(   ; assertion
                                    [
                                       200(   ; envelope
                                          223(4)   ; known-predicate
                                       ),
                                       200(   ; envelope
                                          220(   ; leaf
                                             "Issued by the State of Example"
                                          )
                                       )
                                    ]
                                 )
                              )
                           ]
                        )
                     ]
                  )
               )
            ]
         )
      ),
      200(   ; envelope
         221(   ; assertion
            [
               200(   ; envelope
                  223(3)   ; known-predicate
               ),
               200(   ; envelope
                  [
                     200(   ; envelope
                        220(   ; leaf
                           222(   ; signature
                              h'56844284ca546aeb74e8a6c94eb413f09c0527b6d55c76fb567b224075c7740161c6ff83232f3d0ce73cdcbad174f2f4c0019fa78ccd8a98bcc6e708ec31d7e7'
                           )
                        )
                     ),
                     200(   ; envelope
                        221(   ; assertion
                           [
                              200(   ; envelope
                                 223(4)   ; known-predicate
                              ),
                              200(   ; envelope
                                 220(   ; leaf
                                    "Made by the State of Example."
                                 )
                              )
                           ]
                        )
                     )
                  ]
               )
            ]
         )
      )
   ]
)
```

### Tagged CBOR Annotated Binary

```
d8 c8                                    # tag(200)   ; envelope
   82                                    # array(2)
      d8 c8                              # tag(200)   ; envelope
         d8 e0                           # tag(224)   ; wrapped-envelope
            86                           # array(6)
               d8 c8                     # tag(200)   ; envelope
                  d8 dc                  # tag(220)   ; leaf
                     d8 ca               # tag(202)   ; crypto-cid
                        5820             # bytes(32)
                           174842eac3fb44d7f626e4d79b7e107fd293c55629f6d622b81ed407770302c8
               d8 c8                     # tag(200)   ; envelope
                  d8 cb                  # tag(203)   ; crypto-digest
                     5820                # bytes(32)
                        00b6228c61fcce0113249a37841feb5e9bea819fda1baa8479a096b3de0fefe2
               d8 c8                     # tag(200)   ; envelope
                  d8 dd                  # tag(221)   ; assertion
                     82                  # array(2)
                        d8 c8            # tag(200)   ; envelope
                           d8 df         # tag(223)   ; known-predicate
                              0e         # unsigned(14)
                        d8 c8            # tag(200)   ; envelope
                           8c            # array(12)
                              d8 c8      # tag(200)   ; envelope
                                 d8 dc   # tag(220)   ; leaf
                                    d8 ca # tag(202)   ; crypto-cid
                                       5820 # bytes(32)
                                          78bc30004776a3905bccb9b8a032cf722ceaf0bbfb1a49eaf3185fab5808cadc
                              d8 c8      # tag(200)   ; envelope
                                 d8 cb   # tag(203)   ; crypto-digest
                                    5820 # bytes(32)
                                       02a6d8f04ef590e767e298ae9c088c79b7f8ff3cc105d35e022d5dfb2572c611
                              d8 c8      # tag(200)   ; envelope
                                 d8 cb   # tag(203)   ; crypto-digest
                                    5820 # bytes(32)
                                       2d3dba4203f7afbdd1720a25fd47a43310c29198d8a9b5b189139e12a8b5557a
                              d8 c8      # tag(200)   ; envelope
                                 d8 cb   # tag(203)   ; crypto-digest
                                    5820 # bytes(32)
                                       3969b88654bb8ca2161183e28a9f3c1003cd6e495c7df1a6925e9a121fa197bd
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             6a # text(10)
                                                66616d696c794e616d65 # "familyName"
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             65 # text(5)
                                                534d495448 # "SMITH"
                              d8 c8      # tag(200)   ; envelope
                                 d8 cb   # tag(203)   ; crypto-digest
                                    5820 # bytes(32)
                                       43bce9dc0178b8a98354c16f4c23d385b6a0af5ad593a605cf0963728674dfcc
                              d8 c8      # tag(200)   ; envelope
                                 d8 cb   # tag(203)   ; crypto-digest
                                    5820 # bytes(32)
                                       4c83b4ed34afb6bd8333d5ff2a076b6b57463d08b4823718a1b60a4ef3b86bf2
                              d8 c8      # tag(200)   ; envelope
                                 d8 cb   # tag(203)   ; crypto-digest
                                    5820 # bytes(32)
                                       512afdf4281061fdacf395fdee9640ea50a1006d8c84b1f9cf403acbb2a8f4b2
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             69 # text(9)
                                                676976656e4e616d65 # "givenName"
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             64 # text(4)
                                                4a4f484e # "JOHN"
                              d8 c8      # tag(200)   ; envelope
                                 d8 cb   # tag(203)   ; crypto-digest
                                    5820 # bytes(32)
                                       b04a0a6f1a4648caca5702eea3e5ebf573660dbbcf612c600a03201be0efd512
                              d8 c8      # tag(200)   ; envelope
                                 d8 cb   # tag(203)   ; crypto-digest
                                    5820 # bytes(32)
                                       c4a26205554a10c9ac69c1ee38ff7d8780115b7e48b14e488e6eb160c7457b33
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             65 # text(5)
                                                696d616765 # "image"
                                       d8 c8 # tag(200)   ; envelope
                                          83 # array(3)
                                             d8 c8 # tag(200)   ; envelope
                                                d8 dc # tag(220)   ; leaf
                                                   d8 cb # tag(203)   ; crypto-digest
                                                      5820 # bytes(32)
                                                         36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999
                                             d8 c8 # tag(200)   ; envelope
                                                d8 dd # tag(221)   ; assertion
                                                   82 # array(2)
                                                      d8 c8 # tag(200)   ; envelope
                                                         d8 df # tag(223)   ; known-predicate
                                                            04 # unsigned(4)
                                                      d8 c8 # tag(200)   ; envelope
                                                         d8 dc # tag(220)   ; leaf
                                                            78 1f # text(31)
                                                               5468697320697320616e20696d616765206f66204a6f686e20536d6974682e # "This is an image of John Smith."
                                             d8 c8 # tag(200)   ; envelope
                                                d8 dd # tag(221)   ; assertion
                                                   82 # array(2)
                                                      d8 c8 # tag(200)   ; envelope
                                                         d8 df # tag(223)   ; known-predicate
                                                            09 # unsigned(9)
                                                      d8 c8 # tag(200)   ; envelope
                                                         d8 dc # tag(220)   ; leaf
                                                            78 61 # text(97)
                                                               68747470733a2f2f6578616d706c656c65646765722e636f6d2f6469676573742f33366265333037323662656662363563613133623133366165323964383038316636343739326332373032343135656236306164316335366564333363393939 # "https://exampleledger.com/digest/36be30726befb65ca13b136ae29d8081f64792c2702415eb60ad1c56ed33c999"
               d8 c8                     # tag(200)   ; envelope
                  d8 cb                  # tag(203)   ; crypto-digest
                     5820                # bytes(32)
                        533031750faea0e60d37b3dcb4e4088737af0a1e84c2b8c009de1f278ab93054
               d8 c8                     # tag(200)   ; envelope
                  d8 dd                  # tag(221)   ; assertion
                     82                  # array(2)
                        d8 c8            # tag(200)   ; envelope
                           d8 df         # tag(223)   ; known-predicate
                              02         # unsigned(2)
                        d8 c8            # tag(200)   ; envelope
                           d8 dc         # tag(220)   ; leaf
                              6a         # text(10)
                                 63726564656e7469616c # "credential"
               d8 c8                     # tag(200)   ; envelope
                  d8 dd                  # tag(221)   ; assertion
                     82                  # array(2)
                        d8 c8            # tag(200)   ; envelope
                           d8 df         # tag(223)   ; known-predicate
                              0d         # unsigned(13)
                        d8 c8            # tag(200)   ; envelope
                           83            # array(3)
                              d8 c8      # tag(200)   ; envelope
                                 d8 dc   # tag(220)   ; leaf
                                    d8 ca # tag(202)   ; crypto-cid
                                       5820 # bytes(32)
                                          04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 df # tag(223)   ; known-predicate
                                             09 # unsigned(9)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             d8 20 # tag(32)   ; uri
                                                78 5e # text(94)
                                                   68747470733a2f2f6578616d706c656c65646765722e636f6d2f6369642f30343336336435666639393733336263306631353737626162613434306166316366333434616439653435346661643964313238633030666566363530356538 # "https://exampleledger.com/cid/04363d5ff99733bc0f1577baba440af1cf344ad9e454fad9d128c00fef6505e8"
                              d8 c8      # tag(200)   ; envelope
                                 d8 dd   # tag(221)   ; assertion
                                    82   # array(2)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 df # tag(223)   ; known-predicate
                                             04 # unsigned(4)
                                       d8 c8 # tag(200)   ; envelope
                                          d8 dc # tag(220)   ; leaf
                                             78 1e # text(30)
                                                49737375656420627920746865205374617465206f66204578616d706c65 # "Issued by the State of Example"
      d8 c8                              # tag(200)   ; envelope
         d8 dd                           # tag(221)   ; assertion
            82                           # array(2)
               d8 c8                     # tag(200)   ; envelope
                  d8 df                  # tag(223)   ; known-predicate
                     03                  # unsigned(3)
               d8 c8                     # tag(200)   ; envelope
                  82                     # array(2)
                     d8 c8               # tag(200)   ; envelope
                        d8 dc            # tag(220)   ; leaf
                           d8 de         # tag(222)   ; signature
                              5840       # bytes(64)
                                 56844284ca546aeb74e8a6c94eb413f09c0527b6d55c76fb567b224075c7740161c6ff83232f3d0ce73cdcbad174f2f4c0019fa78ccd8a98bcc6e708ec31d7e7
                     d8 c8               # tag(200)   ; envelope
                        d8 dd            # tag(221)   ; assertion
                           82            # array(2)
                              d8 c8      # tag(200)   ; envelope
                                 d8 df   # tag(223)   ; known-predicate
                                    04   # unsigned(4)
                              d8 c8      # tag(200)   ; envelope
                                 d8 dc   # tag(220)   ; leaf
                                    78 1d # text(29)
                                       4d61646520627920746865205374617465206f66204578616d706c652e # "Made by the State of Example."
```

---
